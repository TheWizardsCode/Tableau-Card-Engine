{"data":{"assignee":"","createdAt":"2026-02-18T18:46:49.678Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Goal: Implement a 9-card (3×3) Golf variant spike suitable for quick UI/grid experiments.\n\nWhy: Tiny rules, deterministic scoring and minimal interactions (flip/swap/discard) make this ideal as a first spike. Good fit for GridContainer (Godot) or Phaser Container.\n\nCore objects:\n- Card { rank, suit, faceUp }\n- Grid[3][3]\n- DrawPile, DiscardPile\n\nShort rules (reference): players lay out 9 cards face-down in a 3×3 grid, reveal some cards, and take turns drawing from the draw pile or top of discard; drawn card may replace a grid card or be discarded; round ends when a player has all cards face-up; scoring: A=1, 2=-2, 3-10=face value, J/Q=10, K=0; three-of-a-kind columns score 0 (Wikipedia: https://en.wikipedia.org/wiki/Golf_(card_game)).\n\nResources:\n- Wikipedia (rules & variants): https://en.wikipedia.org/wiki/Golf_(card_game)\n- Brief rules/variants / BGG thread: https://boardgamegeek.com/wiki/page/Golf\n- Implementation notes: grid state, explicit discard/draw piles; minimal animations.\n\nAcceptance criteria:\n- Work item must include clear rules summary, UI/UX notes, and 1–2 example test cases for scoring.","effort":"","id":"CG-0MLSDVRYM0DEFOFI","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":100,"stage":"","status":"deleted","tags":[],"title":"9-Card Golf","updatedAt":"2026-02-18T19:21:46.924Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T18:46:51.117Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Goal: Implement Beleaguered Castle as a deterministic, open solitaire spike (all cards face-up).\n\nWhy: No hidden state; tableau of 8 piles with simple build-down-in-suit rules; good for drag-and-drop and auto-move logic experiments.\n\nCore objects:\n- Foundations (4 aces) built up by suit to Kings\n- Tableau: 8 piles (arrays) built down regardless of suit; top card available\n- Moves deterministic: move top of pile -> foundation or other pile; empty piles accept any card\n\nShort rules: remove aces to foundation, deal remaining cards into 8 columns to the left/right; build foundations up by suit; tableau builds down regardless of suit; win when all cards are on foundations (Wikipedia: https://en.wikipedia.org/wiki/Beleaguered_Castle).\n\nResources:\n- Wikipedia: https://en.wikipedia.org/wiki/Beleaguered_Castle\n- Solitaire reference pages and sample implementations: various open-source solitaire engines\n\nAcceptance criteria:\n- Include layout diagram, move rules, and auto-move heuristics; add example winning sequence.","effort":"","id":"CG-0MLSDVT2K1Y557WS","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":200,"stage":"","status":"deleted","tags":[],"title":"Beleaguered Castle (open solitaire)","updatedAt":"2026-02-18T19:21:48.705Z"},"type":"workitem"}
{"data":{"assignee":"Map","createdAt":"2026-02-18T18:47:10.416Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSDW7YM1IWH2SB","to":"CG-0MLSFU7300TLFCBH"}],"description":"# Intake Brief: 9-Card Golf (CG-0MLSDW7YM1IWH2SB)\n\n**Priority: Critical** | **Type: Feature (Epic)** | **Assignee: Map**\n\n> First engine spike: build a playable single-round 9-Card Golf game (human vs. AI) to validate the Tableau Card Engine architecture end-to-end and surface missing abstractions before tackling larger games.\n\n## Problem Statement\n\nThe Tableau Card Engine has a working scaffold (toolchain, project structure, Phaser integration) but zero game logic, card abstractions, or gameplay features. A small, well-scoped spike is needed to validate the engine architecture end-to-end — from card data models through game rules to a playable Phaser UI — and to surface missing framework capabilities before tackling larger games. 9-Card Golf's tiny rule set (flip, swap, discard on a 3x3 grid) makes it the ideal first spike.\n\n## Users\n\n- **Engine developer (primary):** Validates that the engine's modular architecture (card-system, rule-engine, core-engine, ui) can support a real game. Uses the spike to discover which abstractions are missing and which APIs need refinement.\n  - *\"As an engine developer, I want to build a complete card game using the engine modules so I can identify gaps in Card, Deck, Pile, and Grid abstractions before building more complex games.\"*\n\n- **QA / AI tester:** Uses an AI player to exercise all game paths (random + greedy strategies) and produce reproducible game transcripts for regression testing.\n  - *\"As a tester, I want an AI opponent that can play complete games automatically so I can validate scoring, turn flow, and edge cases without manual play.\"*\n\n- **Game designer (future):** Uses the completed spike as a reference implementation and template for building additional example games.\n  - *\"As a game designer, I want a working reference game that demonstrates how to wire up scenes, rules, and UI so I can quickly scaffold new card games.\"*\n\n## Success Criteria\n\n1. **Playable single round:** A human player can play a complete single round of 9-Card Golf against 1 AI opponent in a Phaser scene — including initial card reveal, draw/swap/discard turns, and end-of-round scoring.\n2. **AI player with two strategies:** An AI player is implemented with both random (valid moves) and greedy (minimize visible score) strategies, selectable at game start or via configuration.\n3. **Correct scoring:** Scoring logic correctly implements: A=1, 2=-2, 3-10=face value, J/Q=10, K=0, three-of-a-kind columns=0. Automated unit tests cover at least 3 distinct scoring scenarios (including a column-of-three-of-a-kind case).\n4. **Game transcript:** Each completed game produces a JSON transcript recording the full sequence of turns, actions, and resulting board states — sufficient to replay and verify the game.\n5. **Visual replay (stretch goal):** A visual replay capability captures a screenshot or canvas snapshot per turn for human review of completed games. This is a stretch goal for this spike — a dedicated dev tool for game log playback and screenshot capture will be tracked separately.\n\n## Constraints\n\n- **First spike — no existing game logic:** All four engine modules (card-system, core-engine, rule-engine, ui) are currently empty stubs (version constants only). Every game-related abstraction must be built from scratch during this spike.\n- **Card assets incomplete:** Only 2 placeholder SVGs exist (ace_of_spades.svg, card_back.svg at 140x190px). A full 52-card deck of face assets is needed. Assets must be CC0 or permissively licensed (MIT, Apache 2.0, or similar) per project policy.\n- **No assumptions about framework features:** This is the project's first game spike. Do not assume any framework features exist beyond the proven scaffold (Vite, TypeScript, Phaser, Vitest). Missing capabilities must be built or sourced as part of the spike.\n- **Single round only:** Scope is limited to one round of play (one deal through to scoring). Multi-round / \"9 holes\" format is out of scope.\n- **1 Human + 1 AI:** Player count is fixed at one human and one AI opponent for this spike.\n- **Licensing:** All assets and code must be open and freely available for commercial use per CREDITS.md policy.\n\n## Existing State\n\n- **Toolchain:** Fully operational — Vite 6.1, TypeScript 5.7 (strict mode), Vitest 3.0, Phaser 3.90.0. Dev server on port 3000, production builds to `dist/`.\n- **Project structure:** Monorepo layout with `src/` (engine modules) and `example-games/` (game spikes). Path aliases configured (`@core-engine/*`, `@card-system/*`, `@rule-engine/*`, `@ui/*`).\n- **Engine modules:** All four modules (`card-system`, `core-engine`, `rule-engine`, `ui`) exist as directories with barrel `index.ts` files exporting only version constants. Zero implementation.\n- **Hello-world example:** Working Phaser scene proving SVG asset loading, tween animations, and text rendering. No interactivity or game logic. Establishes card dimensions (140x190px) and scene patterns.\n- **Assets:** 2 SVGs (ace of spades face, card back) at 140x190px in `public/assets/cards/`. Attribution in `CREDITS.md`.\n- **Tests:** Single smoke test confirming Vitest works. No meaningful game or engine tests.\n\n## Desired Change\n\nBuild a playable 9-Card Golf example game at `example-games/golf/` that exercises and populates the engine modules:\n\n- **card-system:** Implement Card type (rank, suit, faceUp), Deck (create, shuffle, draw), and Pile (push, pop, peek) abstractions. Add a Grid[3][3] type (may live locally in the golf game initially).\n- **rule-engine:** Implement Golf-specific turn logic (draw from pile or discard, replace grid card or discard drawn card), end-of-round detection (all cards face-up), and scoring rules.\n- **core-engine:** Implement minimal game state management and turn sequencing sufficient to drive a 2-player (human + AI) game loop.\n- **ui:** Build Phaser scene(s) for the golf game: 3x3 grid layout, draw/discard piles, card flip/swap animations, score display, turn indicators.\n- **AI player:** Implement two strategies (random valid move, greedy minimize-score) behind a selectable interface.\n- **Recording:** Produce a JSON game transcript per completed game. Per-turn visual snapshots are a stretch goal (see Risks & Assumptions).\n- **Card assets:** Source or generate a complete 52-card deck of face SVGs (CC0/permissive) at 140x190px. Update `public/assets/CREDITS.md` with attribution.\n- **Tests:** Unit tests for scoring logic (minimum 3 scenarios), turn legality, and deck operations. All tests must pass via `npm test`; build must succeed via `npm run build`.\n\n## Risks & Assumptions\n\n### Risks\n- **Scope creep from engine extraction:** Building reusable engine modules alongside a game spike may slow progress. Mitigation: build game-specific implementations first, then extract to shared modules only where the abstraction is clear and stable.\n- **Card asset sourcing:** Finding or generating 52 CC0/permissive SVG card faces at consistent quality and dimensions (140x190px) may take non-trivial effort. Mitigation: consider programmatic SVG generation or an existing open-source deck (e.g., the SVG-cards GitHub repo).\n- **Visual replay deferred:** Per-turn screenshot capture is a stretch goal for this spike. A dedicated dev tool for game log playback and image capture (using Playwright or similar) will be built as a separate high-priority work item, blocked by this spike. See related work item below.\n- **Grid abstraction placement:** Unclear whether Grid[3][3] should live in card-system (reusable) or locally in the golf game. Mitigation: build locally first; extract after a second game validates the abstraction.\n\n### Assumptions\n- A standard 52-card deck (no jokers) is sufficient for 9-Card Golf.\n- The 9-card variant uses the scoring rules from Wikipedia (A=1, 2=-2, 3-10=face, J/Q=10, K=0, column-of-three=0). No house-rule variants are in scope.\n- Phaser 3.90.0's built-in scene management and tween system are sufficient for card flip/swap animations without additional libraries.\n- The AI player does not need to be competitive — it only needs to make legal moves to exercise game paths.\n\n## Suggested Next Step\n\nBreak CG-0MLSDW7YM1IWH2SB into child work items covering: card asset sourcing, card-system implementation, rule-engine (Golf scoring + turn logic), core-engine (game loop + state), UI (Phaser scenes), AI player, game recording, and test suite. Then begin implementation of the first child item per `wl next`.\n\n## Related Work\n\n- **Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN):** High-priority feature to build a Playwright-based dev tool that replays JSON game transcripts and captures per-turn screenshots. Blocked by this spike (requires working game with transcript output).\n- **Scaffold Card Game Engine project (CG-0MLSFU7300TLFCBH):** Completed epic that set up the repository structure, toolchain, and empty module stubs. This spike builds directly on that foundation.\n- **Wikipedia — Golf (card game):** https://en.wikipedia.org/wiki/Golf_(card_game) — Canonical rules reference.\n- **BoardGameGeek — Golf:** https://boardgamegeek.com/wiki/page/Golf — Variant rules and community discussion.\n- **AGENTS.md:** Project rules, spike-driven development approach, engine architecture, and quality gates.\n- **docs/DEVELOPER.md:** Developer setup, build/test commands, and asset management.\n- **public/assets/CREDITS.md:** Asset attribution policy and suggested sources (OpenGameArt.org, Kenney.nl, SVG-cards repo).\n\n## Related work (automated report)\n\nSearched Worklog (keywords: golf, card, game, spike, scoring, grid, deck, phaser) and repository files. No duplicate work items found.\n\n### Worklog items\n\n- **Scaffold Card Game Engine project (CG-0MLSFU7300TLFCBH)** [completed]: Established the repository structure, Vite/TypeScript/Phaser toolchain, hello-world example, and empty engine module stubs. This spike is a direct dependency — it provides the foundation (build tooling, directory layout, card asset pipeline patterns) that the Golf spike will build on. The hello-world scene patterns (SVG loading at 140x190px, Phaser.Scene subclass, game config) serve as templates for the Golf scene implementation.\n\n- **Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)** [blocked by this item]: High-priority feature to build a Playwright-based CLI tool that replays JSON game transcripts and captures per-turn screenshots. Directly blocked by this spike — it requires a working game producing JSON transcripts. The transcript format defined by this Golf spike will become the initial schema for the replay tool.\n\n- **Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)** [blocked by this item]: Open solitaire spike with deterministic, all-face-up gameplay. Blocked by this spike because it will reuse Card, Deck, and Pile abstractions built here. Its tableau/foundation model will exercise different engine patterns (build-up-by-suit vs. Golf's grid/scoring), providing a second validation point for engine module APIs.\n\n- **Sushi Go! (CG-0MLSDWSCG154TUEL)**, **Splendor (CG-0MLSDX4B91DG6S1A)**, **Lost Cities (CG-0MLSDXELC06VESJL)**, **The Mind (CG-0MLSDXNMM1R2IMT9)**, **Coloretto (CG-0MLSDXY9F1FSGQ38)** [all blocked]: Five additional game spikes at idea stage. All will consume the card-system and core-engine modules first built by this Golf spike. Not directly related but will benefit from abstractions validated here.\n\n- **Add pre-commit hook to enforce doc updates (CG-0MLSHQMDY1H0I2B7)** [open]: Infrastructure task to add doc-update enforcement. Not directly related to this spike but the Golf spike should comply with the doc-update policy when making infrastructure changes.\n\n- **Rename project to Tableau Card Engine (CG-0MLSIULHH0Y6I3DV)** [completed]: Branding rename already applied. The Golf spike should use \"Tableau Card Engine\" / \"TCE\" naming consistently.\n\n### Repository files\n\n- **`example-games/hello-world/`**: Establishes the patterns this spike should follow — `main.ts` entry point, `scenes/` directory with Phaser.Scene subclass, SVG asset loading via `this.load.svg()` with explicit dimensions, game config with scale mode and parent container.\n\n- **`src/card-system/index.ts`**: Empty stub (exports only `CARD_SYSTEM_VERSION`). This spike must populate it with Card, Deck, and Pile abstractions.\n\n- **`src/core-engine/index.ts`**: Empty stub (exports only `ENGINE_VERSION`). This spike must add minimal game state management and turn sequencing.\n\n- **`src/rule-engine/index.ts`**: Empty stub (exports only `RULE_ENGINE_VERSION`). This spike must add Golf-specific turn logic and scoring.\n\n- **`src/ui/index.ts`**: Empty stub (exports only `UI_VERSION`). This spike must add Phaser scene components for the Golf game.\n\n- **`public/assets/cards/`**: Contains 2 placeholder SVGs (ace_of_spades.svg, card_back.svg) at 140x190px establishing the card asset format. This spike must source or generate the remaining 51 card faces.\n\n- **`public/assets/CREDITS.md`**: Documents asset attribution policy and suggests sources (OpenGameArt.org, Kenney.nl, SVG-cards GitHub repo). Must be updated when new card assets are added.\n\n- **`tests/smoke.test.ts`**: Trivial Vitest smoke test. This spike must add meaningful tests for scoring logic, turn legality, and deck operations alongside this existing test.","effort":"","id":"CG-0MLSDW7YM1IWH2SB","issueType":"epic","needsProducerReview":false,"parentId":null,"priority":"critical","risk":"","sortIndex":300,"stage":"in_progress","status":"completed","tags":[],"title":"9-Card Golf","updatedAt":"2026-02-19T04:07:54.456Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-18T18:47:20.322Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSDWFLT1WB6IEB","to":"CG-0MLSDW7YM1IWH2SB"},{"from":"CG-0MLSDWFLT1WB6IEB","to":"CG-0MLSFU7300TLFCBH"}],"description":"# Intake Brief: Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)\n\n**Priority: Medium** | **Type: Epic** | **Assignee: Map**\n\n> Second engine spike: build a playable Beleaguered Castle solitaire game to validate single-player support, drag-and-drop interaction, undo/redo, and auto-move mechanics in the Tableau Card Engine.\n\n## Problem Statement\n\nThe Tableau Card Engine currently supports only multi-player games (the core-engine requires 2+ players) and uses click-only input. A single-player solitaire game is needed to validate and extend the engine for: single-player GameState, drag-and-drop card interaction, undo/redo state management, and auto-move heuristics. Beleaguered Castle's fully deterministic, open-information rules (all cards face-up) make it an ideal spike for these features without the complexity of hidden state.\n\n## Users\n\n- **Engine developer (primary):** Validates that the engine's modular architecture can support single-player games, drag-and-drop input, undo/redo, and auto-move. Uses the spike to extend core-engine for 1-player support and extract reusable patterns.\n  - *\"As an engine developer, I want to build a single-player solitaire game using the engine modules so I can identify gaps in single-player support, input handling, and state history management.\"*\n\n- **Solitaire player:** Plays Beleaguered Castle with modern digital solitaire UX: drag cards or click-to-move, undo/redo mistakes, and watch cards auto-move to foundations when safe.\n  - *\"As a player, I want to play Beleaguered Castle with both drag-and-drop and click-to-move input, full undo/redo, and auto-move to foundations so the game feels polished and responsive.\"*\n\n- **Game designer (future):** Uses the completed spike as a reference for building other solitaire-style games using the engine's new single-player, drag-and-drop, and undo/redo capabilities.\n  - *\"As a game designer, I want a working solitaire reference game that demonstrates drag-and-drop, undo/redo, and auto-move so I can quickly scaffold similar card games.\"*\n\n## Success Criteria\n\n1. **Playable classic Beleaguered Castle:** A player can play a complete game of Beleaguered Castle (classic deal: aces pre-placed on foundations, 48 cards dealt into 8 columns of 6) in a Phaser scene from deal to win or loss.\n2. **Dual input methods:** Cards can be moved via both drag-and-drop (drag from tableau pile to foundation or another tableau pile) and click-to-select/click-to-place. Invalid moves snap the card back / are rejected.\n3. **Full undo/redo:** A reusable undo/redo module in `src/core-engine/` supports unlimited undo/redo steps. The player can step backward and forward through their entire move history.\n4. **Auto-move to foundations + auto-complete:** Cards are automatically moved to foundations when safe to play (no tableau pile needs the card as a build target). When the remaining game is trivially winnable, auto-complete plays all remaining moves to completion.\n5. **Win and no-moves detection:** The game detects when the player wins (all cards on foundations) and when no legal moves remain (game over / stuck).\n6. **New game / restart:** The player can start a new game (fresh shuffle) or restart the current deal at any time via a UI button.\n7. **Single-player core-engine support:** `src/core-engine/` GameState is modified to allow 1 player, enabling all future solitaire games to use the shared engine.\n8. **JSON game transcript:** Each completed game produces a JSON transcript compatible with the existing Visual Replay Dev Tool.\n9. **Test coverage:** Unit tests cover: deal logic, move legality (valid and invalid moves), foundation build-up rules, win detection, no-moves detection, undo/redo operations, auto-move heuristics, and scoring (if applicable). All tests pass via `npm test`; build succeeds via `npm run build`.\n\n## Constraints\n\n- **Classic deal only:** This work item covers the classic Beleaguered Castle deal (aces pre-placed on foundations, 48 cards into 8 columns of 6). The Citadel variant (all 52 cards in tableau) is tracked separately as CG-0MLTDXG3H0WCXMUV.\n- **Single-player only:** No AI opponent or solver. The player makes all decisions.\n- **Card assets already available:** A full 52-card SVG deck at 140x190px exists in `public/assets/cards/` (CC0 licensed). No new art assets are needed.\n- **Rule engine still a stub:** The rule engine (`src/rule-engine/`) remains an empty stub. Beleaguered Castle rules should be built locally in the game first; extraction to the rule engine is out of scope unless a clear reusable pattern emerges.\n- **Licensing:** All code and assets must be open and freely available for commercial use per project policy.\n- **Layout:** Foundations across the top, 8 tableau columns below (digital solitaire convention, not the traditional center-foundations layout).\n\n## Existing State\n\n- **Card system (src/card-system/):** Mature. Card, Deck, Pile types with full test coverage. Pile supports LIFO push/pop/peek operations suitable for foundations and tableau columns.\n- **Core engine (src/core-engine/):** Functional. GameState<T> and TurnSequencer, but requires 2+ players. Must be modified for single-player support.\n- **Rule engine (src/rule-engine/):** Empty stub (version constant only).\n- **UI (src/ui/):** HelpPanel and HelpButton components available. No drag-and-drop, card sprite, or game-play UI components exist.\n- **Golf example game (example-games/golf/):** Completed first spike. Establishes patterns for: scene structure, game logic separation (rules/scoring as pure functions), AI strategies, game transcripts, browser tests with Phaser, and help panel integration.\n- **Card assets:** 52 SVG card faces + card back at 140x190px in `public/assets/cards/`. CC0 licensed from saulspatz/SVGCards.\n- **No solitaire-specific code exists:** No foundation logic, tableau column logic, drag-and-drop, auto-move, or undo/redo anywhere in the codebase.\n\n## Desired Change\n\nBuild a playable Beleaguered Castle example game at `example-games/beleaguered-castle/` that introduces single-player, drag-and-drop, undo/redo, and auto-move capabilities:\n\n- **core-engine (single-player):** Modify `createGameState()` to accept 1 player. Ensure TurnSequencer works correctly for single-player (turn \"advancement\" is a no-op or simply increments the move counter).\n- **core-engine (undo/redo):** Build a reusable `UndoRedoManager` module in `src/core-engine/` that maintains a history stack of game states and supports unlimited undo/redo.\n- **Game logic (example-games/beleaguered-castle/):**\n  - Deal module: shuffle deck, remove aces to foundations, deal 48 cards into 8 columns of 6 (all face-up).\n  - Move rules: move top card of any tableau column to a foundation (if next in suit sequence) or to another tableau column (if one rank lower, regardless of suit). Empty columns accept any card.\n  - Win detection: all 52 cards on foundations.\n  - No-moves detection: no legal moves remain across all tableau columns.\n  - Auto-move: automatically move cards to foundations when safe (no tableau column needs the card). Auto-complete when trivially solvable.\n- **Phaser UI (example-games/beleaguered-castle/scenes/):**\n  - Layout: 4 foundation piles across the top, 8 tableau columns below.\n  - Dual input: drag-and-drop cards between piles, or click-to-select then click-to-place.\n  - Visual feedback: highlight valid drop targets, snap-back for invalid moves, card flip animations for foundation placement.\n  - Undo/redo buttons and keyboard shortcuts.\n  - Win/loss overlays.\n  - Help panel with game rules (using reusable HelpPanel component).\n- **Game transcript:** Produce a JSON transcript per completed game, compatible with the Visual Replay Dev Tool.\n- **Tests:** Unit tests for deal logic, move legality, foundation rules, win/no-moves detection, undo/redo, and auto-move. Browser tests for Phaser rendering and interaction. All tests pass via `npm test`; build succeeds via `npm run build`.\n\n## Risks & Assumptions\n\n### Risks\n- **Drag-and-drop complexity:** Implementing reliable drag-and-drop with Phaser (setDraggable, drag zones, drop zones, snap-back) is significantly more complex than click input. May require substantial iteration on hit detection and visual feedback.\n- **Undo/redo state size:** Storing full game state snapshots for unlimited undo/redo could consume significant memory for long games. Mitigation: use a command pattern (store moves, not states) or delta-based approach to minimize memory usage.\n- **Auto-move correctness:** Determining whether a card is \"safe\" to auto-move to a foundation requires checking whether any tableau column still needs the card as a build target. The heuristic must be conservative to avoid auto-moving cards that the player might want to keep available for tableau building. Mitigation: start with a simple safe-move heuristic and iterate.\n- **Auto-complete detection:** Determining when the game is \"trivially winnable\" is non-trivial (requires checking that all remaining tableau cards can be played to foundations in some order). Mitigation: use a simple heuristic (e.g., all tableau cards are in ascending order within their columns) rather than a full solver.\n- **Core-engine single-player change scope:** Modifying GameState to allow 1 player may have ripple effects on TurnSequencer and any code that assumes 2+ players. Mitigation: make the change backward-compatible and verify all existing Golf tests still pass.\n- **Low win rate:** Beleaguered Castle has a relatively low win rate (~30% of random deals are solvable). Players may encounter many unwinnable deals. Mitigation: the no-moves detection will inform the player when they are stuck, and new-game/restart options allow quick recovery.\n- **Undo/redo interaction with auto-move:** Undoing a move that triggered one or more auto-moves must correctly undo the entire chain (auto-moves + player move). Failure to do so would leave the game in an inconsistent state. Mitigation: treat auto-move chains as part of the triggering move in the undo history.\n\n### Assumptions\n- A standard 52-card deck (no jokers) is used.\n- Beleaguered Castle uses the classic rules from Wikipedia: aces pre-placed on foundations, build foundations up by suit (A to K), build tableau columns down regardless of suit, only top card of each column is available, empty columns accept any card.\n- Phaser 3.90.0's built-in drag-and-drop support (setDraggable, drag events, drop zones) is sufficient without additional libraries.\n- The undo/redo module does not need to support branching history (tree-based undo); a simple linear stack is sufficient.\n- The game does not need a solver or hint system for this spike.\n- The JSON transcript format can follow the same general structure as the Golf transcript, adapted for solitaire moves.\n\n## Suggested Next Step\n\nBreak CG-0MLSDWFLT1WB6IEB into child work items covering: core-engine single-player support, undo/redo module, Beleaguered Castle game logic (deal, rules, win/loss detection), auto-move heuristics, Phaser UI (layout, drag-and-drop, click-to-move, visual feedback), game transcript recording, help panel integration, and test suite. Then begin implementation per `wl next`.\n\n## Related Work\n\n- **9-Card Golf (CG-0MLSDW7YM1IWH2SB)** [completed]: First game spike. Provides reference patterns for scene structure, game logic separation, AI strategies, game transcripts, and test structure. Beleaguered Castle follows the same architectural patterns.\n- **Card System Engine Module (CG-0MLSPHOWY1HSCIDX)** [completed]: Card, Deck, Pile types that Beleaguered Castle will reuse directly.\n- **Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0)** [completed]: GameState and TurnSequencer that must be modified for single-player support.\n- **Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)** [completed]: JSON transcript replay tool. Beleaguered Castle should produce compatible transcripts.\n- **Help Screen with Game Rules (CG-0MLT0PM000TQRIXT)** [completed]: Reusable HelpPanel and HelpButton components to integrate into Beleaguered Castle.\n- **Citadel variant option (CG-0MLTDXG3H0WCXMUV)** [open]: Follow-on work item for adding the Citadel variant deal to Beleaguered Castle.\n- **Wikipedia -- Beleaguered Castle:** https://en.wikipedia.org/wiki/Beleaguered_Castle -- Canonical rules reference.\n- **AGENTS.md:** Project rules, spike-driven development approach, engine architecture, and quality gates.\n- **docs/DEVELOPER.md:** Developer setup, build/test commands, adding example games, and asset management.\n\n## Related work (automated report)\n\nSearched Worklog (keywords: solitaire, foundation, tableau, drag-and-drop, undo, auto-move, single-player, card, game, engine, phaser) and repository files. No duplicate work items found.\n\n### Worklog items\n\n- **9-Card Golf (CG-0MLSDW7YM1IWH2SB)** [completed]: The primary reference implementation. Its game logic architecture (pure rule functions separated from Phaser scene, game transcript recording, browser tests with headless Chromium) establishes the patterns Beleaguered Castle should follow. Key differences: Golf is multi-player with AI; Beleaguered Castle is single-player with undo/redo and drag-and-drop.\n\n- **Card System Engine Module (CG-0MLSPHOWY1HSCIDX)** [completed]: Provides Card, Deck, and Pile types. The Pile class (LIFO push/pop/peek) is directly suitable for both foundation piles (build up by suit) and tableau columns (build down regardless of suit). No modifications to card-system are expected.\n\n- **Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0)** [completed]: Provides GameState<T> and TurnSequencer. Currently enforces a minimum of 2 players in `createGameState()` -- this constraint must be relaxed to support single-player solitaire. The TurnSequencer's `advanceTurn()` rotation logic will need adaptation for single-player (move counter only).\n\n- **Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)** [open]: JSON transcript replay tool. Beleaguered Castle should produce transcripts in a compatible format. The solitaire transcript schema will differ from Golf's (single-player moves, auto-moves, undo/redo events) but should share the same envelope structure.\n\n- **Help Screen with Game Rules (CG-0MLT0PM000TQRIXT)** [completed]: Reusable HelpPanel and HelpButton components in `src/ui/`. Beleaguered Castle should integrate these with game-specific help content describing the deal, move rules, undo/redo shortcuts, and auto-move behavior.\n\n- **Card Asset Pipeline (CG-0MLSPHIDD19PBDOZ)** [completed]: The full 52-card SVG deck is already available at `public/assets/cards/` (CC0 licensed, 140x190px). No new assets needed for Beleaguered Castle.\n\n- **Scaffold Card Game Engine project (CG-0MLSFU7300TLFCBH)** [completed]: Established the repository structure, toolchain (Vite, TypeScript, Phaser, Vitest), and path aliases. Beleaguered Castle builds on this foundation.\n\n- **Citadel variant option (CG-0MLTDXG3H0WCXMUV)** [open]: Created during this intake. Follow-on work to add a Citadel deal variant (all 52 cards in tableau, no aces pre-placed) as a selectable option within the Beleaguered Castle game.\n\n- **Coloretto (CG-0MLSDXY9F1FSGQ38)** [blocked]: Set-building tableau game. While not directly related, it is another planned game spike that will benefit from the drag-and-drop and single-player engine features built by this spike.\n\n### Repository files\n\n- **`example-games/golf/`**: Full reference implementation. Key files to study: `GolfGame.ts` (game orchestration pattern), `GolfRules.ts` (pure rule functions), `GolfScoring.ts` (scoring logic), `GameTranscript.ts` (transcript recording), `scenes/GolfScene.ts` (Phaser scene with state-machine-driven UI flow).\n\n- **`src/card-system/Pile.ts`**: LIFO stack abstraction documented as suitable for \"draw piles, discard piles, foundations, and any other ordered collection of cards.\" Beleaguered Castle will use Pile instances for both the 4 foundations and 8 tableau columns.\n\n- **`src/core-engine/GameState.ts`**: The `createGameState()` function at line 48 enforces `players.length >= 2`. This validation must be changed to `>= 1` for single-player support, with existing tests verified to still pass.\n\n- **`src/core-engine/TurnSequencer.ts`**: The `advanceTurn()` function uses modular arithmetic (`(currentPlayerIndex + 1) % players.length`) which would work correctly for a single player (always index 0). The main concern is whether consumers assume multi-player behavior.\n\n- **`src/ui/HelpPanel.ts`** and **`src/ui/HelpButton.ts`**: Reusable UI components for in-game help. Already integrated in the Golf game via `help-content.json`. Beleaguered Castle should follow the same pattern with its own help content file.\n\n- **`public/assets/cards/`**: 52 SVG card faces + card back, all at 140x190px. File naming convention: `{rank}_of_{suit}.svg`. All assets are CC0 licensed per `CREDITS.md`.\n\n- **`docs/DEVELOPER.md`**: Section \"Adding a New Example Game\" describes the steps for creating a new game under `example-games/`. Beleaguered Castle should follow this guide.","effort":"","id":"CG-0MLSDWFLT1WB6IEB","issueType":"epic","needsProducerReview":false,"parentId":null,"priority":"high","risk":"","sortIndex":400,"stage":"in_progress","status":"in-progress","tags":[],"title":"Beleaguered Castle (open solitaire)","updatedAt":"2026-02-19T12:24:53.071Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T18:47:36.860Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSDWSCG154TUEL","to":"CG-0MLSDWFLT1WB6IEB"},{"from":"CG-0MLSDWSCG154TUEL","to":"CG-0MLSFU7300TLFCBH"}],"description":"Goal: Implement Sushi Go! (tableau drafting) spike — drafting mechanics + public scoring.\n\nWhy: Public scoring, no spatial layout required; easy card-draft → tableau animation and deterministic scoring functions (works well with LLM-augmented scoring helpers).\n\nCore objects:\n- Hand[] (cards in a player's hand during draft)\n- Tableau[] (collected cards per player)\n- ScoreCalculator (scoring rules per card type)\n\nShort rules: 2–5 players, 3 rounds; each round players pick one card from their hand, pass remaining hand to the left (or right) and reveal simultaneously; cards scored at end of round/3 rounds (Wikipedia: https://en.wikipedia.org/wiki/Sushi_Go!).\n\nResources:\n- Wikipedia summary: https://en.wikipedia.org/wiki/Sushi_Go!\n- Publisher (Gamewright) product page: https://gamewright.com/product/Sushi-Go\n- Example OSS projects (search GitHub: Sushi","effort":"","id":"CG-0MLSDWSCG154TUEL","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":500,"stage":"idea","status":"blocked","tags":[],"title":"Sushi Go! (drafting)","updatedAt":"2026-02-18T19:53:43.289Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T18:47:52.341Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSDX4B91DG6S1A","to":"CG-0MLSDWSCG154TUEL"},{"from":"CG-0MLSDX4B91DG6S1A","to":"CG-0MLSFU7300TLFCBH"}],"description":"Goal: Implement Splendor spike concentrating on card market, gem token pool, and purchase mechanics.\n\nWhy: Clean rules, no hidden info, strong fit for JSON-driven card definitions (cost/bonus/points). Good for token animations and purchase interactions.\n\nCore objects:\n- Card { cost[], bonus, points }\n- Tokens[] (emerald/sapphire/ruby/diamond/onyx/gold)\n- Market (visible row of development cards per tier)\n- Player.tableau[] (purchased cards, reserved cards)\n\nShort rules: players take tokens, reserve cards (gain gold), or purchase cards by paying cost with tokens/bonuses; nobles give prestige; game ends when a player reaches 15 points (Wikipedia: https://en.wikipedia.org/wiki/Splendor_(board_game)).\n\nResources:\n- Wikipedia: https://en.wikipedia.org/wiki/Splendor_(board_game)\n- Rulebook PDF (publisher): https://www.spacecowboys.fr/images/jeux/splendor/rules_splendor_en.pdf\n- OSS/mobile apps exist (search Splendor","effort":"","id":"CG-0MLSDX4B91DG6S1A","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":600,"stage":"idea","status":"blocked","tags":[],"title":"Splendor (engine-building)","updatedAt":"2026-02-18T19:53:45.189Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T18:48:05.665Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSDXELC06VESJL","to":"CG-0MLSDX4B91DG6S1A"},{"from":"CG-0MLSDXELC06VESJL","to":"CG-0MLSFU7300TLFCBH"}],"description":"Goal: Implement Lost Cities focusing on per-player color lanes, ascending-play rule and discard piles.\n\nWhy: Simple ascending-play mechanic, discard piles per color, and easy lane-slot animations make this a good 2-player spike.\n\nCore objects:\n- Lanes[color] per player = [] (cards played in ascending order)\n- Discard[color] piles\n- DrawPile\n\nShort rules: 2 players, each turn play a card to an expedition lane (must be >= last card) or discard and draw; expeditions score with inversion for unstarted ones (Wikipedia: https://en.wikipedia.org/wiki/Lost_Cities).\n\nResources:\n- Wikipedia: https://en.wikipedia.org/wiki/Lost_Cities\n- BoardGameGeek: https://boardgamegeek.com/boardgame/2349/lost-cities\n- Example digital implementation notes e.g., Xbox/Steam ports (historical)\n\nAcceptance criteria:\n- Describe lane model, legal-play checks, discard/draw flow, and scoring examples.","effort":"","id":"CG-0MLSDXELC06VESJL","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":700,"stage":"idea","status":"blocked","tags":[],"title":"Lost Cities (2-player lanes)","updatedAt":"2026-02-18T19:53:46.746Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T18:48:17.374Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSDXNMM1R2IMT9","to":"CG-0MLSDXELC06VESJL"},{"from":"CG-0MLSDXNMM1R2IMT9","to":"CG-0MLSFU7300TLFCBH"}],"description":"Goal: Implement an open-hand variant of The Mind: shared ascending pile where players cooperate by placing cards in ascending order without hidden hands.\n\nWhy: Removing hidden-hand/timing complexity leaves a single shared tableau (pile) and ascending-play rules — excellent for timing/animation experiments and cooperative UI.\n\nCore objects:\n- SharedPile[] (the single ascending tableau)\n- DrawPile\n- Player.hands (open to all) or shared visible set\n\nVariant rules: players collaboratively place cards in ascending order onto the shared pile; in the open variant all hands are visible so play is deterministic (no hidden state).\n\nResources:\n- BoardGameGeek / publisher summaries: https://boardgamegeek.com/boardgame/179258/mind\n- Wikipedia entry for The Mind: https://en.wikipedia.org/wiki/The_Mind (game-specific pages)\n\nAcceptance criteria:\n- Document open-variant rules, edge-cases (ties/simultaneous plays), and timing heuristics for cooperative play.","effort":"","id":"CG-0MLSDXNMM1R2IMT9","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":800,"stage":"idea","status":"blocked","tags":[],"title":"The Mind (open-hand variant)","updatedAt":"2026-02-18T19:53:47.954Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T18:48:31.170Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSDXY9F1FSGQ38","to":"CG-0MLSDXNMM1R2IMT9"},{"from":"CG-0MLSDXY9F1FSGQ38","to":"CG-0MLSFU7300TLFCBH"}],"description":"Goal: Implement Coloretto focusing on row placement/take actions and per-player color scoring.\n\nWhy: Set-collection scoring with 'take-a-row' mechanic; tableau = sets of colors; simple scoring and clear per-player choices.\n\nCore objects:\n- Rows[] (active rows where cards are placed)\n- Player.collect[] (colors taken)\n- Deck, LastRound trigger\n\nShort rules: draw card -> place onto one of the rows (max 3 cards per row); a player may instead take a row; play continues until last-round card triggers; scoring: choose 3 colors to score positively; others negative (Wikipedia: https://en.wikipedia.org/wiki/Coloretto).\n\nResources:\n- Wikipedia: https://en.wikipedia.org/wiki/Coloretto\n- Publisher and BGG pages for rule PDF and scoring examples\n\nAcceptance criteria:\n- Describe row/take flow, scoring algorithm, and sample scoring scenarios.","effort":"","id":"CG-0MLSDXY9F1FSGQ38","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":900,"stage":"idea","status":"blocked","tags":[],"title":"Coloretto (set-building tableau)","updatedAt":"2026-02-18T19:53:49.001Z"},"type":"workitem"}
{"data":{"assignee":"Map","createdAt":"2026-02-18T19:41:35.196Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"# Scaffold Card Game Engine Project\n\n> **Headline**: Set up the Card Game Spikes repository with Phaser 3.x, TypeScript, Vite, and Vitest as a flat monorepo, unblocking all 7 planned game spikes.\n\n## Problem Statement\n\nThe Card Game Spikes project is a completely greenfield repository with no source code, build tooling, or directory structure. All 7 planned example game spikes (9-Card Golf, Beleaguered Castle, Sushi Go!, Splendor, Lost Cities, The Mind, Coloretto) are blocked until a working project foundation is in place. A properly scaffolded project with build, test, and dev-server tooling is required before any game development can begin.\n\n## Users\n\n- **Game developers (internal)**: Agents and contributors who will implement the example card games and extract reusable engine components.\n  - *As a game developer, I want to run a single command to start a dev server with hot-reload so I can iterate quickly on game code.*\n  - *As a game developer, I want TypeScript configured with strict mode so I catch type errors early.*\n  - *As a game developer, I want a clear directory structure so I know where to put shared engine code vs. game-specific code.*\n- **Engine consumers (future)**: Developers who will reuse extracted engine modules for their own card games.\n  - *As an engine consumer, I want shared modules (core-engine, card-system, rule-engine) organized in a discoverable way so I can import only what I need.*\n\n## Success Criteria\n\n1. Running `npm install && npm run dev` starts a Vite dev server that renders a minimal Phaser 3.x \"hello world\" scene in the browser (a card sprite or text on a colored background).\n2. Running `npm test` executes Vitest and at least one passing unit test completes successfully.\n3. Running `npm run build` produces a production bundle in a `dist/` directory without errors.\n4. The directory structure includes clearly separated areas for shared engine modules (`src/core-engine/`, `src/card-system/`, `src/rule-engine/`, `src/ui/`) and example games (`example-games/`), with each example game having its own entry point and scene(s).\n5. A git repository is initialized with a proper `.gitignore` (covering `node_modules/`, `dist/`, IDE files, OS files) and an initial commit containing the full scaffold.\n\n## Constraints\n\n- **Phaser 3.x (latest stable, currently 3.90.0)**: The AGENTS.md originally specified \"Phaser 4\" but this does not exist as a stable release. Phaser 3.x is the current community standard.\n- **Vite**: Replaces Webpack as specified in AGENTS.md. Vite is officially supported by Phaser's project scaffolder and offers faster dev builds and HMR.\n- **Vitest**: Replaces Jest as specified in AGENTS.md. Vitest integrates natively with Vite, uses the same API as Jest, and avoids ESM/CJS compatibility friction.\n- **TypeScript**: Strict mode, targeting modern browsers (ES2020+).\n- **Flat monorepo**: Single `package.json` at root. Shared engine code in `src/` subdirectories, example games in `example-games/` with their own scenes and entry points. No npm workspaces for now.\n- **Open-source licensing**: All dependencies and assets must be permissively licensed (MIT, Apache 2.0, CC0, etc.) and suitable for commercial use.\n- **AGENTS.md must be updated** to reflect the actual tech stack decisions (Phaser 3.x, Vite, Vitest, flat monorepo structure).\n\n## Existing State\n\n- The repository contains only `AGENTS.md`, `.gitignore` (minimal, Worklog-focused), and `.worklog/` data.\n- No git repository is initialized (no `.git/` directory).\n- No `package.json`, no TypeScript config, no build tooling, no source files, no tests.\n- 7 game spike work items exist in Worklog, all at \"idea\" stage, all blocked pending scaffolding.\n\n## Desired Change\n\nAfter this work item is completed, the repository will contain:\n\n- **Git repository**: Initialized with a proper `.gitignore` and initial commit.\n- **`package.json`**: With Phaser 3.x, TypeScript, Vite, and Vitest as dependencies; scripts for `dev`, `build`, `test`, and `preview`.\n- **`tsconfig.json`**: Strict TypeScript configuration targeting ES2020, with Phaser type definitions.\n- **`vite.config.ts`**: Configured for Phaser 3.x development with dev server and production build.\n- **Directory structure**:\n  ```\n  cardGameSpikes/\n  ├── src/\n  │   ├── core-engine/       # Game loop, state management, rendering helpers\n  │   ├── card-system/       # Card definitions, deck, hand, pile abstractions\n  │   ├── rule-engine/       # Rule definitions, validation, turn logic\n  │   └── ui/                # Reusable UI components (buttons, menus, overlays)\n  ├── example-games/\n  │   └── hello-world/       # Minimal Phaser scene proving toolchain works\n  │       ├── scenes/\n  │       └── main.ts\n  ├── public/                # Static assets (HTML, images, fonts)\n  ├── tests/                 # Vitest test files\n  ├── dist/                  # Production build output (gitignored)\n  ├── AGENTS.md              # Updated with actual tech stack\n  ├── package.json\n  ├── tsconfig.json\n  ├── vite.config.ts\n  └── .gitignore             # Comprehensive Node.js/TS/Vite ignores\n  ```\n- **Hello-world scene**: A minimal Phaser 3.x scene that renders on screen, proving Vite + Phaser + TypeScript integration works end-to-end.\n- **One passing Vitest test**: Demonstrating the test framework is wired up correctly.\n- **Updated AGENTS.md**: Reflecting Phaser 3.x, Vite, Vitest, and the actual directory structure.\n\n## Related Work\n\n- **9-Card Golf (CG-0MLSDW7YM1IWH2SB)** - First game spike, directly unblocked by this scaffolding.\n- **Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)** - Solitaire spike, blocked.\n- **Sushi Go! (CG-0MLSDWSCG154TUEL)** - Drafting game spike, blocked.\n- **Splendor (CG-0MLSDX4B91DG6S1A)** - Engine-building game spike, blocked.\n- **Lost Cities (CG-0MLSDXELC06VESJL)** - 2-player lanes spike, blocked.\n- **The Mind (CG-0MLSDXNMM1R2IMT9)** - Open-hand variant spike, blocked.\n- **Coloretto (CG-0MLSDXY9F1FSGQ38)** - Set-building tableau spike, blocked.\n- **Official Phaser Webpack-TS template** (https://github.com/phaserjs/template-webpack-ts) - Reference for Phaser + TypeScript project structure.\n- **Phaser `create-phaser-game` CLI** - Official scaffolder supporting Vite + TypeScript templates.\n\n## Risks & Assumptions\n\n- **Risk**: Phaser 3.x may not work seamlessly with Vite out of the box (e.g., global `Phaser` variable, canvas/WebGL initialization). *Mitigation*: The official `create-phaser-game` CLI has a Vite template, so this path is well-trodden.\n- **Risk**: The flat monorepo approach may not scale if engine modules need independent versioning later. *Mitigation*: Acceptable for a spike-driven project; migration to workspaces can be done later without major refactoring.\n- **Assumption**: Phaser 3.x TypeScript definitions are up-to-date and compatible with strict mode (they are shipped in the `phaser` npm package under `types/`).\n- **Assumption**: A single Vite entry point can serve multiple example games. If not, a per-game Vite config or multi-page setup may be needed (discoverable during first game spike implementation).\n- **Assumption**: No CI/CD pipeline is needed in this scaffolding phase; local `npm test` and `npm run build` are sufficient validation.\n\n## Suggested Next Step\n\nBreak this epic into child work items for implementation: (1) git init + .gitignore, (2) package.json + Vite + TypeScript config, (3) directory structure + placeholder modules, (4) hello-world Phaser scene, (5) Vitest setup + first test, (6) AGENTS.md update. Then implement starting from work item CG-0MLSFU7300TLFCBH.\n\n## Related work (automated report)\n\nSearched Worklog (keyword: scaffold, setup, phaser, card game) and repository files. No duplicate or prior scaffolding work items found.\n\n- **AGENTS.md** (`/AGENTS.md`): The project charter defining the vision, directory structure, and tech stack for the Card Game Engine. This scaffolding work item directly implements the foundational setup described in AGENTS.md, with agreed deviations (Phaser 3.x instead of 4, Vite instead of Webpack, Vitest instead of Jest).\n- **9-Card Golf (CG-0MLSDW7YM1IWH2SB)**: The first and highest-priority game spike. It is directly unblocked by this scaffolding and will be the first consumer of the project structure, Phaser integration, and test framework established here. Its description references `Phaser Container` which validates the need for a working Phaser setup.\n- **Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)**, **Sushi Go! (CG-0MLSDWSCG154TUEL)**, **Splendor (CG-0MLSDX4B91DG6S1A)**, **Lost Cities (CG-0MLSDXELC06VESJL)**, **The Mind (CG-0MLSDXNMM1R2IMT9)**, **Coloretto (CG-0MLSDXY9F1FSGQ38)**: All 6 remaining game spikes are blocked pending scaffolding. Each references card abstractions (Card, Deck, Pile, Hand, etc.) that will live in the `src/card-system/` module created by this work.\n- **Official Phaser Webpack-TS template** (https://github.com/phaserjs/template-webpack-ts): The community reference implementation for Phaser + TypeScript project structure. While this project uses Vite instead of Webpack, the template's `src/` layout (scenes, game config, main entry point) is a useful structural reference.\n- **Phaser `create-phaser-game` CLI**: The official Phaser scaffolder supports Vite + TypeScript templates and should be consulted during implementation for best-practice Vite configuration patterns.","effort":"","id":"CG-0MLSFU7300TLFCBH","issueType":"epic","needsProducerReview":false,"parentId":null,"priority":"high","risk":"","sortIndex":1000,"stage":"in_review","status":"completed","tags":[],"title":"Scaffold Card Game Engine project","updatedAt":"2026-02-18T20:56:08.467Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T20:04:18.299Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nInitialize the git repository and create a comprehensive .gitignore covering Node.js, TypeScript, Vite, IDE, OS, and build output files.\n\n## User Story\n\nAs a game developer, I want the project under version control with a proper .gitignore so that build artifacts, IDE files, and OS files are never accidentally committed.\n\n## Acceptance Criteria\n\n- `git status` exits with code 0 from the repo root\n- `.gitignore` covers: `node_modules/`, `dist/`, `.vite/`, `*.js.map`, IDE files (`.idea/`, `.vscode/` settings), OS files (`.DS_Store`, `Thumbs.db`)\n- `.worklog/` ignore rules from the original `.gitignore` are preserved exactly\n- Existing files (AGENTS.md, .worklog/) are tracked in the initial commit\n\n## Minimal Implementation\n\n- Run `git init` in the repo root\n- Merge existing `.gitignore` entries with a comprehensive Node.js/TS/Vite .gitignore template\n- Stage all existing files and create the initial commit\n\n## Dependencies\n\nNone (first feature in the sequence)\n\n## Deliverables\n\n- Initialized `.git/` directory\n- Updated `.gitignore`\n- Initial commit","effort":"","id":"CG-0MLSGNEUY15SODX5","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSFU7300TLFCBH","priority":"high","risk":"","sortIndex":100,"stage":"in_review","status":"completed","tags":[],"title":"Initialize Git Repository and .gitignore","updatedAt":"2026-02-18T20:07:52.765Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T20:04:24.758Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSGNJUD0F48DHV","to":"CG-0MLSGNEUY15SODX5"}],"description":"## Summary\n\nCreate the project package.json with all required dependencies and configure Vite + TypeScript for Phaser 3.x development.\n\n## User Story\n\nAs a game developer, I want to run `npm install && npm run dev` to start a dev server with hot-reload so I can iterate quickly on game code. As a game developer, I want TypeScript configured with strict mode so I catch type errors early.\n\n## Acceptance Criteria\n\n- `package.json` exists with Phaser 3.x as a dependency and TypeScript, Vite, Vitest as devDependencies\n- `npm run dev` starts a Vite dev server and exits cleanly on Ctrl+C\n- `npm run build` produces files in `dist/` and exits with code 0\n- `npm run preview` serves the production build on a local port\n- `tsconfig.json` has `strict: true`, targets `ES2020`, and resolves Phaser type definitions\n- `vite.config.ts` is present and used by all three scripts\n\n## Minimal Implementation\n\n- Create `package.json` with scripts: `dev`, `build`, `preview`, `test`\n- Create `tsconfig.json` with strict mode, ES2020 target, module resolution for Vite\n- Create `vite.config.ts` with dev server config and production build output to `dist/`\n- Create `index.html` at root as the single entry point\n- Run `npm install` and verify all scripts work\n\n## Dependencies\n\n- Feature 1: Initialize Git Repository and .gitignore (git must exist for commits)\n\n## Deliverables\n\n- `package.json`\n- `tsconfig.json`\n- `vite.config.ts`\n- `index.html`","effort":"","id":"CG-0MLSGNJUD0F48DHV","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSFU7300TLFCBH","priority":"high","risk":"","sortIndex":200,"stage":"in_review","status":"completed","tags":[],"title":"Package.json, Vite, and TypeScript Config","updatedAt":"2026-02-18T20:11:13.021Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T20:04:31.999Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSGNPFI0ZX35FR","to":"CG-0MLSGNJUD0F48DHV"}],"description":"## Summary\n\nCreate the flat monorepo directory structure with barrel-file placeholders for all shared engine modules and the example-games area.\n\n## User Story\n\nAs a game developer, I want a clear directory structure so I know where to put shared engine code vs. game-specific code. As an engine consumer, I want shared modules organized in a discoverable way so I can import only what I need.\n\n## Acceptance Criteria\n\n- Directories exist: `src/core-engine/`, `src/card-system/`, `src/rule-engine/`, `src/ui/`, `example-games/`, `public/`, `tests/`\n- Each `src/` module has an `index.ts` with at least one named export\n- `npm run build` succeeds with the barrel files included\n- Relative imports between barrel files resolve without TypeScript errors\n\n## Minimal Implementation\n\n- Create directory tree as specified in the PRD\n- Create `src/core-engine/index.ts`, `src/card-system/index.ts`, `src/rule-engine/index.ts`, `src/ui/index.ts` with minimal placeholder exports\n- Verify `npm run build` still succeeds with the new files\n\n## Dependencies\n\n- Feature 2: Package.json, Vite, and TypeScript Config (TypeScript config must exist for barrel files to compile)\n\n## Deliverables\n\n- Directory tree matching the PRD layout\n- 4 barrel-file placeholder modules (`src/core-engine/index.ts`, `src/card-system/index.ts`, `src/rule-engine/index.ts`, `src/ui/index.ts`)","effort":"","id":"CG-0MLSGNPFI0ZX35FR","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSFU7300TLFCBH","priority":"high","risk":"","sortIndex":300,"stage":"in_review","status":"completed","tags":[],"title":"Directory Structure and Placeholder Modules","updatedAt":"2026-02-18T20:12:54.909Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T20:04:48.453Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSGO24L0PVQ8B9","to":"CG-0MLSGNPFI0ZX35FR"}],"description":"## Summary\n\nCreate a minimal Phaser 3.x scene in example-games/hello-world/ that renders a card sprite on a colored background, proving the full Vite + Phaser + TypeScript + asset pipeline works end-to-end.\n\n## User Story\n\nAs a game developer, I want to see a working Phaser scene with a card image rendered in the browser so I know the full toolchain (Vite dev server, TypeScript compilation, Phaser initialization, asset loading) works correctly before I start building real games.\n\n## Acceptance Criteria\n\n- `npm run dev` opens a browser showing a Phaser canvas with a colored background and at least one card sprite\n- The scene class extends `Phaser.Scene` and is located at `example-games/hello-world/scenes/HelloWorldScene.ts`\n- A CC0-licensed card image is loaded from `public/assets/cards/` and rendered\n- No console errors related to asset loading or Phaser initialization appear in browser dev tools\n- Asset attribution/license is documented in a credits file (e.g., `public/assets/CREDITS.md`)\n- `npm run build` includes the scene and assets in the production bundle\n\n## Prototype / Experiment\n\nVerify Phaser 3.x canvas initialization works with Vite dev server (HMR, asset serving). Success = scene renders without console errors.\n\n## Minimal Implementation\n\n- Source a CC0 playing card image set (e.g., from OpenGameArt or similar permissive source)\n- Place card image(s) in `public/assets/cards/`\n- Create `example-games/hello-world/main.ts` as the game entry point\n- Create `example-games/hello-world/scenes/HelloWorldScene.ts` extending `Phaser.Scene`\n- Wire the entry point into `index.html` (single-page setup)\n- Verify dev server renders the scene and production build works\n\n## Dependencies\n\n- Feature 2: Package.json, Vite, and TypeScript Config (build tooling must exist)\n- Feature 3: Directory Structure and Placeholder Modules (directory structure must exist)\n\n## Deliverables\n\n- `example-games/hello-world/main.ts`\n- `example-games/hello-world/scenes/HelloWorldScene.ts`\n- CC0 card assets in `public/assets/cards/`\n- Asset credits file","effort":"","id":"CG-0MLSGO24L0PVQ8B9","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSFU7300TLFCBH","priority":"high","risk":"","sortIndex":400,"stage":"in_review","status":"completed","tags":[],"title":"Hello-World Phaser Scene with Card Sprite","updatedAt":"2026-02-18T20:16:03.954Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T20:04:55.011Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSGO76R0YFSV77","to":"CG-0MLSGNJUD0F48DHV"}],"description":"## Summary\n\nConfigure Vitest and create at least one passing smoke test to prove the test framework is wired up correctly.\n\n## User Story\n\nAs a game developer, I want to run `npm test` and see at least one passing test so I know the test framework is properly configured and ready for game-specific tests.\n\n## Acceptance Criteria\n\n- `npm test` exits with code 0 and reports at least 1 passed test\n- At least one test file exists under `tests/`\n- The test is a trivial smoke test (e.g., `expect(1 + 1).toBe(2)`)\n- Vitest configuration is present (in `vite.config.ts` or separate `vitest.config.ts`)\n\n## Minimal Implementation\n\n- Add Vitest configuration (either inline in `vite.config.ts` or in a separate `vitest.config.ts`)\n- Create `tests/smoke.test.ts` with a trivial assertion\n- Verify `npm test` passes\n\n## Dependencies\n\n- Feature 2: Package.json, Vite, and TypeScript Config (Vitest installed via package.json)\n\n## Deliverables\n\n- Vitest configuration\n- `tests/smoke.test.ts`","effort":"","id":"CG-0MLSGO76R0YFSV77","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSFU7300TLFCBH","priority":"high","risk":"","sortIndex":500,"stage":"in_review","status":"completed","tags":[],"title":"Vitest Setup and Smoke Test","updatedAt":"2026-02-18T20:18:29.578Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T20:05:03.722Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSGODWP0IUDOBG","to":"CG-0MLSGO24L0PVQ8B9"},{"from":"CG-0MLSGODWP0IUDOBG","to":"CG-0MLSGO76R0YFSV77"}],"description":"## Summary\n\nRewrite AGENTS.md to reflect the actual tech stack (Phaser 3.x, Vite, Vitest), the real directory structure, and updated project overview and contribution guidance.\n\n## User Story\n\nAs a game developer or contributor, I want AGENTS.md to accurately describe the project setup, tech stack, and directory structure so I can quickly understand how to work on the project without guessing or discovering outdated information.\n\n## Acceptance Criteria\n\n- Technology stack section references Phaser 3.x, Vite, Vitest (not Phaser 4, Webpack, Jest)\n- Directory structure diagram matches the actual scaffold layout (`src/` with subdirectories, `example-games/`, `public/`, `tests/`, etc.)\n- Project overview describes the flat monorepo approach and spike-driven development philosophy\n- Contribution guidance reflects `npm run dev`, `npm test`, `npm run build` workflow\n- All content between `<!-- Start base Worklog AGENTS.md file -->` and `<!-- End base Worklog AGENTS.md file -->` markers is preserved unchanged\n\n## Minimal Implementation\n\n- Rewrite the technology stack section with Phaser 3.x, Vite, Vitest\n- Update the directory structure diagram to match the actual scaffold layout\n- Revise the project overview and component descriptions\n- Add or update contribution/development workflow guidance\n- Preserve all existing Worklog AGENTS.md content between the markers\n\n## Dependencies\n\n- Features 1-5 (rewrite should reflect the final state of the scaffold)\n\n## Deliverables\n\n- Updated `AGENTS.md`","effort":"","id":"CG-0MLSGODWP0IUDOBG","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSFU7300TLFCBH","priority":"high","risk":"","sortIndex":600,"stage":"in_review","status":"completed","tags":[],"title":"AGENTS.md Comprehensive Rewrite","updatedAt":"2026-02-18T20:21:50.854Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-18T20:34:43.933Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nAdd README.md at repo root and docs/DEVELOPER.md with detailed developer guidance. Update AGENTS.md to reference these docs and enforce a Worklog policy requiring doc updates when infra/tooling changes.\n\n## User Story\n\nAs a game developer or contributor, I want a README and developer guide so I can quickly understand the project, set up my environment, and know the development workflow without reading through AGENTS.md or guessing.\n\n## Acceptance Criteria\n\n- README.md exists at repo root with project summary, quick-start commands, repo layout, and contribution pointers\n- docs/DEVELOPER.md exists with environment setup, run/build/test instructions, example-game guide, and doc-update policy\n- AGENTS.md includes a Documentation section referencing README.md and docs/DEVELOPER.md\n- AGENTS.md includes a policy rule: any change that alters developer workflows MUST include a child work item to update docs\n- npm test and npm run build still pass after changes\n- A Worklog comment on parent epic noting docs were added","effort":"","id":"CG-0MLSHQJIU0097VRY","issueType":"task","needsProducerReview":false,"parentId":"CG-0MLSFU7300TLFCBH","priority":"high","risk":"","sortIndex":700,"stage":"in_review","status":"completed","tags":[],"title":"Add README and Developer Docs","updatedAt":"2026-02-18T20:39:04.030Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-18T20:34:47.638Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nAdd a pre-commit hook that warns or blocks commits touching config/infra files (package.json, tsconfig.json, vite.config.ts, etc.) when docs/DEVELOPER.md has not been updated in the same commit.\n\n## User Story\n\nAs a developer, I want automated reminders when I change tooling or infrastructure files so I do not forget to update the developer documentation.\n\n## Acceptance Criteria\n\n- A pre-commit hook script exists (e.g. via husky or a shell script in .githooks/)\n- The hook checks if config/infra files are staged and warns if docs/DEVELOPER.md is not also staged\n- The hook does not block commits to non-infra files\n- npm test and npm run build still pass\n- Documentation in docs/DEVELOPER.md describes how the hook works\n\n## Implementation Notes\n\ndiscovered-from:CG-0MLSFU7300TLFCBH","effort":"","id":"CG-0MLSHQMDY1H0I2B7","issueType":"task","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":1100,"stage":"idea","status":"open","tags":[],"title":"Add pre-commit hook to enforce doc updates","updatedAt":"2026-02-18T20:34:47.638Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-18T21:05:52.718Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nRename all references to the project from 'Card Game Spikes' / 'Card Game Engine' / 'card-game-engine' to 'Tableau Card Engine' (abbreviated TCE) across the entire codebase.\n\n## User Story\n\nAs a developer or contributor, I want the project to have a consistent, distinctive name -- Tableau Card Engine (TCE) -- so the branding is clear and unambiguous across all documentation, code, config, and tests.\n\n## Scope\n\n17 references across 9 files need updating:\n- AGENTS.md: directory tree reference (cardGameSpikes/) and contextual mentions\n- README.md: title, description, directory tree\n- package.json: name field and description\n- index.html: page title\n- docs/DEVELOPER.md: project name in intro\n- tests/smoke.test.ts: string literal in test\n- example-games/hello-world/main.ts: comment header\n- example-games/hello-world/scenes/HelloWorldScene.ts: display text\n- src/ui/index.ts: comment\n\n## Naming Convention\n\n- Full name: Tableau Card Engine\n- Acronym: TCE (used where brevity is appropriate, e.g. npm package name, short references)\n- npm package name: tableau-card-engine\n- Generic references to 'card games' remain unchanged where they describe the genre, not the project\n\n## Acceptance Criteria\n\n- All references to 'Card Game Spikes', 'Card Game Engine', 'card-game-engine', 'cardGameSpikes' are replaced with 'Tableau Card Engine' or 'TCE' as appropriate\n- npm package name changed to 'tableau-card-engine'\n- npm test passes\n- npm run build succeeds\n- No stale name references remain outside .worklog/, node_modules/, dist/, package-lock.json","effort":"","id":"CG-0MLSIULHH0Y6I3DV","issueType":"chore","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":1200,"stage":"in_review","status":"completed","tags":[],"title":"Rename project to Tableau Card Engine (TCE)","updatedAt":"2026-02-18T21:11:53.981Z"},"type":"workitem"}
{"data":{"assignee":"Map","createdAt":"2026-02-18T23:04:21.826Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSN2YWY1EL17FN","to":"CG-0MLSDW7YM1IWH2SB"}],"description":"# Intake Brief: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)\n\n**Priority: High** | **Type: Feature** | **Assignee: Map**\n\n> Playwright-driven dev tool that replays JSON game transcripts, captures per-turn screenshots, and supports live browser takeover for interactive bug reproduction.\n\n## Problem Statement\n\nThe Tableau Card Engine produces JSON game transcripts capturing every turn, but there is no way to visually replay a recorded game. Developers debugging game logic or UI issues must manually play through games to reproduce bugs, and there is no automated way to generate screenshots or videos of completed games for visual verification, regression testing, or documentation.\n\n## Users\n\n- **Engine developer:** Needs to visually verify that game state rendering matches expected behavior across all turns, catch rendering bugs, and reproduce reported visual issues without manual play.\n  - *\"As an engine developer, I want to replay a recorded game transcript and see per-turn screenshots so I can verify rendering correctness and visually debug game state issues.\"*\n\n- **QA / tester:** Needs to generate reproducible visual evidence of bugs and regressions by replaying specific game transcripts that trigger known issues.\n  - *\"As a QA tester, I want to replay a game transcript that reproduces a bug, pause at the problematic turn, and take over interactively to investigate the issue in a live browser.\"*\n\n- **Game designer:** Needs to review complete game playthroughs visually without playing them, for tuning game feel, animations, and UI layout.\n  - *\"As a game designer, I want to watch a recorded game play back visually so I can evaluate the game's visual presentation and identify UI improvements.\"*\n\n## Success Criteria\n\n1. **Screenshot capture:** Running `npm run replay -- data/transcripts/golf/game-001.json --output data/screenshots/golf/game-001/` replays the transcript in a headless Playwright browser and produces a PNG screenshot after each turn, saved to the specified output directory.\n2. **Transcript auto-save:** Games automatically save completed transcripts to browser storage (IndexedDB preferred, localStorage fallback) with a rolling window of the last 10 games. A CLI script (`npm run transcripts:export -- golf`) extracts transcripts from browser storage to `data/transcripts/golf/` on disk. An in-game export button also allows manual JSON download.\n3. **Partial replay with takeover:** The replay tool supports `--stop-at <turn>` (e.g., `npm run replay -- transcript.json --stop-at 12`) which pauses replay at the specified turn and keeps the browser open in non-headless mode, allowing the developer to take manual control and play from that point.\n4. **Engine event system:** The core engine module (`src/core-engine/`) emits standardized events (`turn-started`, `turn-completed`, `animation-complete`, `state-settled`, `game-ended`) that the replay tool listens for to ensure precise timing between turns.\n5. **Golf game support:** The tool works with the existing 9-Card Golf transcript format (version 1) as the initial supported game, with architecture designed to support additional games without major refactoring.\n6. **Documentation:** `docs/DEVELOPER.md` is updated with usage instructions for the replay tool, transcript auto-save/export, and the engine event system.\n\n## Constraints\n\n- **Canvas-based rendering:** Phaser renders to a WebGL/Canvas element, not DOM. Playwright cannot use CSS selectors for game elements. The tool must use coordinate-based clicking or the game must expose hit area information for reliable interaction.\n- **Browser storage for persistence:** Transcripts are saved to localStorage/IndexedDB since the game runs in a browser and the Vite dev server does not natively support disk writes. A separate CLI step is needed to extract transcripts to disk files.\n- **Playwright dependency:** Playwright is already a devDependency (^1.58.2) used for Vitest browser tests. The replay tool must not conflict with the existing test configuration.\n- **Existing transcript schema:** The tool must consume the existing `GameTranscript` format (version 1) defined in `example-games/golf/GameTranscript.ts`. Changes to the schema should be backward-compatible.\n- **Video capture is a stretch goal:** Per-turn PNG screenshots are the primary output. Stitching screenshots into a video or recording continuous video is deferred to a follow-up enhancement.\n- **Licensing:** All new dependencies must be permissively licensed (MIT, Apache 2.0, CC0, or similar).\n\n## Existing State\n\n- **Transcript system:** A well-tested `TranscriptRecorder` class exists in `example-games/golf/GameTranscript.ts` that captures complete board state per turn (player grids, discard pile, stock count, scores). The transcript is currently held in-memory only and used for the end-of-game results screen.\n- **Transcript format:** Version 1 schema is defined as TypeScript interfaces (`GameTranscript`, `TurnRecord`, `BoardSnapshot`, `CardSnapshot`, `GameResults`). Comprehensive unit and integration tests validate transcript correctness and JSON round-trip serialization.\n- **Playwright integration:** Already installed as a devDependency and configured as the Vitest browser test provider (headless Chromium). Browser tests exist for Golf UI interactions (`tests/golf/GolfInteraction.browser.test.ts`).\n- **No replay tool:** No replay, playback, or screenshot capture functionality exists. No dev tools infrastructure exists. No `tools/` directory.\n- **No transcript persistence:** Transcripts are not saved to disk or browser storage. They exist only in-memory during a game session.\n- **No engine event system:** The core engine does not emit events for turn lifecycle or animation timing. The Golf scene manages its own animation callbacks internally.\n\n## Desired Change\n\nBuild a developer replay tool with these capabilities:\n\n### Transcript Persistence (child task)\n- Implement auto-save of completed game transcripts to browser storage (localStorage or IndexedDB) after each game.\n- Maintain a rolling window of the last 10 transcripts per game.\n- Add an in-game export button that downloads the current transcript as a JSON file.\n- Create a CLI extraction script (`npm run transcripts:export`) that uses Playwright to connect to the game, read transcripts from browser storage, and write them as JSON files to `data/transcripts/<game>/`.\n- Add `data/` to `.gitignore`.\n\n### Core Engine Event System (child task)\n- Add a standardized event emitter to the core engine module (`src/core-engine/`) that games can use to signal turn lifecycle events.\n- Define events: `turn-started`, `turn-completed`, `animation-complete`, `state-settled`, `game-ended`.\n- Integrate the event system into the Golf scene so it emits these events at appropriate points.\n- Design for reuse across all example games.\n\n### Replay Tool (primary deliverable)\n- Create an npm script entry point (`npm run replay`) that accepts a transcript JSON file path and replays it.\n- Use Playwright to launch the game in a headless browser, then drive it through recorded turns using coordinate-based UI automation.\n- Use core engine events to synchronize between turns (wait for `state-settled` before capturing screenshots and advancing).\n- Capture a PNG screenshot of the Phaser canvas after each turn, saved to a configurable output directory (default: `data/screenshots/<game>/<timestamp>/`).\n- Support `--stop-at <turn>` to pause at a specific turn, switch to non-headless mode, and hand the browser off to the developer for interactive takeover.\n- Produce a summary report (JSON) listing turns replayed, screenshot paths, and any errors encountered.\n- Design the tool architecture to be game-agnostic where possible, with game-specific adapters for translating transcript moves into UI interactions.\n\n### Documentation\n- Update `docs/DEVELOPER.md` with usage instructions for the replay tool, transcript export, and the engine event system.\n\n## Risks & Assumptions\n\n### Risks\n- **Canvas interaction reliability:** Coordinate-based clicking on Phaser canvas elements may be fragile if game layout changes or window size varies. Mitigation: use the engine event system and game-exposed hit area data to improve targeting; pin viewport dimensions during replay.\n- **Animation timing:** Replaying turns faster than animations complete could cause visual artifacts or incorrect screenshots. Mitigation: the engine event system (`state-settled` event) ensures the tool waits for animations to finish before capturing.\n- **Browser storage limits:** localStorage has a ~5-10MB limit; 10 transcripts of complex games could approach this. Mitigation: use IndexedDB (larger quota) or compress transcripts before storage.\n- **Scope creep:** This work item touches multiple systems (persistence, events, UI automation, CLI tooling). Mitigation: break into child tasks, implement incrementally, and record additional feature ideas (video capture, multi-game support) as separate work items rather than expanding scope.\n- **Cross-game generalization:** Designing the event system and replay architecture for reuse before a second game validates it may lead to premature abstraction. Mitigation: implement for Golf first, keep interfaces minimal, refactor when Beleaguered Castle or another game adds replay support.\n- **Dev server dependency:** The replay tool assumes a running Vite dev server at `localhost:3000`. If the server is not running, replay will fail silently or with an unclear error. Mitigation: the replay script should check for a running server before launching Playwright and provide a clear error message with instructions to start the dev server.\n- **Transcript schema drift:** If the transcript format evolves (e.g., for Beleaguered Castle), older transcripts may become incompatible. Mitigation: the transcript schema includes a `version` field; the replay tool should validate the version and fail gracefully with a clear message if the format is unsupported.\n\n### Assumptions\n- Playwright's canvas screenshot API produces sufficiently high-quality captures of the Phaser rendering for visual verification.\n- The existing Golf scene's UI layout is stable enough for coordinate-based interaction (card positions, pile locations are deterministic for a given viewport size).\n- The `state-settled` event pattern is sufficient for synchronizing between turns without needing frame-level precision.\n- IndexedDB or localStorage provides adequate storage for 10 rolling transcripts without performance issues.\n- The Vite dev server will be running when the replay tool is invoked (the tool connects to `localhost:3000`).\n\n## Related Work\n\n- **9-Card Golf (CG-0MLSDW7YM1IWH2SB)** [completed]: The first game spike. Produces the game transcripts this tool will consume. Transcript format defined in `example-games/golf/GameTranscript.ts`.\n- **Game Transcript Recording (CG-0MLSPIQ1516DJNQL)** [completed]: Implemented the `TranscriptRecorder` class and transcript schema used by this tool.\n- **Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)** [in-progress]: Second game spike. Will be a consumer of the replay tool and engine event system once completed.\n- **Scaffold Card Game Engine (CG-0MLSFU7300TLFCBH)** [completed]: Established the repository structure and tooling this tool builds on.\n- **Golf browser tests** (`tests/golf/GolfInteraction.browser.test.ts`): Existing Playwright-based UI tests for the Golf scene. Demonstrates patterns for Phaser canvas interaction via Playwright that the replay tool can build on.\n\n## Suggested Next Step\n\nBreak CG-0MLSN2YWY1EL17FN into child work items covering: transcript persistence (auto-save + export), core engine event system, replay tool implementation, and documentation. Then begin implementation per `wl next`.\n\n\n## Related work (automated report)\n\nSearched Worklog (39 items) and repository files for keywords: replay, transcript, screenshot, Playwright, event, persistence, browser, automation, canvas, dev tool, recording, game log. The following items have clear, direct relevance to the Game Log Visual Replay Dev Tool.\n\n### Worklog items\n\n- **9-Card Golf (CG-0MLSDW7YM1IWH2SB)** [completed]: The first game spike and a formal dependency (via `wl dep`). Produces the JSON game transcripts this tool will consume. The transcript format (version 1) and TranscriptRecorder class were built as part of this epic. The replay tool requires a working game to replay against.\n\n- **Game Transcript Recording (CG-0MLSPIQ1516DJNQL)** [completed]: Implemented the `TranscriptRecorder` class, `GameTranscript` schema (version 1), and JSON round-trip serialization in `example-games/golf/GameTranscript.ts`. This is the direct data source the replay tool will consume. Its description explicitly references CG-0MLSN2YWY1EL17FN as a downstream consumer.\n\n- **Phaser UI Browser Testing with Vitest (CG-0MLSUJIE30K54IUO)** [completed]: Established the Playwright + Vitest browser mode infrastructure (headless Chromium, `*.browser.test.ts` convention, viewport pinning) that the replay tool can reuse for launching and automating the Phaser game. Demonstrates patterns for accessing the game instance via `window.__PHASER_GAME__` and interacting with canvas-rendered content.\n\n- **Investigate and fix broken Golf UI interactions (CG-0MLSW8TKZ0YHXJR2)** [completed]: Fixed click handling, turn flow, and AI execution in the Golf scene. The interaction patterns validated here (click stock pile, click grid cards, AI turn execution) are the same actions the replay tool must automate via Playwright coordinate-based clicks.\n\n- **Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0)** [completed]: Provides the game state management and turn sequencing foundation in `src/core-engine/`. The replay tool's engine event system (Success Criterion #4: `turn-started`, `turn-completed`, `state-settled`, etc.) will extend this module with event emission capabilities.\n\n- **Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)** [open]: The second game spike. Will be a future consumer of the replay tool and engine event system. The replay tool architecture should be game-agnostic enough to support this game once it is complete, validating the adapter pattern.\n\n- **Scaffold Card Game Engine project (CG-0MLSFU7300TLFCBH)** [completed]: Established repository structure, Vite/TypeScript toolchain, and module layout. The replay tool builds on this infrastructure (npm scripts, path aliases, build pipeline).\n\n### Repository files\n\n- **`example-games/golf/GameTranscript.ts`**: Defines the `GameTranscript`, `TurnRecord`, `BoardSnapshot`, and `CardSnapshot` TypeScript interfaces that the replay tool will parse. Also contains the `TranscriptRecorder` class. This is the primary data contract the replay tool depends on.\n\n- **`tests/golf/GameTranscript.test.ts`**: Unit tests for transcript recording and schema validation. Demonstrates how to create, populate, and finalize transcripts programmatically — useful reference for the replay tool's transcript parsing logic.\n\n- **`tests/golf/Integration.test.ts`**: Integration tests that run complete AI-vs-AI games and validate transcript output. Shows end-to-end transcript generation patterns and provides example transcripts the replay tool can use for testing.\n\n- **`tests/golf/GolfInteraction.browser.test.ts`**: Playwright-based browser tests for Golf UI interactions (click handling, turn flow). Demonstrates coordinate-based Phaser canvas interaction patterns that the replay tool must replicate for driving turns via UI automation.\n\n- **`tests/golf/GolfScene.browser.test.ts`**: Browser tests verifying Phaser game boot, rendering, and canvas presence. Shows how to launch the game in headless Chromium and access game state via `window.__PHASER_GAME__` — directly applicable to the replay tool's browser automation.\n\n- **`example-games/golf/main.ts`**: Entry point that exposes the Phaser game instance via `window.__PHASER_GAME__` (line 13). The replay tool will use this global reference to synchronize with game state and listen for engine events.\n\n- **`vite.config.ts`**: Configures Playwright as the Vitest browser test provider with headless Chromium and pinned viewport (900x700). The replay tool must be compatible with this configuration and may reuse the same Playwright setup for launching the game.\n\n- **`src/core-engine/index.ts`**: Barrel file for the core engine module. Currently exports GameState, TurnSequencer, and phase management — but does not export any event emitter. The replay tool's engine event system (Success Criterion #4) will need to add event emission here.","effort":"","id":"CG-0MLSN2YWY1EL17FN","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"high","risk":"","sortIndex":1300,"stage":"plan_complete","status":"open","tags":[],"title":"Game Log Visual Replay Dev Tool","updatedAt":"2026-02-19T12:30:36.218Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T00:11:39.458Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nSource, resize, and integrate a complete 52-card SVG deck from saulspatz/SVGCards (public domain) at 140x190px into the project asset pipeline.\n\n## User Story\n\nAs an engine developer, I want a complete set of 52 card face SVGs at the project's standard dimensions (140x190px) so that any example game can render a full deck visually without placeholder graphics.\n\n## Acceptance Criteria\n\n- 52 individual card face SVGs exist in public/assets/cards/ at 140x190px\n- Existing card back SVG is retained or replaced with one from the same set\n- public/assets/CREDITS.md updated with saulspatz/SVGCards attribution (public domain)\n- SVGs load correctly via this.load.svg() in a Phaser scene (verified in hello-world or golf scene)\n- SVG files contain valid SVG markup (no broken XML)\n- File naming convention is consistent (e.g., 2_of_clubs.svg, king_of_hearts.svg)\n\n## Minimal Implementation\n\n- Download saulspatz/SVGCards Vertical2 deck (https://github.com/saulspatz/SVGCards)\n- Extract individual SVGs using the provided exportSVG.py script or manually from the Decks/Vertical2/svgs folder\n- Resize from 210x315px to 140x190px (same 2:3 aspect ratio) via script or batch tool\n- Adopt consistent naming convention matching existing assets\n- Update public/assets/CREDITS.md with attribution\n\n## Prototype / Experiment\n\nVerify saulspatz/SVGCards export produces usable individual SVGs and that Phaser loads them at 140x190px without rendering artifacts. Success = at least 4 cards (one per suit) render correctly in the hello-world scene.\n\n## Dependencies\n\nNone (can be worked in parallel with Features 2 and 3)\n\n## Deliverables\n\n- 52 SVG card face files in public/assets/cards/\n- Updated public/assets/CREDITS.md","effort":"","id":"CG-0MLSPHIDD19PBDOZ","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":100,"stage":"in_progress","status":"completed","tags":[],"title":"Card Asset Pipeline","updatedAt":"2026-02-19T01:46:55.409Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T00:11:47.939Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nImplement Card, Deck, and Pile abstractions in src/card-system/ as the foundational data models consumed by all game spikes.\n\n## User Story\n\nAs an engine developer, I want Card, Deck, and Pile types with well-defined APIs so that every example game can import and use standard card data structures without reimplementing them.\n\n## Acceptance Criteria\n\n- Card type exported with rank, suit, faceUp properties\n- Deck exported with create() (standard 52-card), shuffle(), draw() methods\n- Pile exported with push(), pop(), peek(), isEmpty(), size() methods\n- Drawing from an empty deck has defined behavior (throws or returns null/undefined)\n- Unit tests cover: deck creation (52 cards, no duplicates), shuffle (changes order), draw (removes from top), pile operations\n- npm test passes; npm run build succeeds\n- Barrel file src/card-system/index.ts exports all public types and functions\n\n## Minimal Implementation\n\n- Define Rank (enum or union: A, 2-10, J, Q, K), Suit (enum or union: clubs, diamonds, hearts, spades), Card (interface with rank, suit, faceUp)\n- Implement Deck as a factory + operations on Card arrays\n- Implement Pile as a stack abstraction over Card arrays\n- Write unit tests in tests/card-system/\n\n## Dependencies\n\nNone (can be worked in parallel with Features 1 and 3)\n\n## Deliverables\n\n- src/card-system/ implementation (Card, Deck, Pile)\n- Unit tests in tests/card-system/","effort":"","id":"CG-0MLSPHOWY1HSCIDX","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":200,"stage":"in_progress","status":"completed","tags":[],"title":"Card System Engine Module","updatedAt":"2026-02-19T00:21:16.134Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T00:11:54.577Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nImplement minimal turn sequencing and game state management in src/core-engine/ sufficient to drive a 2-player (human + AI) game loop.\n\n## User Story\n\nAs an engine developer, I want a reusable turn sequencer and game state container so that any 2+ player game can manage turn order, game phases, and player state transitions without reimplementing this logic.\n\n## Acceptance Criteria\n\n- GameState type tracks current player, game phase (setup, playing, ended), and per-player state\n- TurnSequencer manages player turn order and advancing turns\n- Advancing turn when game phase is ended has defined behavior (throws or is a no-op)\n- State transitions are explicit (immutable approach or clearly defined mutations)\n- Unit tests cover: turn advancement, game phase transitions, 2-player turn alternation\n- npm test passes; npm run build succeeds\n- Barrel file src/core-engine/index.ts exports all public types and functions\n\n## Minimal Implementation\n\n- Define GamePhase enum (setup, playing, ended)\n- Define GameState<T> generic container (player states array, current player index, phase)\n- Implement TurnSequencer (advanceTurn, getCurrentPlayer, isGameOver)\n- Write unit tests in tests/core-engine/\n\n## Dependencies\n\nNone (can be worked in parallel with Features 1 and 2)\n\n## Deliverables\n\n- src/core-engine/ implementation (GameState, TurnSequencer, GamePhase)\n- Unit tests in tests/core-engine/","effort":"","id":"CG-0MLSPHU1C02RAGE0","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":300,"stage":"in_progress","status":"completed","tags":[],"title":"Core Engine Turn Sequencer","updatedAt":"2026-02-19T00:33:37.860Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T00:12:15.219Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSPI9YQ083H8LO","to":"CG-0MLSPHOWY1HSCIDX"}],"description":"## Summary\n\nImplement 9-Card Golf-specific game rules, turn legality validation, scoring logic, and the 3x3 Grid type locally in example-games/golf/.\n\n## User Story\n\nAs a player of 9-Card Golf, I want the game to correctly enforce turn rules (draw from stock or discard, then swap or discard) and calculate scores (A=1, 2=-2, 3-10=face, J/Q=10, K=0, column-of-three=0) so that every game is played and scored correctly.\n\n## Acceptance Criteria\n\n- GolfGrid type represents a 3x3 arrangement of Cards (some face-up, some face-down)\n- Scoring correctly implements: A=1, 2=-2, 3-10=face value, J/Q=10, K=0, column-of-three-of-a-kind=0\n- Turn legality: player can draw from stock or discard pile; then must swap drawn card with a grid card (flipping it face-up) or discard the drawn card\n- End-of-round detection: round ends when any player has all 9 cards face-up; each other player gets one final turn\n- Attempting to swap a card at an invalid grid position (out of bounds) is rejected as illegal\n- Initial card reveal: player flips 3 cards at the start of the round\n- At least 3 scoring unit tests (including column-of-three-of-a-kind case)\n- At least 2 turn legality tests (valid and invalid moves)\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Define GolfGrid type (3x3 array of Card slots) in example-games/golf/\n- Implement scoreGrid() function with column-matching logic\n- Implement GolfRules module: isLegalMove(), applyMove(), isRoundOver()\n- Implement initial card reveal logic (player selects 3 cards to flip)\n- Write unit tests in tests/golf/\n\n## Dependencies\n\n- Card System Engine Module (CG-0MLSPHOWY1HSCIDX) — requires Card type\n\n## Deliverables\n\n- Golf rules module in example-games/golf/\n- Scoring logic with scoreGrid()\n- GolfGrid type\n- Unit tests in tests/golf/","effort":"","id":"CG-0MLSPI9YQ083H8LO","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":400,"stage":"in_progress","status":"completed","tags":[],"title":"Golf Game Rules and Scoring","updatedAt":"2026-02-19T01:41:01.250Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T00:12:23.963Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSPIGPM0HRCCYE","to":"CG-0MLSPHU1C02RAGE0"},{"from":"CG-0MLSPIGPM0HRCCYE","to":"CG-0MLSPI9YQ083H8LO"}],"description":"## Summary\n\nImplement an AI player with two selectable strategies (random and greedy) that can play complete games of 9-Card Golf.\n\n## User Story\n\nAs a tester, I want an AI opponent that can play complete games automatically using either random or greedy strategies so I can validate scoring, turn flow, and edge cases without manual play.\n\n## Acceptance Criteria\n\n- AiPlayer interface defines chooseAction(gameState): Action\n- RandomStrategy selects a uniformly random legal move each turn\n- GreedyStrategy selects the move that minimizes visible score (considering face-up cards only)\n- Strategy is selectable via constructor parameter or configuration\n- Both strategies produce legal moves in all tested game states, including edge cases (only one legal move available, all cards face-up)\n- At least one test runs a complete game with each strategy to completion without errors\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Define AiStrategy interface with chooseAction method\n- Implement RandomStrategy: enumerate legal moves via GolfRules, pick one randomly\n- Implement GreedyStrategy: enumerate legal moves, evaluate each by resulting visible score, pick lowest\n- Implement AiPlayer wrapper that delegates to a selected strategy\n- Write unit tests in tests/golf/\n\n## Dependencies\n\n- Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0) — requires GameState and turn management\n- Golf Game Rules and Scoring (Feature 4) — requires GolfRules for legal move enumeration\n\n## Deliverables\n\n- AI player module in example-games/golf/\n- RandomStrategy and GreedyStrategy implementations\n- Unit tests in tests/golf/","effort":"","id":"CG-0MLSPIGPM0HRCCYE","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":500,"stage":"in_progress","status":"completed","tags":[],"title":"AI Player","updatedAt":"2026-02-19T01:54:00.953Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T00:12:36.065Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSPIQ1516DJNQL","to":"CG-0MLSPHU1C02RAGE0"},{"from":"CG-0MLSPIQ1516DJNQL","to":"CG-0MLSPI9YQ083H8LO"}],"description":"## Summary\n\nImplement replay-ready JSON transcript recording that captures full board state per turn, sufficient for the Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN).\n\n## User Story\n\nAs a tester, I want each completed game to produce a JSON transcript capturing all turns, actions, and board states so I can replay games for debugging and regression testing.\n\n## Acceptance Criteria\n\n- Each completed game produces a JSON transcript file\n- Transcript includes: game metadata (timestamp, players, strategies), initial deal state, per-turn records (player, action, resulting board state for both players, pile states, scores)\n- Transcript includes final scores and winner\n- Transcript format is documented as TypeScript interfaces (GameTranscript, TurnRecord, BoardSnapshot)\n- Transcript JSON is valid per the documented TypeScript interfaces (verified by parsing and type-checking in tests)\n- A completed AI-vs-AI game produces a valid, parseable transcript\n- Most recent 10 replays stored in example-games/golf/replays/ per AGENTS.md policy\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Define GameTranscript, TurnRecord, BoardSnapshot TypeScript interfaces in example-games/golf/\n- Implement TranscriptRecorder that hooks into the game loop and records each turn\n- Serialize to JSON and write to example-games/golf/replays/\n- Implement replay file rotation (keep most recent 10)\n- Write schema validation test\n\n## Dependencies\n\n- Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0) — requires GameState for board snapshots\n- Golf Game Rules and Scoring (Feature 4) — requires GolfGrid and scoring for state capture\n\n## Related Work\n\n- Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN) — will consume this transcript format\n\n## Deliverables\n\n- Transcript TypeScript interfaces\n- TranscriptRecorder implementation\n- Schema documentation\n- Unit tests in tests/golf/","effort":"","id":"CG-0MLSPIQ1516DJNQL","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":600,"stage":"in_progress","status":"completed","tags":[],"title":"Game Transcript Recording","updatedAt":"2026-02-19T01:57:12.798Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T00:13:01.161Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSPJ9EW1WGHKLX","to":"CG-0MLSPHIDD19PBDOZ"},{"from":"CG-0MLSPJ9EW1WGHKLX","to":"CG-0MLSPHOWY1HSCIDX"},{"from":"CG-0MLSPJ9EW1WGHKLX","to":"CG-0MLSPHU1C02RAGE0"},{"from":"CG-0MLSPJ9EW1WGHKLX","to":"CG-0MLSPI9YQ083H8LO"},{"from":"CG-0MLSPJ9EW1WGHKLX","to":"CG-0MLSPIGPM0HRCCYE"},{"from":"CG-0MLSPJ9EW1WGHKLX","to":"CG-0MLSPIQ1516DJNQL"}],"description":"## Summary\n\nBuild a single GolfScene Phaser scene implementing the complete visual interface for 9-Card Golf: 3x3 grid layout, draw/discard piles, card flip/swap animations, score display, and turn indicators.\n\n## User Story\n\nAs a player, I want to play a complete round of 9-Card Golf in my browser — seeing my 3x3 grid, drawing and swapping cards with smooth animations, and viewing scores — so I can experience the full game visually.\n\n## Acceptance Criteria\n\n- GolfScene renders both players' 3x3 grids, a draw pile, and a discard pile\n- Human player interacts via click/tap: draw from pile or discard, select grid card to swap, or discard drawn card\n- Card flip and swap animations use Phaser tweens\n- Current player and turn phase are visually indicated\n- Score display updates after each turn\n- End-of-round screen shows final scores and winner\n- AI strategy is selectable (e.g., buttons at game start or config)\n- No unhandled JavaScript errors appear in browser console during a complete game\n- Game is playable from start to finish via npm run dev\n\n## Minimal Implementation\n\n- Create example-games/golf/scenes/GolfScene.ts extending Phaser.Scene\n- Create example-games/golf/main.ts entry point with Phaser game config\n- Implement card layout using grid math (3 columns x 3 rows per player)\n- Implement input handling for draw, swap, discard actions\n- Add tween animations for card flip (scale X 0 to 1 with texture swap at midpoint) and swap (translate)\n- Wire up AI player to play automatically on its turn (with configurable delay for visual effect)\n- Wire up TranscriptRecorder to record each turn\n- Update index.html or add routing for the golf game\n\n## Prototype / Experiment\n\nVerify Phaser tweens produce acceptable card-flip animation (scale X 0 to 1 with texture swap at midpoint). Success = flip animation looks natural at 60fps in dev server.\n\n## Dependencies\n\n- Card Asset Pipeline (CG-0MLSPHIDD19PBDOZ) — requires card SVGs for rendering\n- Card System Engine Module (CG-0MLSPHOWY1HSCIDX) — requires Card/Deck/Pile types\n- Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0) — requires GameState and turn management\n- Golf Game Rules and Scoring (CG-0MLSPI9YQ083H8LO) — requires GolfGrid, scoring, turn logic\n- AI Player (CG-0MLSPIGPM0HRCCYE) — requires AI opponent\n- Game Transcript Recording (CG-0MLSPIQ1516DJNQL) — requires TranscriptRecorder\n\n## Open Questions\n\n- Consider breaking into sub-tasks during implementation planning (large but atomically valuable)\n\n## Deliverables\n\n- example-games/golf/scenes/GolfScene.ts\n- example-games/golf/main.ts\n- Playable game in browser","effort":"","id":"CG-0MLSPJ9EW1WGHKLX","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":700,"stage":"in_progress","status":"completed","tags":[],"title":"Golf Phaser UI","updatedAt":"2026-02-19T02:03:52.327Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T00:13:09.574Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLSPJFWL14OQNJ5","to":"CG-0MLSPJ9EW1WGHKLX"}],"description":"## Summary\n\nAdd end-to-end integration tests that run complete AI-vs-AI games and verify all quality gates, plus update project documentation to include the Golf game.\n\n## User Story\n\nAs an engine developer, I want integration tests that prove a complete game works end-to-end (rules, scoring, AI, transcript) and documentation that tells future contributors how to run and extend the Golf game.\n\n## Acceptance Criteria\n\n- Integration test runs a full AI-vs-AI game (random strategy) and verifies: game completes, valid transcript is produced, final scores are calculated correctly\n- Integration test runs a full AI-vs-AI game (greedy strategy) and verifies the same\n- npm test passes all tests (unit + integration)\n- npm run build succeeds\n- docs/DEVELOPER.md updated with Golf game entry in example games section\n- README.md updated with Golf in the example games table\n- No regressions in existing hello-world example or smoke tests\n\n## Minimal Implementation\n\n- Write integration tests in tests/golf/ that instantiate game state, run game loop with AI players, assert completion\n- Verify transcript output programmatically (parse JSON, check required fields)\n- Update docs/DEVELOPER.md with Golf game entry\n- Update README.md example games table\n\n## Dependencies\n\n- All previous features (1-7) must be complete\n\n## Deliverables\n\n- Integration tests in tests/golf/\n- Updated README.md\n- Updated docs/DEVELOPER.md","effort":"","id":"CG-0MLSPJFWL14OQNJ5","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":800,"stage":"in_progress","status":"completed","tags":[],"title":"Integration Test and Documentation","updatedAt":"2026-02-19T02:10:00.696Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T02:33:10.876Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nAdd Vitest browser mode testing with Playwright to enable automated testing of the Phaser-rendered Golf UI in a real browser environment. This addresses the broken UI that currently has no automated test coverage.\n\n## User Story\n\nAs an engine developer, I want automated browser tests that verify the Phaser game renders correctly and responds to user interactions, so that UI regressions are caught before they reach players.\n\n## Problem\n\nThe Golf Phaser UI (GolfScene.ts) has 674 lines of rendering and interaction code with zero automated test coverage. The UI is reported broken but there is no way to detect or prevent regressions. Phaser requires a real browser (WebGL/Canvas) and cannot run in JSDOM or happy-dom.\n\n## Approach\n\n- Use Vitest 3.x browser mode with `@vitest/browser` package and Playwright provider\n- Configure test projects in vite.config.ts to run Node-based unit tests (`*.test.ts`) and browser-based tests (`*.browser.test.ts`) together via `npm test`\n- Browser tests run in headless Chromium via Playwright\n- Tests verify: canvas renders, game objects exist, basic interaction works\n- Access Phaser game instance via `window.__PHASER_GAME__` for state assertions\n\n## Acceptance Criteria\n\n1. `@vitest/browser` and `playwright` are installed as dev dependencies\n2. `vite.config.ts` uses `test.projects` to define both unit and browser test configurations\n3. Browser tests use `*.browser.test.ts` naming convention\n4. At least one browser test verifies the Phaser canvas renders in the game container\n5. At least one browser test verifies initial game state is visible (card sprites, UI text)\n6. All existing 204 unit tests continue to pass alongside new browser tests\n7. `npm test` runs both unit and browser tests in a single command\n8. `npm run build` continues to succeed\n9. Tests run headless (no visible browser window) for CI compatibility\n10. docs/DEVELOPER.md updated with browser testing section\n\n## Dependencies\n\n- All 8 Golf epic features (complete)\n- Vitest 3.2.4 (installed)\n\n## Related Work\n\n- discovered-from:CG-0MLSDW7YM1IWH2SB (Golf epic)\n- related-to:CG-0MLSPJ9EW1WGHKLX (Golf Phaser UI)\n- related-to:CG-0MLSN2YWY1EL17FN (Visual Replay Dev Tool)","effort":"","id":"CG-0MLSUJIE30K54IUO","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":900,"stage":"in_progress","status":"completed","tags":[],"title":"Phaser UI Browser Testing with Vitest","updatedAt":"2026-02-19T02:51:11.616Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T03:20:51.395Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nThe Golf Phaser UI is reported broken. Browser tests confirm the game boots and renders correctly (canvas, sprites, text, interactive elements, no console errors), so the issue is likely in game interaction logic — click handling, turn flow, AI execution, or state transitions.\n\n## User Story\n\nAs a player, I want the Golf game UI to respond correctly to my clicks (drawing cards, swapping, discarding) and execute AI turns properly, so I can play a complete round of 9-Card Golf.\n\n## Approach\n\n1. Review GolfScene.ts interaction code for logic errors\n2. Add interaction-level browser tests (click stock pile, click discard, click grid cards, AI turn execution)\n3. Identify and fix the broken behavior\n4. Ensure all tests pass after fixes\n\n## Acceptance Criteria\n\n1. Player can click stock pile to draw a card\n2. After drawing, player can click a grid card to swap or click discard to discard\n3. AI turn executes after player turn completes\n4. Turn indicator updates correctly between turns\n5. Game reaches end-of-round and displays final scores\n6. All existing 210 tests continue to pass\n7. New browser tests cover the interaction flow\n8. npm run build succeeds\n\n## Related Work\n\n- discovered-from:CG-0MLSDW7YM1IWH2SB\n- related-to:CG-0MLSPJ9EW1WGHKLX (Golf Phaser UI)\n- related-to:CG-0MLSUJIE30K54IUO (Browser Testing)","effort":"","id":"CG-0MLSW8TKZ0YHXJR2","issueType":"bug","needsProducerReview":false,"parentId":"CG-0MLSDW7YM1IWH2SB","priority":"high","risk":"","sortIndex":1000,"stage":"in_progress","status":"completed","tags":[],"title":"Investigate and fix broken Golf UI interactions","updatedAt":"2026-02-19T04:07:13.430Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T05:25:53.184Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"# Intake Brief: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)\n\n**Priority: Medium** | **Type: Feature** | **Assignee: Map**\n\n> Add a reusable left-side help panel to the engine's UI module (`src/ui/`) that accepts an array of `{ heading, body }` content sections from each game, and integrate it into the 9-Card Golf example with rules overview, turn flow, scoring, and how-to-play instructions.\n\n## Problem Statement\n\nPlayers of Tableau Card Engine games currently have no way to learn the rules or how to play within the game itself. Rules exist only as code comments and developer documentation. A reusable, engine-level help panel is needed so that each game can surface its own rules and instructions to players without building custom UI from scratch.\n\n## Users\n\n- **Player (primary):** Wants to quickly reference the rules and how-to-play instructions without leaving the game.\n  - *\"As a player, I want to press a help button or keyboard shortcut to see the game's rules and instructions in a side panel so I can learn how to play or refresh my memory mid-game.\"*\n\n- **Game developer (secondary):** Wants a ready-made, configurable help panel component they can populate with game-specific content.\n  - *\"As a game developer, I want to pass an array of content sections (heading + body) to a reusable help panel component so that I don't have to build help screen UI from scratch for each new game.\"*\n\n## Success Criteria\n\n1. **Reusable engine component:** A `HelpPanel` (or equivalent) class exists in `src/ui/` that accepts an array of `{ heading: string, body: string }` sections and renders them in a left-side slide-in panel.\n2. **Trigger mechanisms:** The help panel can be opened via an on-screen help button (e.g. \"?\" icon) and a keyboard shortcut (e.g. H or ?), and dismissed via a close button, the same keyboard shortcut, or clicking outside the panel.\n3. **Scrollable content:** If the rules content exceeds the panel height, the panel supports vertical scrolling with a visible scroll indicator.\n4. **Percentage-based width:** The panel width is responsive, taking a percentage of the game canvas (e.g. 30-40%) rather than a fixed pixel width.\n5. **Golf integration:** The 9-Card Golf example game integrates the help panel with sections covering rules overview, turn flow, scoring, and basic how-to-play instructions. The help panel is accessible during gameplay without pausing the game.\n\n## Constraints\n\n- **No game pausing:** The game continues running while the help panel is open. Game input behind the panel may be blocked (to prevent accidental clicks) but AI turns and animations are not frozen.\n- **Engine-level component:** The `HelpPanel` must live in `src/ui/` and be importable via the `@ui/*` path alias. Game-specific content must not be hard-coded in the engine component.\n- **Golf only (initial scope):** Only the 9-Card Golf game needs to integrate the help panel in this work item. Other games will adopt it later.\n- **Content is not interactive:** The help panel displays static text sections. Interactive tutorials, animated demos, or step-by-step walkthroughs are out of scope.\n- **Phaser 3.90.0 compatibility:** The component must work with the current Phaser version and use Phaser's built-in text rendering and input systems (no DOM overlays or external UI libraries).\n- **Quality gates:** `npm test` and `npm run build` must pass after implementation.\n\n## Existing State\n\n- **`src/ui/` module:** Empty stub exporting only `UI_VERSION = '0.1.0'`. No reusable UI components exist.\n- **End-screen overlay in GolfScene (lines 618-674):** The only overlay-like pattern in the codebase -- a semi-transparent rectangle with text and an interactive button. Hard-coded in the scene, not extracted. This serves as a reference for how overlays can be built in Phaser.\n- **Instruction text in GolfScene:** A single-line contextual instruction text at the bottom of the screen that changes per turn phase. Not a help screen.\n- **Rules in code only:** `GolfRules.ts` and `GolfScoring.ts` contain complete rules as JSDoc comments and imperative code, but no player-facing text or data structure exists for rules content.\n- **No keyboard shortcut handling:** The Golf game uses only mouse/pointer input. No keyboard shortcuts are implemented.\n\n## Desired Change\n\n- **New engine component (`src/ui/HelpPanel.ts` or similar):**\n  - Accepts a configuration object with an array of `{ heading: string, body: string }` content sections.\n  - Renders a left-side panel that slides in/out with an animation.\n  - Panel width is percentage-based (e.g. 30-40% of canvas width).\n  - Includes a close button (e.g. \"X\" in the top-right corner of the panel).\n  - Supports vertical scrolling with a scroll indicator when content overflows.\n  - Provides a semi-transparent backdrop behind the panel (optional, to dim the game).\n\n- **Help button (`src/ui/HelpButton.ts` or similar):**\n  - A small on-screen button (e.g. \"?\" icon) that can be placed in a game scene to toggle the help panel.\n  - Reusable across games.\n\n- **Keyboard shortcut support:**\n  - The help panel listens for a configurable keyboard shortcut (default: H or ?) to toggle open/close.\n  - Clicking outside the panel also dismisses it.\n\n- **Golf game integration (`example-games/golf/`):**\n  - Define rules content as an array of sections (e.g. Overview, Turn Flow, Scoring, Tips).\n  - Add the help button to the GolfScene.\n  - Wire up the keyboard shortcut.\n\n- **Tests:**\n  - Unit tests for the HelpPanel component (content rendering, open/close state).\n  - Integration verification that the Golf game's help content loads correctly.\n\n- **Barrel exports:** Update `src/ui/index.ts` to export `HelpPanel`, `HelpButton`, and related types.\n\n## Risks & Assumptions\n\n### Risks\n- **Phaser text scrolling limitations:** Phaser 3 does not have a native scrollable text container. Implementing smooth scrolling with a scroll indicator may require a masked container with drag/wheel input, adding complexity. Mitigation: research Phaser community patterns for scrollable panels before implementation; consider a crop-mask approach with pointer-drag and mouse-wheel listeners.\n- **Input blocking complexity:** Blocking game input behind the panel while keeping the game running (AI turns, animations) may require careful Phaser input priority management. Mitigation: use Phaser's input hit area and depth sorting; test with active AI turns.\n- **First `src/ui/` component sets precedent:** This is the first real component in the engine's UI module. Design decisions (API patterns, naming conventions, configuration approach) will influence all future UI components. Mitigation: keep the API surface minimal and well-documented; review before merging.\n- **Content authoring effort underestimated:** Writing clear, concise player-facing rules text for Golf is a distinct task from building the UI component. Poor rules text undermines the feature even if the component works perfectly. Mitigation: draft rules content early and review for clarity before final integration.\n\n### Assumptions\n- Phaser 3.90.0's mask and input systems are sufficient for implementing a scrollable side panel without external libraries.\n- A single keyboard shortcut (H key) is sufficient; no conflict with existing game input is expected since Golf currently uses only pointer input.\n- Game-specific content will be plain text only (no rich formatting, images, or HTML). Markdown or styled text can be considered in future iterations.\n- The panel does not need to persist state (e.g. scroll position) across open/close cycles.\n\n## Related Work\n\n- **9-Card Golf (CG-0MLSDW7YM1IWH2SB)** [completed]: The parent spike. The Golf game is the first integration target for this help screen feature.\n- **Golf Phaser UI (CG-0MLSPJ9EW1WGHKLX)** [completed]: Established the Phaser scene patterns (overlays, text rendering, input handling) used in GolfScene. The help panel should follow similar patterns.\n- **Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)** [open]: Future game spike that will benefit from the reusable help panel.\n- **Future game spikes** (Sushi Go!, Splendor, Lost Cities, The Mind, Coloretto): All will consume the help panel component once built.\n- **`src/ui/index.ts`**: Stub module that will be populated by this work item.\n- **`example-games/golf/scenes/GolfScene.ts`**: Scene that will integrate the help panel.\n- **`example-games/golf/GolfRules.ts`**, **`GolfScoring.ts`**: Source material for the Golf game's help content sections.\n\n## Related work (automated report)\n\nSearched Worklog (keywords: help, panel, UI, overlay, scroll, button, keyboard, rules, instructions, Golf) and repository files. Conservative filtering applied -- only items with clear relevance to the help panel feature are included.\n\n### Worklog items\n\n- **Golf Phaser UI (CG-0MLSPJ9EW1WGHKLX)** [completed]: The most directly relevant prior work. GolfScene.ts (lines 618-674) contains the only overlay pattern in the codebase -- a semi-transparent rectangle with text and an interactive button for the end-of-round screen. This serves as the primary reference implementation for how to build overlay/panel UI in Phaser within this project, including depth management, text rendering, and interactive button patterns.\n\n- **Golf Game Rules and Scoring (CG-0MLSPI9YQ083H8LO)** [completed]: Implemented the game rules (GolfRules.ts) and scoring logic (GolfScoring.ts) that contain the authoritative rule definitions as JSDoc comments and code. These files are the source material from which player-facing help content sections (rules overview, turn flow, scoring) must be derived. No player-facing text data structure exists yet -- this work item must create one.\n\n- **Investigate and fix broken Golf UI interactions (CG-0MLSW8TKZ0YHXJR2)** [completed]: Fixed interaction handling in GolfScene (click handling, turn flow, AI execution, state transitions). Understanding these fixes is relevant because the help panel must coexist with the game's input handling -- blocking game clicks behind the panel while keeping AI turns and animations running requires awareness of the current input architecture.\n\n- **Phaser UI Browser Testing with Vitest (CG-0MLSUJIE30K54IUO)** [completed]: Established browser-mode testing infrastructure using Vitest + Playwright. The help panel's unit and integration tests should follow the same patterns (*.browser.test.ts convention, window.__PHASER_GAME__ access for state assertions) to verify rendering and interaction in a real browser.\n\n- **Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)** [open, idea stage]: The next planned game spike. Will be the second consumer of the reusable HelpPanel component, validating that the API is truly game-agnostic. The help panel's content section interface ({ heading, body }) should be validated against this game's anticipated content needs.\n\n- **Scaffold Card Game Engine project (CG-0MLSFU7300TLFCBH)** [completed]: Established the src/ui/ module stub and the @ui/* path alias. The HelpPanel and HelpButton components must be exported from src/ui/index.ts and importable via @ui/* per the project conventions set by this work item.\n\n### Repository files\n\n- **`src/ui/index.ts`**: Currently an empty stub exporting only `UI_VERSION = '0.1.0'`. This is where HelpPanel, HelpButton, and related types must be exported. As the first real component added to this module, the API design here sets a precedent for all future UI components.\n\n- **`example-games/golf/scenes/GolfScene.ts`** (676 lines): The integration target scene. The end-screen overlay (lines 618-674) demonstrates the overlay pattern (semi-transparent background rectangle, centered text, interactive button with hover states, depth management). The help panel implementation should follow this pattern but extract it into a reusable, configurable component rather than hard-coding it in the scene.\n\n- **`example-games/golf/GolfRules.ts`**: Contains complete turn flow rules as JSDoc (draw from stock/discard, swap or discard+flip, round ending detection, initial reveal). The help content's \"Turn Flow\" and \"How to Play\" sections should be derived from these documented rules.\n\n- **`example-games/golf/GolfScoring.ts`**: Contains scoring rules as JSDoc (A=1, 2=-2, 3-10=face, J/Q=10, K=0, column-of-three=0). The help content's \"Scoring\" section should be derived from this documented logic.\n\n- **`example-games/golf/GolfGrid.ts`**: Defines the 3x3 grid model (GRID_ROWS=3, GRID_COLS=3) used by the game. Relevant context for writing the help content's rules overview section explaining the grid layout.","effort":"","id":"CG-0MLT0PM000TQRIXT","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":1400,"stage":"done","status":"completed","tags":[],"title":"Help Screen with Game Rules and Instructions","updatedAt":"2026-02-19T11:20:09.114Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T10:04:17.301Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nBuild the `HelpPanel` class in `src/ui/` that renders a left-side panel with heading/body content sections, open/close state, and percentage-based width. This is the first real component in the engine's UI module and sets the API precedent for all future UI components.\n\n## User Story\n\nAs a game developer, I want a reusable `HelpPanel` component that accepts an array of content sections and renders them in a configurable side panel, so I don't have to build help screen UI from scratch for each new game.\n\n## Acceptance Criteria\n\n- `HelpPanel` class exists in `src/ui/HelpPanel.ts` and is exported from `src/ui/index.ts`\n- Constructing a HelpPanel with a sections array renders one heading and one body text block per section\n- Constructor accepts a Phaser Scene and a config object: `{ sections: Array<{ heading: string, body: string }>, widthPercent?: number }`\n- Panel renders as a solid background rectangle at 35% of canvas width (configurable via `widthPercent`), full height, anchored to the left edge\n- Each section renders a heading (larger font) followed by body text, stacked vertically with spacing\n- Panel has `open()` and `close()` methods, and an `isOpen` readonly property\n- Panel starts hidden (closed state)\n- Constructing a HelpPanel with an empty sections array renders the panel background with no text content (no error thrown)\n- Calling `destroy()` on the HelpPanel removes all game objects from the scene (no orphaned objects)\n- Unit tests verify content rendering, open/close state transitions, empty sections, and destroy cleanup\n- `npm test` passes; `npm run build` succeeds\n\n## Minimal Implementation\n\n- Create `src/ui/HelpPanel.ts` with a Phaser Container holding a background rectangle and text objects\n- Use Phaser `Text` game objects for headings (larger fontSize) and body (smaller fontSize)\n- Calculate panel width as percentage of `scene.scale.width`\n- Implement `open()`, `close()`, `isOpen`, and `destroy()` methods\n- Export `HelpPanel` class and `HelpPanelConfig` type from `src/ui/index.ts`\n- Write unit tests in `tests/ui/`\n\n## Dependencies\n\nNone (root feature -- no prerequisites)\n\n## Deliverables\n\n- `src/ui/HelpPanel.ts`\n- Updated `src/ui/index.ts` with exports\n- Unit tests in `tests/ui/`\n\n## Reference\n\n- Parent: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)\n- GolfScene.ts end-screen overlay (lines 618-674) for Phaser overlay patterns\n- `src/ui/index.ts` current stub","effort":"","id":"CG-0MLTANMZ80E1GY0X","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLT0PM000TQRIXT","priority":"medium","risk":"","sortIndex":100,"stage":"in_review","status":"completed","tags":[],"title":"HelpPanel Core Component","updatedAt":"2026-02-19T10:32:49.295Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T10:04:35.381Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTAO0XG0RGDGGN","to":"CG-0MLTANMZ80E1GY0X"}],"description":"## Summary\n\nAdd polished slide-in/slide-out animation with easing to the HelpPanel open/close transitions. The panel slides from off-screen left to its final position on open, and back off-screen on close, using Phaser tweens with cubic easing curves.\n\n## User Story\n\nAs a player, I want the help panel to slide in and out smoothly so the UI feels polished and responsive rather than jarring.\n\n## Acceptance Criteria\n\n- Calling `open()` slides the panel from off-screen left to its final position using a Phaser tween with ease-out curve\n- Calling `close()` slides the panel back off-screen left with ease-in curve\n- Animation duration is configurable (default ~300ms)\n- Calling `open()` while already open or `close()` while already closed is a no-op\n- Calling `open()` while a close animation is in progress interrupts the close and animates to the open position without a visible position jump\n- Pointer events on panel content (close button, scroll) do not fire during animation transitions\n- Unit/browser test verifies animation completes and panel reaches final position\n\n## Minimal Implementation\n\n- Use `scene.tweens.add()` with `Phaser.Math.Easing.Cubic.Out` for open, `Cubic.In` for close\n- Start panel at `x = -panelWidth`, animate to `x = 0` on open\n- Track animation state to handle interruption (stop existing tween, start new one from current position)\n- Disable panel interactivity during animation via a state flag\n\n## Prototype / Experiment\n\nVerify tween interruption (calling open during close) produces smooth reversal without visual glitches. Success = no position jump or orphaned tweens.\n\n## Dependencies\n\n- HelpPanel Core Component (CG-0MLTANMZ80E1GY0X)\n\n## Deliverables\n\n- Updated `src/ui/HelpPanel.ts` with animation logic\n- Animation unit/browser tests\n\n## Reference\n\n- Parent: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)\n- Phaser tween API: scene.tweens.add() with easing functions","effort":"","id":"CG-0MLTAO0XG0RGDGGN","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLT0PM000TQRIXT","priority":"medium","risk":"","sortIndex":200,"stage":"in_review","status":"completed","tags":[],"title":"Panel Slide Animation","updatedAt":"2026-02-19T10:32:58.300Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T10:04:55.158Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTAOG6U1SDSFHI","to":"CG-0MLTANMZ80E1GY0X"}],"description":"## Summary\n\nWhen content sections exceed the panel's visible height, enable vertical scrolling via mouse wheel and pointer drag, with a minimal scroll track bar indicator. Content is clipped to panel boundaries using a Phaser mask.\n\n## User Story\n\nAs a player, I want to scroll through long help content within the panel using my mouse wheel or by dragging, so I can read all the rules even if they don't fit on one screen.\n\n## Acceptance Criteria\n\n- If total content height exceeds panel height, scrolling is enabled automatically\n- Mouse wheel scrolls content up/down within the panel bounds\n- Pointer drag (click-and-drag) on the panel area scrolls content up/down\n- Content is clipped to the panel boundaries using a Phaser mask (no text visible outside the panel)\n- A thin vertical track bar on the right side of the panel shows relative scroll position\n- Track bar updates position as the user scrolls\n- If content fits within the panel, no track bar is shown and scrolling is disabled\n- Scroll position resets to top each time the panel is opened\n- Scrolling beyond the top boundary does not move content past the initial position (no over-scroll at top)\n- Scrolling beyond the bottom boundary does not move content past the last section (no over-scroll at bottom)\n- Unit/browser tests verify scroll behavior, clamping, and track bar visibility\n\n## Minimal Implementation\n\n- Wrap content text objects in a Phaser Container, apply a `GeometryMask` clipped to panel bounds\n- Listen for `wheel` events on the scene/panel and adjust container Y offset within bounds\n- Add pointer-drag input on the panel for touch/mouse drag scrolling\n- Draw track bar as a thin Phaser Graphics rectangle; update its Y position proportional to scroll offset\n- Calculate max scroll range from `totalContentHeight - visibleHeight`\n- On `open()`, reset content container Y to 0 (top)\n\n## Prototype / Experiment\n\nVerify Phaser 3.90.0 `GeometryMask` works correctly for clipping a scrollable container. Success = content clips cleanly at panel top/bottom boundaries with no visual artifacts.\n\n## Dependencies\n\n- HelpPanel Core Component (CG-0MLTANMZ80E1GY0X)\n\n## Deliverables\n\n- Updated `src/ui/HelpPanel.ts` with scroll and mask logic\n- Scroll behavior unit/browser tests\n\n## Reference\n\n- Parent: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)\n- Phaser GeometryMask and Container APIs","effort":"","id":"CG-0MLTAOG6U1SDSFHI","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLT0PM000TQRIXT","priority":"medium","risk":"","sortIndex":300,"stage":"in_review","status":"completed","tags":[],"title":"Scrollable Content with Track Bar","updatedAt":"2026-02-19T10:33:00.634Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T10:05:15.864Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTAOW5Z0ZK2GI0","to":"CG-0MLTANMZ80E1GY0X"},{"from":"CG-0MLTAOW5Z0ZK2GI0","to":"CG-0MLTAO0XG0RGDGGN"}],"description":"## Summary\n\nAdd a close button (\"X\") to the top-right corner of the HelpPanel and block all game pointer input when the panel is open. The game continues running (AI turns, animations) but no game objects respond to clicks while the panel is visible.\n\n## User Story\n\nAs a player, I want to dismiss the help panel by clicking an \"X\" button, and I don't want accidental clicks on game cards while reading the help content.\n\n## Acceptance Criteria\n\n- A close button (\"X\") is rendered in the top-right corner of the panel\n- Clicking the close button closes the panel (triggers close animation)\n- Close button has hover state (color change on pointer over)\n- When the panel is open, all game pointer input outside the panel is blocked (no clicks register on cards, piles, or other game objects)\n- When the panel is closed, all game input is restored to normal\n- After the panel is closed, clicking game objects (cards, piles) registers input normally (no residual blocking)\n- AI turns and animations continue running while the panel is open (game is not paused)\n- Tests verify input blocking activates on open and deactivates on close\n\n## Minimal Implementation\n\n- Add an interactive Phaser Text for the \"X\" button, positioned at top-right of panel\n- Use a full-screen transparent hit area (Phaser Rectangle) at high depth to intercept all pointer input when panel is open; destroy/disable it when panel closes\n- Ensure the panel, close button, and help button have higher depth than the input blocker\n- Set close button interactive with `useHandCursor: true`\n- Wire close button `pointerdown` to `this.close()`\n- Add `pointerover`/`pointerout` handlers for hover color change\n\n## Prototype / Experiment\n\nVerify full-screen transparent hit area blocks pointer events on game objects while allowing panel/button interaction. Success = no card clicks register behind the panel during active AI turns.\n\n## Dependencies\n\n- HelpPanel Core Component (CG-0MLTANMZ80E1GY0X)\n- Panel Slide Animation (CG-0MLTAO0XG0RGDGGN)\n\n## Deliverables\n\n- Updated `src/ui/HelpPanel.ts` with close button and input blocking\n- Input blocking tests\n\n## Reference\n\n- Parent: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)\n- GolfScene.ts end-screen overlay button pattern (lines 657-673)","effort":"","id":"CG-0MLTAOW5Z0ZK2GI0","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLT0PM000TQRIXT","priority":"medium","risk":"","sortIndex":400,"stage":"in_review","status":"completed","tags":[],"title":"Input Blocking and Close Button","updatedAt":"2026-02-19T10:33:03.231Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T10:05:33.015Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTAP9EE12DW186","to":"CG-0MLTANMZ80E1GY0X"}],"description":"## Summary\n\nCreate a reusable `HelpButton` class in `src/ui/` that renders a \"?\" button to toggle the help panel open and closed. The button is positioned in the top-right corner of the canvas by default and remains visible and clickable even when the panel is open.\n\n## User Story\n\nAs a player, I want a visible \"?\" button on screen that I can click to open and close the help panel, so I can easily access game rules whenever I need them.\n\n## Acceptance Criteria\n\n- `HelpButton` class exists in `src/ui/HelpButton.ts` and is exported from `src/ui/index.ts`\n- Constructor accepts a Phaser Scene and a reference to the HelpPanel to toggle\n- Button renders as a circular or rounded \"?\" icon in a fixed position (default: top-right corner of canvas)\n- Clicking the button toggles the help panel open/close\n- Button has hover state (visual feedback on pointer over)\n- Button position is configurable (x/y override in constructor config)\n- The HelpButton is not obscured or hidden when the help panel is open (remains clickable to close the panel)\n- Button depth is set higher than the input blocker so it remains interactive when the panel is open\n- Unit test verifies button renders and triggers panel toggle\n\n## Minimal Implementation\n\n- Create `src/ui/HelpButton.ts` with a Phaser Text or Graphics-based \"?\" button\n- Wire `pointerdown` to call `helpPanel.isOpen ? helpPanel.close() : helpPanel.open()`\n- Set depth higher than input blocker so it remains clickable when panel is open\n- Add hover state via `pointerover`/`pointerout` handlers\n- Default position: top-right corner with configurable x/y offset\n- Set interactive with `useHandCursor: true`\n- Export from `src/ui/index.ts`\n\n## Dependencies\n\n- HelpPanel Core Component (CG-0MLTANMZ80E1GY0X)\n\n## Deliverables\n\n- `src/ui/HelpButton.ts`\n- Updated `src/ui/index.ts` with `HelpButton` export\n- Unit tests in `tests/ui/`\n\n## Reference\n\n- Parent: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)","effort":"","id":"CG-0MLTAP9EE12DW186","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLT0PM000TQRIXT","priority":"medium","risk":"","sortIndex":500,"stage":"in_review","status":"completed","tags":[],"title":"HelpButton Component","updatedAt":"2026-02-19T10:33:05.669Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T10:05:51.625Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTAPNRB09U9C9F","to":"CG-0MLTANMZ80E1GY0X"},{"from":"CG-0MLTAPNRB09U9C9F","to":"CG-0MLTAO0XG0RGDGGN"}],"description":"## Summary\n\nAdd configurable keyboard shortcut support to the HelpPanel. The default shortcut is `?` (Shift+/) which toggles the panel open and closed. The shortcut key is configurable in the HelpPanel constructor config.\n\n## User Story\n\nAs a player, I want to press `?` on my keyboard to quickly toggle the help panel without reaching for my mouse, so I can check rules and get back to the game efficiently.\n\n## Acceptance Criteria\n\n- Pressing `?` (Shift+/) toggles the help panel open/close\n- The keyboard shortcut key is configurable in the HelpPanel constructor config (default: `?`)\n- The shortcut works regardless of whether the panel is currently open or closed\n- Pressing `?` when the panel is open closes it; pressing it when the panel is closed opens it\n- The shortcut is disabled during panel animation transitions (no rapid toggling during animation)\n- Pressing a non-configured key (e.g., `G`) does not toggle the panel\n- Keyboard listener is cleaned up when `destroy()` is called on the HelpPanel\n- Tests verify keyboard shortcut toggles the panel and non-configured keys are ignored\n\n## Minimal Implementation\n\n- Add a Phaser keyboard listener in HelpPanel for the configured key\n- Use `scene.input.keyboard!.on('keydown-FORWARD_SLASH', ...)` and check for shift modifier for the `?` default\n- Toggle open/close state on key press, respecting animation state\n- Clean up listener on panel destroy\n- Make shortcut key configurable via `HelpPanelConfig`\n\n## Prototype / Experiment\n\nVerify `Shift+/` detection works cross-platform in Phaser's keyboard system. Success = keydown fires reliably in Chrome, Firefox.\n\n## Dependencies\n\n- HelpPanel Core Component (CG-0MLTANMZ80E1GY0X)\n- Panel Slide Animation (CG-0MLTAO0XG0RGDGGN)\n\n## Deliverables\n\n- Updated `src/ui/HelpPanel.ts` with keyboard shortcut logic\n- Keyboard shortcut tests\n\n## Reference\n\n- Parent: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)\n- Golf game currently uses only pointer input, so no keyboard conflicts expected","effort":"","id":"CG-0MLTAPNRB09U9C9F","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLT0PM000TQRIXT","priority":"medium","risk":"","sortIndex":600,"stage":"in_review","status":"completed","tags":[],"title":"Keyboard Shortcut Toggle","updatedAt":"2026-02-19T10:33:07.937Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T10:06:16.749Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTAQ7581C3NQOZ","to":"CG-0MLTANMZ80E1GY0X"},{"from":"CG-0MLTAQ7581C3NQOZ","to":"CG-0MLTAO0XG0RGDGGN"},{"from":"CG-0MLTAQ7581C3NQOZ","to":"CG-0MLTAOG6U1SDSFHI"},{"from":"CG-0MLTAQ7581C3NQOZ","to":"CG-0MLTAOW5Z0ZK2GI0"},{"from":"CG-0MLTAQ7581C3NQOZ","to":"CG-0MLTAP9EE12DW186"},{"from":"CG-0MLTAQ7581C3NQOZ","to":"CG-0MLTAPNRB09U9C9F"}],"description":"## Summary\n\nCreate the Golf game's help content as a JSON data file and integrate the HelpPanel and HelpButton into GolfScene. This is the end-to-end integration feature that wires all engine UI components into the first consuming game.\n\n## User Story\n\nAs a player of 9-Card Golf, I want to press the \"?\" button or hit the `?` key during gameplay to see a help panel with the game's rules, turn flow, scoring, and how-to-play instructions, so I can learn or refresh the rules mid-game.\n\n## Acceptance Criteria\n\n- A `help-content.json` file exists in `example-games/golf/` with an array of `{ heading, body }` sections covering rules and how-to-play content\n- Content is accurate per `GolfRules.ts` and `GolfScoring.ts` (A=1, 2=-2, 3-10=face, J/Q=10, K=0, column-of-three=0)\n- The `help-content.json` file is valid JSON and parseable without errors\n- GolfScene creates a HelpPanel with the JSON content and a HelpButton in the top-right corner\n- The `?` keyboard shortcut toggles the help panel in the Golf game\n- The help panel is accessible during gameplay without pausing or disrupting the game\n- Opening the help panel during an AI turn does not interrupt the AI's move execution\n- A browser test verifies the help panel opens, displays content, and closes in the Golf game\n- `npm test` passes; `npm run build` succeeds\n\n## Minimal Implementation\n\n- Create `example-games/golf/help-content.json` with an arbitrary number of `{ heading, body }` sections derived from GolfRules.ts and GolfScoring.ts\n- Import the JSON in GolfScene via `import helpContent from './help-content.json'`\n- Instantiate HelpPanel with the imported content in GolfScene's `create()` method\n- Instantiate HelpButton in GolfScene's `create()` method, positioned top-right\n- Add a browser test (`*.browser.test.ts`) that opens the Golf game, clicks the help button, verifies content renders, and closes the panel\n\n## Dependencies\n\n- HelpPanel Core Component (CG-0MLTANMZ80E1GY0X)\n- Panel Slide Animation (CG-0MLTAO0XG0RGDGGN)\n- Scrollable Content with Track Bar (CG-0MLTAOG6U1SDSFHI)\n- Input Blocking and Close Button (CG-0MLTAOW5Z0ZK2GI0)\n- HelpButton Component (CG-0MLTAP9EE12DW186)\n- Keyboard Shortcut Toggle (CG-0MLTAPNRB09U9C9F)\n\n## Deliverables\n\n- `example-games/golf/help-content.json`\n- Updated `example-games/golf/scenes/GolfScene.ts` with HelpPanel and HelpButton integration\n- Browser integration test\n\n## Reference\n\n- Parent: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)\n- `example-games/golf/GolfRules.ts`: source material for turn flow and rules content\n- `example-games/golf/GolfScoring.ts`: source material for scoring content\n- `example-games/golf/GolfGrid.ts`: grid layout context (3x3)\n- Browser test patterns: `*.browser.test.ts` convention per CG-0MLSUJIE30K54IUO","effort":"","id":"CG-0MLTAQ7581C3NQOZ","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLT0PM000TQRIXT","priority":"medium","risk":"","sortIndex":700,"stage":"in_review","status":"completed","tags":[],"title":"Golf Help Content and Integration","updatedAt":"2026-02-19T10:33:10.010Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T10:55:45.372Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nWhen the help panel slides open, the content area is blank. Text only appears after the user scrolls. This is because the GeometryMask is drawn at the container's x position at the time of opening (which is off-screen at -panelWidth), and is never updated during the slide-in animation.\n\n## Root Cause\n\nIn resetScroll() (called by open()), the mask is drawn at maskX = this.container.x, which is -panelWidth (off-screen). The slide-in tween animates container.x from -panelWidth to 0, but the mask rectangle is not redrawn during the animation. The mask only gets redrawn when the user scrolls (applyScroll()), which is why content appears after scrolling.\n\n## Fix\n\nAdd an onUpdate callback to both the open and close tweens that redraws the mask at the container's current x position during each animation frame.\n\n## Acceptance Criteria\n\n1. When the help panel opens, text content is visible immediately (as the panel slides in)\n2. Content remains visible throughout the entire slide-in animation\n3. Content remains visible during slide-out animation\n4. Scrolling still works correctly after the fix\n5. npm test passes; npm run build succeeds\n\n## Related\n\n- Parent: Help Screen with Game Rules and Instructions (CG-0MLT0PM000TQRIXT)\n- File: src/ui/HelpPanel.ts","effort":"","id":"CG-0MLTCHTQV00N4L9R","issueType":"bug","needsProducerReview":false,"parentId":"CG-0MLT0PM000TQRIXT","priority":"high","risk":"","sortIndex":800,"stage":"in_review","status":"completed","tags":[],"title":"Fix blank help panel on initial open","updatedAt":"2026-02-19T11:00:03.390Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T11:05:39.445Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nWhen the AI takes its turn, the player cannot tell what move was made. The AI should visually show which pile it draws from (stock or discard), pause to let the player see the drawn card, and then execute the swap/discard move.\n\n## User Story\n\nAs a player, I want to see which pile the AI draws from and what card it drew before the AI makes its move, so I can follow the AI's strategy and understand what happened.\n\n## Current Behavior\n\n1. 'AI is thinking...' text shown for 600ms\n2. AI turn executes instantly (draw + move in one call)\n3. Only the card flip at the grid position is animated\n4. No indication of draw source or drawn card\n\n## Desired Behavior\n\n1. 'AI is thinking...' text shown briefly\n2. AI draws from stock or discard -- the drawn card is shown visually (like the human's showDrawnCard()) with instruction text indicating which pile was chosen\n3. ~1 second pause so the player can see the drawn card\n4. AI executes the swap or discard-and-flip move with the existing flip animation\n5. Piles and scores refresh after the move completes\n\n## Acceptance Criteria\n\n1. When the AI draws from stock, the instruction text says something like 'AI drew from stock'\n2. When the AI draws from discard, the instruction text says 'AI drew from discard'\n3. The drawn card is shown visually next to the piles (using the existing showDrawnCard pattern)\n4. There is a visible pause (~1 second) between showing the drawn card and executing the move\n5. After the move, the drawn card display is hidden and piles refresh normally\n6. npm test passes; npm run build succeeds\n\n## Files to Change\n\n- example-games/golf/scenes/GolfScene.ts -- runAiTurn() method and potentially setPhase()\n\n## Related\n\n- discovered-from:CG-0MLT0PM000TQRIXT","effort":"","id":"CG-0MLTCUK500GZUJ6N","issueType":"bug","needsProducerReview":false,"parentId":null,"priority":"high","risk":"","sortIndex":1500,"stage":"in_review","status":"completed","tags":[],"title":"Show AI draw source with pause before move","updatedAt":"2026-02-19T11:11:52.222Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T11:35:53.790Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Add a Citadel variant option to the Beleaguered Castle game where all 52 cards are dealt to the 8 tableau piles (aces are not pre-placed on foundations). The player must uncover and move aces manually. This should be selectable as an option within the game UI.\n\ndiscovered-from:CG-0MLSDWFLT1WB6IEB\nrelated-to:CG-0MLSDWFLT1WB6IEB\n\nAcceptance criteria:\n- Citadel variant can be selected from the game UI\n- All 52 cards are dealt to the 8 tableau piles (no aces pre-placed)\n- Game rules remain the same as classic Beleaguered Castle otherwise\n- Unit tests cover Citadel deal and verify all 52 cards are in tableau","effort":"","id":"CG-0MLTDXG3H0WCXMUV","issueType":"feature","needsProducerReview":false,"parentId":null,"priority":"medium","risk":"","sortIndex":1600,"stage":"idea","status":"open","tags":[],"title":"Citadel variant option for Beleaguered Castle","updatedAt":"2026-02-19T11:35:53.790Z"},"type":"workitem"}
{"data":{"assignee":"opencode","createdAt":"2026-02-19T12:15:03.820Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nModify `createGameState()` in `src/core-engine/GameState.ts` to accept 1 player (currently enforces >= 2), enabling all solitaire games to use the shared engine.\n\n## User Story\n\nAs an engine developer, I want the core engine to support single-player games so that solitaire games like Beleaguered Castle can use the shared GameState and TurnSequencer modules.\n\n## Acceptance Criteria\n\n- `createGameState()` accepts `players.length >= 1` (changed from `>= 2`)\n- Creating a GameState with 0 players still throws an error\n- All existing Golf tests (unit, integration, browser) continue to pass unchanged\n- New unit test validates single-player GameState creation\n- `advanceTurn()` works correctly for single-player: increments turn counter, keeps `currentPlayerIndex` at 0\n- `npm test` passes; `npm run build` succeeds\n\n## Minimal Implementation\n\n- Change validation in `src/core-engine/GameState.ts:75` from `< 2` to `< 1`\n- Add unit test for 1-player GameState creation and turn advancement\n- Verify no ripple effects in TurnSequencer (modular arithmetic `% 1 = 0` is correct)\n\n## Dependencies\n\nNone (foundational change, can be worked in parallel with Undo/Redo Module)\n\n## Deliverables\n\n- Updated `src/core-engine/GameState.ts`\n- New unit tests in `tests/core-engine/`\n\n## Related Files\n\n- `src/core-engine/GameState.ts:75` (validation to change)\n- `src/core-engine/TurnSequencer.ts:64-65` (advanceTurn modular arithmetic)","effort":"","id":"CG-0MLTFBTE41EVGNKA","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"high","risk":"","sortIndex":100,"stage":"in_progress","status":"completed","tags":[],"title":"Single-Player Core Engine Support","updatedAt":"2026-02-19T12:30:32.970Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:15:24.229Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nBuild a reusable `UndoRedoManager` in `src/core-engine/` using the command pattern, aligned with the transcript/event system planned in CG-0MLSN2YWY1EL17FN (Game Log Visual Replay Dev Tool).\n\n## User Story\n\nAs an engine developer, I want a reusable undo/redo module that uses the command pattern so that any game can provide undo/redo functionality and the commands naturally integrate with game transcript recording.\n\n## Acceptance Criteria\n\n- `UndoRedoManager` is exported from `src/core-engine/index.ts`\n- Commands are defined as objects with `execute()` and `undo()` methods\n- Supports compound commands (group of commands undone/redone as one step)\n- Unlimited undo/redo history (linear stack, no branching)\n- Redo stack is cleared when a new command is executed after undo\n- Calling `undo()` on empty history is a no-op (does not throw)\n- Calling `redo()` on empty redo stack is a no-op (does not throw)\n- Unit tests cover: execute, undo, redo, compound undo, redo-after-undo clearing, empty-stack no-ops\n- `npm test` passes; `npm run build` succeeds\n\n## Prototype / Experiment\n\nVerify command pattern works with a simple 3-move sequence: execute, undo, redo. Success = state matches expected at each step.\n\n## Minimal Implementation\n\n- Define `Command` interface with `execute()` and `undo()` methods\n- Define `CompoundCommand` that groups multiple commands (undo reverses all in reverse order)\n- Implement `UndoRedoManager` class with `execute(cmd)`, `undo()`, `redo()`, `canUndo()`, `canRedo()`, `history` accessors\n- Write unit tests in `tests/core-engine/`\n\n## Dependencies\n\nNone (can be worked in parallel with Single-Player Core Engine Support)\n\n## Deliverables\n\n- `src/core-engine/UndoRedoManager.ts`\n- Updated `src/core-engine/index.ts` barrel file\n- Unit tests in `tests/core-engine/`\n\n## Related Work\n\n- related-to:CG-0MLSN2YWY1EL17FN (Game Log Visual Replay Dev Tool -- command pattern aligns with transcript recording and engine event system)","effort":"","id":"CG-0MLTFC94Z00K32ZI","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"high","risk":"","sortIndex":200,"stage":"idea","status":"open","tags":[],"title":"Undo/Redo Module (Command Pattern)","updatedAt":"2026-02-19T12:15:24.229Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:15:50.816Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFCTNK10RQ41T","to":"CG-0MLTFBTE41EVGNKA"}],"description":"## Summary\n\nImplement deal, move rules, win detection, no-moves detection, and seeded RNG as pure functions in `example-games/beleaguered-castle/`, following the Golf game's architecture of separating game logic from Phaser UI.\n\n## User Story\n\nAs a player, I want the game to correctly enforce Beleaguered Castle rules (build foundations up by suit, build tableau down regardless of suit, only top card movable, empty columns accept any card) so that every game is played correctly.\n\nAs an engine developer, I want game logic as pure testable functions so I can verify correctness without Phaser.\n\n## Acceptance Criteria\n\n- Deal: shuffle deck with seeded RNG, remove 4 aces to foundations, deal 48 cards into 8 columns of 6, all face-up\n- Deal with the same seed produces identical card positions\n- Seed is stored in game state and displayable to the player\n- Move rules: top card of tableau column can move to foundation (next in suit sequence A->K) or to another tableau column (one rank lower, any suit)\n- Empty columns accept any card\n- Moving a non-top card from a tableau column is rejected as illegal\n- Win detection: all 52 cards on 4 foundations (13 each)\n- No-moves detection: no legal moves exist across all tableau columns and foundations\n- Unit tests cover: deal correctness (ace placement, column sizes, seed reproducibility), valid moves, invalid moves (wrong rank, wrong suit for foundation, non-top card), empty column moves, win detection, no-moves detection\n- `npm test` passes; `npm run build` succeeds\n\n## Minimal Implementation\n\n- Define `BeleagueredCastleState` type: 4 foundation Piles (indexed by suit), 8 tableau column Piles, seed number, move counter, elapsed time tracker\n- Implement `deal(seed: number)` using existing `createStandardDeck()`, `shuffle()` from card-system with seeded RNG\n- Implement `isLegalTableauMove(state, fromCol, toCol)` and `isLegalFoundationMove(state, fromCol, suitIndex)`\n- Implement `getLegalMoves(state)` returning all valid moves\n- Implement `isWon(state)` and `hasNoMoves(state)`\n- Write unit tests in `tests/beleaguered-castle/`\n\n## Dependencies\n\n- Single-Player Core Engine Support (CG-0MLTFBTE41EVGNKA): needs single-player GameState\n- Card System (existing, completed): Card, Deck, Pile types\n\n## Deliverables\n\n- `example-games/beleaguered-castle/BeleagueredCastleRules.ts` (deal, move validation, win/loss detection)\n- `example-games/beleaguered-castle/BeleagueredCastleState.ts` (state types)\n- Unit tests in `tests/beleaguered-castle/`\n\n## Related Files\n\n- `example-games/golf/GolfRules.ts` (architectural reference)\n- `example-games/golf/GolfGame.ts` (game state pattern reference)\n- `src/card-system/Deck.ts` (shuffle with RNG)\n- `src/card-system/Pile.ts` (foundation and tableau columns)","effort":"","id":"CG-0MLTFCTNK10RQ41T","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"high","risk":"","sortIndex":300,"stage":"idea","status":"open","tags":[],"title":"Beleaguered Castle Game Logic","updatedAt":"2026-02-19T12:30:33.117Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:16:13.238Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFDAYD0J6KLY3","to":"CG-0MLTFCTNK10RQ41T"}],"description":"## Summary\n\nBuild the Beleaguered Castle Phaser scene with static card layout: 4 foundations across the top, 8 tableau columns below, rendering a dealt game with deal animation but no player interaction yet.\n\n## User Story\n\nAs a player, I want to see the Beleaguered Castle game board rendered with all 48 cards dealt face-up into 8 columns with 4 foundation piles showing aces, so I can understand the game layout before interacting with it.\n\n## Acceptance Criteria\n\n- Scene renders 4 foundation piles across the top with suit indicators and pre-placed aces\n- Scene renders 8 tableau columns below with overlapping cards (all face-up, cascade offset so ranks are visible)\n- Cards use existing 140x190px SVG assets from `public/assets/cards/`\n- Deal animation plays on scene start (cards dealt to columns with tween)\n- Scene displays move counter (0), timer (00:00), and seed number in HUD\n- Scene renders without JavaScript errors in browser console\n- `npm run build` succeeds\n\n## Prototype / Experiment\n\nVerify 8-column overlapping card layout renders correctly at the target viewport. Success = all 48 cards visible with enough offset to read rank/suit on each card.\n\n## Minimal Implementation\n\n- Create `example-games/beleaguered-castle/main.ts` entry point with Phaser game config\n- Create `example-games/beleaguered-castle/scenes/BeleagueredCastleScene.ts`\n- Implement card layout math: foundation x-positions (centered top), column x/y offsets with vertical cascade overlap\n- Load card sprites from `public/assets/cards/` using `this.load.svg()`\n- Render dealt cards using game logic `deal()` function\n- Add deal animation using Phaser tweens (cards fly from center to positions)\n- Display HUD text elements (move counter, timer, seed)\n\n## Dependencies\n\n- Beleaguered Castle Game Logic (CG-0MLTFCTNK10RQ41T): needs deal function to produce card positions\n\n## Deliverables\n\n- `example-games/beleaguered-castle/main.ts`\n- `example-games/beleaguered-castle/scenes/BeleagueredCastleScene.ts`\n- Visual card layout rendering\n\n## Related Files\n\n- `example-games/golf/scenes/GolfScene.ts` (Phaser scene pattern reference)\n- `example-games/golf/main.ts` (entry point pattern reference)\n- `example-games/golf/createGolfGame.ts` (factory function pattern)\n- `public/assets/cards/` (SVG card assets)","effort":"","id":"CG-0MLTFDAYD0J6KLY3","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"high","risk":"","sortIndex":400,"stage":"idea","status":"blocked","tags":[],"title":"Phaser Scene Static Card Layout","updatedAt":"2026-02-19T12:18:35.377Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:16:37.446Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFDTMT0G2I0ZT","to":"CG-0MLTFC94Z00K32ZI"},{"from":"CG-0MLTFDTMT0G2I0ZT","to":"CG-0MLTFCTNK10RQ41T"},{"from":"CG-0MLTFDTMT0G2I0ZT","to":"CG-0MLTFDAYD0J6KLY3"}],"description":"## Summary\n\nImplement drag-and-drop interaction for moving cards between tableau columns and to foundations, with visual feedback for valid/invalid drop targets and integration with the UndoRedoManager.\n\n## User Story\n\nAs a player, I want to drag cards from tableau columns to foundations or other tableau columns so that I can play Beleaguered Castle with intuitive, modern card game input.\n\n## Acceptance Criteria\n\n- Player can drag the top card of any tableau column\n- Valid drop targets (matching tableau columns and foundations) are highlighted during drag\n- Dropping on a valid target executes the move and updates the board\n- Dropping on an invalid target or empty space snaps the card back to its origin\n- Dragging a card to a foundation with wrong suit snaps back to origin\n- Card depth (z-order) increases during drag for visual clarity\n- Move counter increments on successful move\n- Timer starts on the first successful move\n- Each move is recorded as a Command in the UndoRedoManager\n- Browser test verifies basic drag interaction works\n- `npm test` passes; `npm run build` succeeds\n\n## Prototype / Experiment\n\nVerify Phaser's `setDraggable()` / drop zone API produces reliable drag interaction with SVG sprites. Success = card follows pointer during drag and snaps to drop zone on release at 60fps.\n\n## Minimal Implementation\n\n- Set top cards as draggable via Phaser's `setInteractive()` + `scene.input.setDraggable()`\n- Create drop zones on foundation piles and tableau column top positions\n- Implement `drag`, `dragstart`, `dragend`, `drop` event handlers\n- On dragstart: raise card z-order, highlight valid targets\n- On drop: validate move via game logic; if valid, execute move and create MoveCommand; if invalid, tween card back\n- On dragend (no drop): snap card back to origin\n- After each move, update card positions and refresh draggable state (new top cards become draggable)\n- Integrate with UndoRedoManager: each move creates a `MoveCommand` with `execute()` and `undo()`\n\n## Dependencies\n\n- Beleaguered Castle Game Logic (CG-0MLTFCTNK10RQ41T): move validation rules\n- Phaser Scene Static Card Layout (CG-0MLTFDAYD0J6KLY3): scene and card sprites\n- Undo/Redo Module (CG-0MLTFC94Z00K32ZI): Command interface and UndoRedoManager\n\n## Deliverables\n\n- Drag-and-drop input handling in BeleagueredCastleScene\n- MoveCommand implementation\n- Browser tests for drag interaction\n\n## Related Files\n\n- `example-games/golf/scenes/GolfScene.ts` (click input reference -- drag is new)\n- Phaser drag documentation: https://docs.phaser.io/phaser3/concepts/input/drag","effort":"","id":"CG-0MLTFDTMT0G2I0ZT","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"high","risk":"","sortIndex":500,"stage":"idea","status":"blocked","tags":[],"title":"Drag-and-Drop Card Input","updatedAt":"2026-02-19T12:18:38.864Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:16:53.784Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFE68N1TONFIE","to":"CG-0MLTFDTMT0G2I0ZT"}],"description":"## Summary\n\nAdd click-to-select then click-to-place as an alternative input method alongside drag-and-drop, giving players a second way to move cards.\n\n## User Story\n\nAs a player, I want to click a card to select it and then click a destination to move it, as an alternative to drag-and-drop, so I can choose whichever input method feels more comfortable.\n\n## Acceptance Criteria\n\n- Clicking a tableau column's top card selects it (visual highlight/glow effect)\n- Clicking a valid destination (another column or foundation) moves the selected card\n- Clicking an invalid destination while a card is selected deselects the card (no move executed)\n- Clicking the same card again deselects it\n- Both input methods (drag and click) work simultaneously without conflict\n- Selected card has a visible highlight/glow effect that is clearly distinguishable\n- Move uses the same Command integration as drag-and-drop (UndoRedoManager)\n- `npm test` passes; `npm run build` succeeds\n\n## Minimal Implementation\n\n- Add click handler on cards and destinations that toggles selection state\n- When a card is selected, clicking a destination triggers the same move logic as drag-and-drop\n- Reuse move validation and Command integration from Drag-and-Drop feature\n- Add visual selection indicator (tint, border, or glow shader)\n- Ensure drag events do not conflict with click selection (use Phaser's built-in event separation)\n\n## Dependencies\n\n- Drag-and-Drop Card Input (CG-0MLTFDTMT0G2I0ZT): establishes move execution pipeline and Command integration\n\n## Deliverables\n\n- Click-to-move input handler in BeleagueredCastleScene\n- Visual selection indicator\n- Tests for click-to-move flow","effort":"","id":"CG-0MLTFE68N1TONFIE","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"medium","risk":"","sortIndex":600,"stage":"idea","status":"blocked","tags":[],"title":"Click-to-Move Card Input","updatedAt":"2026-02-19T12:18:39.406Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:17:15.694Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFEN5A0DG3P0M","to":"CG-0MLTFC94Z00K32ZI"},{"from":"CG-0MLTFEN5A0DG3P0M","to":"CG-0MLTFDTMT0G2I0ZT"}],"description":"## Summary\n\nAutomatically move cards to foundations when safe to play after each player move, with compound undo support so undoing a player move also undoes all triggered auto-moves.\n\n## User Story\n\nAs a player, I want cards to automatically move to foundations when it is clearly safe to do so, reducing tedious manual moves and making the game feel polished.\n\n## Acceptance Criteria\n\n- After each player move, the engine checks all tableau columns for cards safe to auto-move to foundations\n- Auto-moves execute automatically with a brief animation delay between each\n- Undoing a player move also undoes all auto-moves triggered by that move (compound undo via CompoundCommand)\n- Auto-move chain is recorded as part of the triggering compound command in UndoRedoManager\n- Auto-moves do NOT increment the player's move counter (only player-initiated moves count)\n- Unit tests cover safe-move heuristic: cards that are safe and cards that are not safe to auto-move\n- `npm test` passes; `npm run build` succeeds\n\n## Open Question\n\nThe exact safe-to-auto-move heuristic needs to be defined during implementation. A conservative starting point: a card is safe to auto-move to its foundation if no tableau column contains a card of any suit that has a rank equal to the candidate card's rank minus one (i.e., no column needs this card as a potential build target). The implementer should document the chosen heuristic and test edge cases. Being too aggressive risks moving cards the player needs for tableau building; being too conservative leaves cards the player would prefer auto-moved.\n\n## Minimal Implementation\n\n- Implement `findSafeAutoMoves(state)` function that returns a list of cards safe to move to foundations\n- Implement auto-move loop: after each player move, repeatedly call `findSafeAutoMoves()` and execute until no more safe moves exist\n- Wrap player move + all triggered auto-moves in a `CompoundCommand` so undo reverses the entire chain\n- Add tween animation for each auto-move (brief card flight from column to foundation)\n- Ensure auto-moves do not trigger further compound nesting (flat compound)\n\n## Dependencies\n\n- Drag-and-Drop Card Input (CG-0MLTFDTMT0G2I0ZT): move execution pipeline\n- Undo/Redo Module (CG-0MLTFC94Z00K32ZI): CompoundCommand support\n\n## Deliverables\n\n- Auto-move logic in game rules module\n- CompoundCommand integration in scene\n- Unit tests for safe-move heuristic","effort":"","id":"CG-0MLTFEN5A0DG3P0M","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"high","risk":"","sortIndex":700,"stage":"idea","status":"blocked","tags":[],"title":"Auto-Move to Foundations","updatedAt":"2026-02-19T12:18:41.756Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:17:35.943Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFF2R70UXJD2T","to":"CG-0MLTFCTNK10RQ41T"},{"from":"CG-0MLTFF2R70UXJD2T","to":"CG-0MLTFDAYD0J6KLY3"}],"description":"## Summary\n\nImplement win/loss detection overlays, new game (fresh seed), restart (same seed), and time+moves scoring display.\n\n## User Story\n\nAs a player, I want to see when I have won or am stuck, view my move count and elapsed time, and quickly start a new game or restart the current deal.\n\n## Acceptance Criteria\n\n- Win overlay appears when all 52 cards are on foundations, showing total moves and elapsed time\n- \"No moves available\" overlay appears when no legal moves remain, with options to undo last move or start a new game\n- \"New Game\" button starts a new deal with a fresh random seed\n- \"Restart\" button restarts the current deal using the same seed\n- Move counter displays on screen and increments on each player-initiated move (not auto-moves)\n- Timer starts on first player move and displays elapsed time in MM:SS format\n- Timer does not advance while the game is paused (in win/loss overlay)\n- Seed number is displayed on screen and can be visually identified for sharing\n- `npm test` passes; `npm run build` succeeds\n\n## Minimal Implementation\n\n- Check win condition (`isWon()`) and no-moves condition (`hasNoMoves()`) after each move (including after auto-moves)\n- Create overlay UI components using Phaser text/graphics (semi-transparent background + centered text + buttons)\n- Implement new game flow: generate new random seed, call `deal(newSeed)`, reset scene\n- Implement restart flow: reuse current seed, call `deal(currentSeed)`, reset scene\n- Implement timer: start on first move, update display each frame, stop on win/loss\n- Display move count and timer in HUD area\n- Display seed number in HUD area\n\n## Dependencies\n\n- Beleaguered Castle Game Logic (CG-0MLTFCTNK10RQ41T): win and no-moves detection functions\n- Phaser Scene Static Card Layout (CG-0MLTFDAYD0J6KLY3): scene to add overlays and HUD to\n\n## Deliverables\n\n- Win/loss overlay UI\n- New game and restart game flows\n- Timer and move counter display\n- Tests for game flow transitions","effort":"","id":"CG-0MLTFF2R70UXJD2T","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"high","risk":"","sortIndex":800,"stage":"idea","status":"blocked","tags":[],"title":"Win/Loss, New Game, Restart, Scoring","updatedAt":"2026-02-19T12:18:43.625Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:17:53.501Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFFGBH1CEPC7J","to":"CG-0MLTFC94Z00K32ZI"},{"from":"CG-0MLTFFGBH1CEPC7J","to":"CG-0MLTFEN5A0DG3P0M"}],"description":"## Summary\n\nDetect when the remaining game is trivially winnable and automatically play all remaining moves to completion, with compound undo support.\n\n## User Story\n\nAs a player, I want the game to automatically complete when the remaining moves are obvious, so I do not have to tediously move cards one by one to the foundations when victory is assured.\n\n## Acceptance Criteria\n\n- Auto-complete triggers when all remaining tableau cards can be played to foundations in some order\n- Simple heuristic: all cards in each non-empty column are in descending rank order AND the bottom card of each column can eventually reach its foundation (considering current foundation tops)\n- Auto-complete plays all remaining moves with animation (cards fly to foundations in sequence)\n- Player can interrupt auto-complete by pressing undo\n- Auto-complete is undoable as a single compound action (CompoundCommand)\n- Auto-complete does not trigger if any column has cards in non-descending order that block foundation play\n- Unit tests cover: trivially winnable detection (positive and negative cases), edge cases (empty columns, single-card columns)\n- `npm test` passes; `npm run build` succeeds\n\n## Minimal Implementation\n\n- Implement `isTriviallyWinnable(state)` heuristic function\n- Check after each move (including after auto-moves from Feature 7)\n- When detected, queue all remaining foundation moves as a single CompoundCommand\n- Animate the sequence with brief delays between each card\n- Allow cancellation: if undo is triggered during animation, stop auto-complete and undo the compound\n\n## Dependencies\n\n- Auto-Move to Foundations (CG-0MLTFEN5A0DG3P0M): auto-move infrastructure and animation patterns\n- Undo/Redo Module (CG-0MLTFC94Z00K32ZI): CompoundCommand support\n\n## Deliverables\n\n- `isTriviallyWinnable()` function in game logic module\n- Auto-complete animation and execution in scene\n- Unit tests for winnable detection heuristic","effort":"","id":"CG-0MLTFFGBH1CEPC7J","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"medium","risk":"","sortIndex":900,"stage":"idea","status":"blocked","tags":[],"title":"Auto-Complete","updatedAt":"2026-02-19T12:18:45.209Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:18:23.886Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nAdd JSON transcript recording compatible with the Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN), integrate the reusable HelpPanel with Beleaguered Castle rules, add undo/redo keyboard shortcuts, and write comprehensive integration tests. Update project documentation.\n\n## User Story\n\nAs an engine developer, I want a JSON transcript of each game for replay and debugging, a help panel explaining the rules, keyboard shortcuts for undo/redo, and integration tests proving the game works end-to-end.\n\nAs a player, I want to press Ctrl+Z to undo, see game rules via a help button, and have my games recorded for replay.\n\n## Acceptance Criteria\n\n- Each completed game produces a JSON transcript compatible with the Visual Replay Dev Tool envelope format\n- Transcript records: deal (seed, initial state), each player move (source column, destination), auto-moves, undo/redo actions, final outcome (win/loss, move count, elapsed time)\n- Transcript JSON is parseable and contains at least `version`, `seed`, `moves`, and `outcome` fields\n- Help panel displays Beleaguered Castle rules, controls, and keyboard shortcuts (using reusable HelpPanel/HelpButton from `src/ui/`)\n- Help panel is dismissable with Escape key\n- Undo: Ctrl+Z (Cmd+Z on Mac) keyboard shortcut + on-screen button\n- Redo: Ctrl+Y (Cmd+Shift+Z on Mac) keyboard shortcut + on-screen button\n- Integration test plays a seeded game to completion programmatically and verifies: deal correctness, move execution, win detection, transcript validity\n- All tests pass via `npm test`; `npm run build` succeeds\n- `docs/DEVELOPER.md` updated with Beleaguered Castle section (game files, running, tests)\n- `README.md` updated with Beleaguered Castle in example games table\n\n## Minimal Implementation\n\n- Adapt `TranscriptRecorder` pattern from Golf (`example-games/golf/GameTranscript.ts`) for solitaire: single-player moves, auto-moves, undo/redo events, seed recording\n- Define Beleaguered Castle transcript interfaces (compatible with Golf envelope but solitaire-specific turn records)\n- Create `example-games/beleaguered-castle/help-content.json` with game rules and controls\n- Integrate HelpPanel and HelpButton into BeleagueredCastleScene\n- Add keyboard event listeners for undo (Ctrl+Z) and redo (Ctrl+Y / Ctrl+Shift+Z)\n- Add on-screen undo/redo buttons\n- Write integration test: set up game with known seed, execute a sequence of moves programmatically, verify win detection and transcript correctness\n- Update `docs/DEVELOPER.md` with Beleaguered Castle game section\n- Update `README.md` example games table\n\n## Dependencies\n\n- All previous features (1-9) must be complete\n\n## Deliverables\n\n- Transcript module (`example-games/beleaguered-castle/GameTranscript.ts`)\n- Help content JSON file\n- Keyboard shortcuts for undo/redo\n- On-screen undo/redo buttons\n- Integration tests in `tests/beleaguered-castle/`\n- Updated `docs/DEVELOPER.md` and `README.md`\n\n## Related Work\n\n- related-to:CG-0MLSN2YWY1EL17FN (Game Log Visual Replay Dev Tool -- transcript compatibility)\n- related-to:CG-0MLT0PM000TQRIXT (Help Screen with Game Rules -- reusable components)\n- `example-games/golf/GameTranscript.ts` (transcript pattern reference)\n- `example-games/golf/help-content.json` (help content pattern reference)\n- `src/ui/HelpPanel.ts` and `src/ui/HelpButton.ts` (reusable UI components)","effort":"","id":"CG-0MLTFG3RI1ULI5TT","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSDWFLT1WB6IEB","priority":"high","risk":"","sortIndex":1000,"stage":"idea","status":"open","tags":[],"title":"Transcript, Help Panel, Integration Tests","updatedAt":"2026-02-19T12:18:23.886Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:26:51.161Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nAuto-save completed game transcripts to IndexedDB (localStorage fallback) with a rolling window of the last 10 games per game type.\n\n## User Story\n\nAs an engine developer, I want completed game transcripts to persist automatically in the browser so I can access recent game data without manual export steps.\n\n## Acceptance Criteria\n\n- After a Golf game completes, the finalized transcript is automatically saved to IndexedDB\n- If IndexedDB is unavailable, falls back to localStorage with appropriate size warnings logged to console\n- A rolling window retains only the last 10 transcripts per game type; storing an 11th evicts the oldest (verified by checking store count remains 10)\n- Each stored transcript includes game type, timestamp, and the full GameTranscript JSON\n- If IndexedDB and localStorage are both unavailable (e.g., private browsing), the save fails gracefully without crashing the game\n- Unit tests verify save, retrieve, eviction, and fallback behavior\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Create a TranscriptStore module with save(), list(), get(), clear() methods\n- Integrate into GolfScene to auto-save on game completion (after TranscriptRecorder.finalize())\n- Implement rolling eviction logic (keep newest 10)\n- Write unit tests for the store (browser tests for IndexedDB, mock tests for fallback)\n\n## Prototype / Experiment\n\nVerify IndexedDB save/retrieve round-trips a GameTranscript in a browser test. Success = transcript survives page reload.\n\n## Dependencies\n\nNone (can start immediately)\n\n## Deliverables\n\n- TranscriptStore module\n- Integration into GolfScene\n- Unit and browser tests\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)\n- related-to: Game Transcript Recording (CG-0MLSPIQ1516DJNQL)","effort":"","id":"CG-0MLTFQZ6G09TVLDL","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"high","risk":"","sortIndex":100,"stage":"idea","status":"open","tags":[],"title":"Transcript Browser Storage Auto-Save","updatedAt":"2026-02-19T12:26:51.161Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:27:12.473Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFRFMH0P6MAZF","to":"CG-0MLTFQZ6G09TVLDL"}],"description":"## Summary\n\nAdd a Vite dev-server plugin for direct-to-disk transcript saving during development, plus a CLI export script that extracts transcripts from browser storage to data/transcripts/<game>/ on disk.\n\n## User Story\n\nAs an engine developer, I want transcripts saved to disk files automatically during development and exportable via CLI so I can version, share, and feed them into the replay tool.\n\n## Acceptance Criteria\n\n- A Vite dev-server plugin accepts POST requests from the game at /api/transcripts and writes transcript JSON to data/transcripts/<game>/\n- data/ is added to .gitignore\n- npm run transcripts:export -- golf uses Playwright to connect to the game, read transcripts from IndexedDB, and write them as JSON files to data/transcripts/golf/\n- Exported files are named with timestamp and game metadata (e.g., golf-2026-02-19T12-00-00.json)\n- If no transcripts exist in browser storage, the export script prints 'No transcripts found' and exits with code 0\n- If data/ directory does not exist, the export script creates it\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Create a Vite plugin in scripts/vite-transcript-plugin.ts that adds a /api/transcripts POST endpoint\n- Create scripts/export-transcripts.ts that launches Playwright, navigates to the game, runs TranscriptStore.list() via page.evaluate(), writes results to disk\n- Add transcripts:export npm script to package.json\n- Add data/ to .gitignore\n\n## Prototype / Experiment\n\nVerify Vite plugin receives and writes a POST body to disk in a dev server test. Success = JSON file appears in data/transcripts/.\n\n## Dependencies\n\n- Feature 1: Transcript Browser Storage Auto-Save (CG-0MLTFQZ6G09TVLDL)\n\n## Deliverables\n\n- Vite plugin (scripts/vite-transcript-plugin.ts)\n- Export CLI script (scripts/export-transcripts.ts)\n- npm script entry\n- .gitignore update\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)","effort":"","id":"CG-0MLTFRFMH0P6MAZF","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"high","risk":"","sortIndex":200,"stage":"idea","status":"blocked","tags":[],"title":"Transcript Disk Persistence & CLI Export","updatedAt":"2026-02-19T12:30:03.453Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:27:31.179Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nAdd a transcript export button on the end-of-round screen and on error detection, allowing manual JSON download of the current game transcript.\n\n## User Story\n\nAs a developer or tester, I want to download the current game transcript as a JSON file directly from the game UI so I can save it for debugging or sharing without using CLI tools.\n\n## Acceptance Criteria\n\n- An 'Export Transcript' button appears on the end-of-round results screen\n- Clicking the button triggers a browser download of the current transcript as a .json file\n- If a JavaScript error is detected during gameplay, an 'Export Transcript' button appears (via window.onerror or similar error boundary)\n- The downloaded file is valid JSON matching the GameTranscript schema\n- If the transcript is empty (no turns recorded), the export button still produces a valid JSON file with empty turns array\n- The button does not interfere with normal gameplay UI\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Add a Phaser text/button to the end-of-round overlay in GolfScene.ts\n- Implement a downloadTranscript() helper that serializes the transcript to JSON and triggers a browser file download via Blob + URL.createObjectURL\n- Add window.onerror listener that shows the export button on error\n- Write a browser test verifying the button exists on the end-of-round screen\n\n## Dependencies\n\nNone (uses existing TranscriptRecorder from GolfScene)\n\n## Deliverables\n\n- Export button in GolfScene end-of-round screen\n- Error-triggered export button\n- downloadTranscript() helper\n- Browser test\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)\n- related-to: Game Transcript Recording (CG-0MLSPIQ1516DJNQL)","effort":"","id":"CG-0MLTFRU211Y0Z2WU","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"medium","risk":"","sortIndex":300,"stage":"idea","status":"open","tags":[],"title":"In-Game Transcript Export Button","updatedAt":"2026-02-19T12:27:31.179Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:27:52.744Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nAdd a typed event emitter to src/core-engine/ that games use to signal turn lifecycle events, with a bridge to Phaser's scene event system for in-browser consumers.\n\n## User Story\n\nAs an engine developer, I want a standardized event system for turn lifecycle events so that tools (replay, testing, telemetry) can synchronize with game state changes without coupling to Phaser or game-specific code.\n\n## Acceptance Criteria\n\n- A GameEventEmitter class is exported from src/core-engine/ with typed events: turn-started, turn-completed, animation-complete, state-settled, game-ended\n- Each event includes a typed payload (turn number, player index, game phase, etc.)\n- Subscribing to a non-existent event type produces a compile-time TypeScript error (type-safe event map)\n- The emitter works in headless (Node.js) environments without Phaser\n- A PhaserEventBridge utility bridges GameEventEmitter events to Phaser scene.events and vice versa\n- Unit tests verify event emission, subscription, unsubscription, and payload types in Node.js\n- Integration test verifies the Phaser bridge works in a browser test\n- src/core-engine/index.ts barrel file updated to export GameEventEmitter, PhaserEventBridge, and event type definitions\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Create src/core-engine/GameEventEmitter.ts -- a minimal typed EventEmitter (no external deps)\n- Define event type map: { 'turn-started': TurnStartedPayload, 'turn-completed': TurnCompletedPayload, 'animation-complete': AnimationCompletePayload, 'state-settled': StateSettledPayload, 'game-ended': GameEndedPayload }\n- Create src/core-engine/PhaserEventBridge.ts that connects GameEventEmitter to a Phaser scene's event system (bidirectional forwarding)\n- Write unit tests in tests/core-engine/\n- Write browser test verifying bridge fires events through Phaser's scene events\n\n## Dependencies\n\nNone (can be done in parallel with Features 1-3)\n\n## Deliverables\n\n- src/core-engine/GameEventEmitter.ts\n- src/core-engine/PhaserEventBridge.ts\n- Event payload type definitions\n- Unit tests (tests/core-engine/GameEventEmitter.test.ts)\n- Browser test (tests/core-engine/PhaserEventBridge.browser.test.ts)\n- Updated src/core-engine/index.ts\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)\n- related-to: Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0)","effort":"","id":"CG-0MLTFSAOM1W4UKI8","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"high","risk":"","sortIndex":400,"stage":"idea","status":"open","tags":[],"title":"Core Engine Event System","updatedAt":"2026-02-19T12:27:52.744Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:28:12.119Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFSPNA1WUN7MS","to":"CG-0MLTFSAOM1W4UKI8"}],"description":"## Summary\n\nIntegrate the core engine event system into the Golf scene so it emits lifecycle events at the correct points during gameplay, and expose the emitter globally for the replay tool.\n\n## User Story\n\nAs a replay tool consumer, I want the Golf scene to emit standardized lifecycle events so the replay tool can synchronize turn-by-turn screenshot capture with game state changes.\n\n## Acceptance Criteria\n\n- GolfScene creates a GameEventEmitter instance and bridges it to the scene's Phaser events via PhaserEventBridge\n- The emitter is accessible via window.__GAME_EVENTS__ (alongside the existing window.__PHASER_GAME__)\n- turn-started fires when a player's turn begins (before draw phase)\n- turn-completed fires after a move is applied and the transcript is recorded\n- animation-complete fires after all tween animations for a turn finish\n- state-settled fires after animations complete and the board is visually stable (safe to screenshot)\n- game-ended fires after the final turn and scoring is complete\n- At least one browser test verifies each event fires during a game play-through\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Instantiate GameEventEmitter in GolfScene.create()\n- Wire PhaserEventBridge to the scene\n- Emit turn-started at the beginning of executeTurn flow\n- Emit turn-completed after move application and transcript recording\n- Emit animation-complete after all tweens resolve\n- Emit state-settled after animations + any post-animation updates\n- Emit game-ended in the end-of-round handler\n- Expose emitter as window.__GAME_EVENTS__\n- Write browser tests verifying event sequence\n\n## Dependencies\n\n- Feature 4: Core Engine Event System (CG-0MLTFSAOM1W4UKI8)\n\n## Deliverables\n\n- Updated example-games/golf/scenes/GolfScene.ts\n- Updated example-games/golf/main.ts (global exposure)\n- Browser tests (tests/golf/GolfEvents.browser.test.ts)\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)\n- related-to: Golf Phaser UI (CG-0MLSPJ9EW1WGHKLX)","effort":"","id":"CG-0MLTFSPNA1WUN7MS","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"high","risk":"","sortIndex":500,"stage":"idea","status":"blocked","tags":[],"title":"Golf Scene Event Integration","updatedAt":"2026-02-19T12:30:04.888Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:28:42.396Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFTD0B0B3EL3W","to":"CG-0MLTFSPNA1WUN7MS"}],"description":"## Summary\n\nCreate the primary replay tool that loads a transcript JSON file, boots the game in replay mode, injects board state per turn, captures PNG screenshots, auto-manages the dev server, and produces a JSON summary report.\n\n## User Story\n\nAs an engine developer, I want to run npm run replay -- transcript.json and get per-turn PNG screenshots of the game so I can visually verify rendering correctness and catch visual regressions without manual play.\n\n## Acceptance Criteria\n\n- npm run replay -- data/transcripts/golf/game-001.json --output data/screenshots/golf/game-001/ replays the transcript and produces per-turn PNG screenshots\n- The game boots in headless Playwright with ?mode=replay URL parameter and a pinned viewport (900x700)\n- GolfScene supports a replay mode that suppresses player input and AI turns\n- GolfScene exposes a loadBoardState(boardStates, discardTop, stockRemaining) method that renders an arbitrary board state from transcript snapshots\n- For each turn, the tool calls loadBoardState(), waits for state-settled event, then captures a PNG screenshot\n- Screenshots are named sequentially: turn-000.png, turn-001.png, etc.\n- A JSON summary report is produced listing: turns replayed, screenshot file paths, timing per turn, and any errors encountered\n- If the dev server is not running at localhost:3000, the script auto-starts npm run dev in the background and waits for readiness; cleans up on exit\n- If the transcript has version != 1, the tool exits with error: 'Unsupported transcript version: X. Expected: 1'\n- If the transcript file does not exist or is invalid JSON, the tool exits with a clear error message\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Create scripts/replay.ts as the entry point (TypeScript, run via tsx or ts-node)\n- Add ?mode=replay handling to GolfScene.create() that disables input handlers and AI turn scheduling\n- Implement loadBoardState() on GolfScene that positions card sprites, pile states, and score text from snapshot data\n- Use Playwright to navigate to localhost:3000?mode=replay, wait for scene ready\n- Iterate transcript turns, inject state via page.evaluate() calling scene.loadBoardState(), wait for state-settled, screenshot\n- Implement dev server auto-start: check port 3000, spawn npm run dev if needed, wait for HTTP 200, kill on cleanup\n- Add replay npm script to package.json\n- Write integration test with a fixture transcript JSON\n\n## Prototype / Experiment\n\nVerify loadBoardState() renders a known snapshot and produces a visually correct canvas screenshot. Success = screenshot matches expected card positions for a fixture snapshot.\n\n## Dependencies\n\n- Feature 5: Golf Scene Event Integration (CG-0MLTFSPNA1WUN7MS) -- for state-settled synchronization\n\n## Deliverables\n\n- scripts/replay.ts\n- Updated GolfScene.ts (replay mode + loadBoardState API)\n- npm script (replay) in package.json\n- JSON summary report format\n- Fixture transcript for testing\n- Integration test\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)\n- related-to: Phaser UI Browser Testing (CG-0MLSUJIE30K54IUO) -- reuses Playwright patterns\n- related-to: Golf browser tests (tests/golf/GolfInteraction.browser.test.ts) -- demonstrates canvas interaction","effort":"","id":"CG-0MLTFTD0B0B3EL3W","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"high","risk":"","sortIndex":600,"stage":"idea","status":"blocked","tags":[],"title":"Replay Tool — Screenshots & State Injection","updatedAt":"2026-02-19T12:30:06.257Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:29:02.944Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFTSV31CVV57R","to":"CG-0MLTFTD0B0B3EL3W"}],"description":"## Summary\n\nSupport --stop-at <turn> to pause replay at a specific turn and hand the browser to the developer for interactive investigation in headed (non-headless) mode.\n\n## User Story\n\nAs a QA tester, I want to replay a transcript up to a specific turn and then take over the browser interactively so I can investigate bugs at the exact game state where they occur.\n\n## Acceptance Criteria\n\n- npm run replay -- transcript.json --stop-at 12 replays turns 0-11, then pauses\n- When paused, the browser runs in headed (non-headless) mode so the developer can see and interact with it\n- The game transitions from replay mode back to interactive mode at the paused turn state (player input re-enabled)\n- The developer can manually play from the paused point forward\n- Screenshots are captured for turns 0 through stop-at minus 1\n- Console output indicates the browser is ready for takeover with the URL and turn info\n- If --stop-at exceeds total turns, replay completes all turns and prints a warning: 'Warning: --stop-at N exceeds total turns (M). Replayed all turns.'\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Add --stop-at CLI argument parsing in scripts/replay.ts\n- When --stop-at is specified, launch Playwright in headed mode from the start (or use --headed flag)\n- After reaching the target turn, remove ?mode=replay state and re-enable player input by calling a scene method (e.g., scene.enableInteractiveMode())\n- Print handoff message to console with URL and current turn info\n- Keep the script running until the developer closes the browser or presses Ctrl+C\n\n## Dependencies\n\n- Feature 6: Replay Tool -- Screenshots & State Injection (CG-0MLTFTD0B0B3EL3W)\n\n## Deliverables\n\n- Updated scripts/replay.ts with --stop-at support\n- GolfScene.enableInteractiveMode() method\n- Integration test\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)","effort":"","id":"CG-0MLTFTSV31CVV57R","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"high","risk":"","sortIndex":700,"stage":"idea","status":"blocked","tags":[],"title":"Replay Partial Stop & Interactive Takeover","updatedAt":"2026-02-19T12:30:07.549Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:29:19.196Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFU5EK1XCH545","to":"CG-0MLTFTD0B0B3EL3W"}],"description":"## Summary\n\nAfter replay completes, generate a summary contact sheet image showing all per-turn screenshots arranged in a grid for quick visual review.\n\n## User Story\n\nAs a game designer, I want a single overview image showing all turns of a replayed game at a glance so I can quickly scan the full game flow without opening individual screenshots.\n\n## Acceptance Criteria\n\n- After all per-turn screenshots are captured, a contact-sheet.png is generated in the output directory\n- The contact sheet arranges per-turn screenshots in a grid (default 4 columns) with turn numbers labeled below each thumbnail\n- Thumbnails are at least 225x175px (legible at reasonable size)\n- The contact sheet is generated using either Playwright canvas rendering (HTML page with thumbnail grid) or a lightweight library like sharp (MIT licensed)\n- The summary JSON report includes the contact sheet file path\n- If only 1 turn exists, the contact sheet is still generated (single image with label)\n- No heavy image-processing dependencies are added (prefer sharp or Playwright-based approach)\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- After replay loop completes, render a simple HTML page with <img> tags for each turn screenshot in a grid layout\n- Use Playwright to screenshot the HTML page, producing the contact sheet\n- Alternatively: use sharp (MIT) to read PNG files and composite them into a grid\n- Add turn-number labels below each thumbnail\n- Include contact sheet path in the JSON summary report\n\n## Dependencies\n\n- Feature 6: Replay Tool -- Screenshots & State Injection (CG-0MLTFTD0B0B3EL3W) -- needs screenshot outputs as inputs\n\n## Deliverables\n\n- Contact sheet generator (in scripts/replay.ts or separate scripts/contact-sheet.ts)\n- Updated JSON summary report format\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)","effort":"","id":"CG-0MLTFU5EK1XCH545","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"medium","risk":"","sortIndex":800,"stage":"idea","status":"blocked","tags":[],"title":"Screenshot Contact Sheet Generator","updatedAt":"2026-02-19T12:30:08.658Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:29:39.415Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"CG-0MLTFUL061DWDGA2","to":"CG-0MLTFTD0B0B3EL3W"}],"description":"## Summary\n\nRefactor the replay tool to use a game adapter interface, then validate the pattern works with Beleaguered Castle (if sufficiently complete) to prove multi-game support.\n\n## User Story\n\nAs an engine developer, I want the replay tool to support multiple games through an adapter pattern so that adding replay support for a new game requires only implementing a small adapter rather than modifying the replay core.\n\n## Acceptance Criteria\n\n- A ReplayAdapter interface is defined with methods: getGameType(), loadBoardState(snapshot), getSceneKey(), getReplayUrl()\n- GolfReplayAdapter implements the interface for the Golf game, extracting game-specific logic from the replay script\n- The replay script uses the adapter interface, selecting the adapter based on transcript metadata (gameType field) or --game CLI argument\n- If Beleaguered Castle has a working scene, a BeleagueredCastleReplayAdapter is created that validates the interface works with a different game\n- If Beleaguered Castle does not have a working scene, a typed stub proving the interface compiles is sufficient\n- The adapter interface is documented with JSDoc comments\n- npm test passes; npm run build succeeds\n\n## Minimal Implementation\n\n- Define ReplayAdapter interface in scripts/adapters/ReplayAdapter.ts (or src/core-engine/ReplayAdapter.ts if it should be part of the engine)\n- Extract game-specific logic from scripts/replay.ts into scripts/adapters/GolfReplayAdapter.ts\n- Add adapter selection logic in replay.ts: match on gameType field in transcript metadata or --game CLI flag\n- Check Beleaguered Castle status (CG-0MLSDWFLT1WB6IEB); create real adapter if scene exists, typed stub otherwise\n- Add unit test verifying adapter selection and interface compliance\n\n## Dependencies\n\n- Feature 6: Replay Tool -- Screenshots & State Injection (CG-0MLTFTD0B0B3EL3W)\n- Beleaguered Castle (CG-0MLSDWFLT1WB6IEB) -- soft dependency; stub is acceptable if BC is not ready\n\n## Deliverables\n\n- ReplayAdapter interface definition\n- GolfReplayAdapter implementation\n- BeleagueredCastleReplayAdapter (real or stub)\n- Updated scripts/replay.ts (adapter-based)\n- Unit test for adapter selection\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)\n- related-to: Beleaguered Castle (CG-0MLSDWFLT1WB6IEB)","effort":"","id":"CG-0MLTFUL061DWDGA2","issueType":"feature","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"medium","risk":"","sortIndex":900,"stage":"idea","status":"blocked","tags":[],"title":"Game-Agnostic Replay Adapter Pattern","updatedAt":"2026-02-19T12:30:09.522Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-19T12:29:55.615Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"## Summary\n\nUpdate docs/DEVELOPER.md with usage instructions for the replay tool, transcript persistence, engine event system, and all new npm scripts.\n\n## User Story\n\nAs a new contributor, I want documentation that explains how to use the replay tool, export transcripts, and understand the engine event system so I can debug and extend games effectively.\n\n## Acceptance Criteria\n\n- docs/DEVELOPER.md documents:\n  - Replay tool usage (npm run replay with examples for full replay and --stop-at)\n  - Transcript auto-save behavior (IndexedDB rolling window)\n  - npm run transcripts:export usage with examples\n  - Engine event system overview (event names, payloads, how to subscribe)\n  - In-game export button description\n  - Contact sheet output description\n- Each new npm script is documented with usage examples and expected output\n- Troubleshooting section updated with entries for:\n  - Dev server not running when using replay tool\n  - Unsupported transcript version error\n  - IndexedDB storage quota issues\n  - Playwright not installed\n- AGENTS.md updated if directory structure changed (e.g., scripts/, data/ directories, new modules in src/core-engine/)\n- npm run build succeeds (docs changes do not break build)\n\n## Minimal Implementation\n\n- Add 'Replay Tool' section to docs/DEVELOPER.md\n- Add 'Transcript Persistence' section\n- Add 'Engine Event System' section\n- Update troubleshooting section\n- Review and update AGENTS.md directory structure diagram if needed\n\n## Dependencies\n\nAll previous features (documents what was built)\n\n## Deliverables\n\n- Updated docs/DEVELOPER.md\n- Updated AGENTS.md (if needed)\n\n## Related Work\n\n- Parent: Game Log Visual Replay Dev Tool (CG-0MLSN2YWY1EL17FN)","effort":"","id":"CG-0MLTFUXI713N7W44","issueType":"task","needsProducerReview":false,"parentId":"CG-0MLSN2YWY1EL17FN","priority":"medium","risk":"","sortIndex":1000,"stage":"idea","status":"open","tags":[],"title":"Replay Tool Documentation Update","updatedAt":"2026-02-19T12:29:55.615Z"},"type":"workitem"}
{"data":{"author":"opencode","comment":"Planning Complete. Epic decomposed into 8 feature work items:\n\n1. Card Asset Pipeline (CG-0MLSPHIDD19PBDOZ) - Source 52-card SVG deck from saulspatz/SVGCards (public domain)\n2. Card System Engine Module (CG-0MLSPHOWY1HSCIDX) - Card, Deck, Pile in src/card-system/\n3. Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0) - GameState, TurnSequencer in src/core-engine/\n4. Golf Game Rules and Scoring (CG-0MLSPI9YQ083H8LO) - GolfGrid, scoring, turn logic in example-games/golf/\n5. AI Player (CG-0MLSPIGPM0HRCCYE) - Random and Greedy strategies in example-games/golf/\n6. Game Transcript Recording (CG-0MLSPIQ1516DJNQL) - Replay-ready JSON transcripts in example-games/golf/\n7. Golf Phaser UI (CG-0MLSPJ9EW1WGHKLX) - Single GolfScene with full visual interface\n8. Integration Test and Documentation (CG-0MLSPJFWL14OQNJ5) - E2E tests and doc updates\n\nDependency graph: {1,2,3} parallel -> {4} -> {5,6} parallel -> {7} -> {8}\n\nKey decisions captured during planning:\n- Card assets: saulspatz/SVGCards (public domain), resized to 140x190px\n- Card/Deck/Pile go in engine (src/card-system/) - broadly reusable\n- Turn sequencer goes in engine (src/core-engine/) - broadly reusable\n- Golf rules/scoring stay local to example-games/golf/ - game-specific, rule-engine extraction deferred\n- Grid type stays local to golf game - extract after second game validates\n- Single Phaser scene for full game flow\n- Transcript format designed for replay tool (CG-0MLSN2YWY1EL17FN) consumption\n\nOpen questions:\n- Feature 7 (Golf Phaser UI) may benefit from sub-task breakdown during implementation","createdAt":"2026-02-19T00:13:52.304Z","id":"CG-C0MLSPKCVJ13XOMZZ","references":[],"workItemId":"CG-0MLSDW7YM1IWH2SB"},"type":"comment"}
{"data":{"author":"opencode","comment":"All 8 child features completed and merged to main. Summary:\n\n1. Card Asset Pipeline (CG-0MLSPHIDD19PBDOZ) - 52 card SVGs at 140x190px\n2. Card System Engine Module (CG-0MLSPHOWY1HSCIDX) - Card, Deck, Pile abstractions\n3. Core Engine Turn Sequencer (CG-0MLSPHU1C02RAGE0) - GameState, TurnSequencer\n4. Golf Game Rules and Scoring (CG-0MLSPI9YQ083H8LO) - GolfGrid, scoring, turn legality\n5. AI Player (CG-0MLSPIGPM0HRCCYE) - RandomStrategy, GreedyStrategy, AiPlayer\n6. Game Transcript Recording (CG-0MLSPIQ1516DJNQL) - TranscriptRecorder, JSON transcripts\n7. Golf Phaser UI (CG-0MLSPJ9EW1WGHKLX) - Full Phaser scene (GolfScene.ts, 674 lines)\n8. Integration Test and Documentation (CG-0MLSPJFWL14OQNJ5) - 19 integration tests, docs updated\n\nTotal: 204 tests passing across 15 test files. npm run build succeeds. Game playable at localhost:3000 via npm run dev.\n\nEpic is ready for producer review and closure.","createdAt":"2026-02-19T02:10:39.571Z","id":"CG-C0MLSTQJPU0JTR6MV","references":[],"workItemId":"CG-0MLSDW7YM1IWH2SB"},"type":"comment"}
{"data":{"author":"opencode","comment":"All 10 child work items completed and merged to main. Final summary:\n\nFeatures 1-8: Card assets, card system, core engine, rules/scoring, AI player, transcript, Phaser UI, integration tests\nFeature 9: Browser testing infrastructure (CG-0MLSUJIE30K54IUO)\nBug fix 10: Fixed broken Golf UI layout (CG-0MLSW8TKZ0YHXJR2) - cards resized from 70x95 to 48x65, all layout positions recalculated\n\nFinal state: 218 tests passing (204 unit + 14 browser), npm run build succeeds, game fully playable at localhost:3000.\n\nMerge commit 7a007bc on main.","createdAt":"2026-02-19T04:07:45.066Z","id":"CG-C0MLSXX4MI0XSJ37N","references":[],"workItemId":"CG-0MLSDW7YM1IWH2SB"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: All 10 child features/fixes completed. 218 tests pass, build succeeds, game fully playable. Final merge commit 7a007bc.","createdAt":"2026-02-19T04:07:54.310Z","id":"CG-C0MLSXXBRA0M4C6GQ","references":[],"workItemId":"CG-0MLSDW7YM1IWH2SB"},"type":"comment"}
{"data":{"author":"Map","comment":"Priority upgraded from medium to high. This is the second game spike and introduces four significant new engine capabilities (single-player GameState, drag-and-drop input, undo/redo state management, auto-move heuristics) that will benefit all future solitaire-style games. Citadel variant (CG-0MLTDXG3H0WCXMUV) is blocked by this epic.","createdAt":"2026-02-19T11:53:38.514Z","id":"CG-C0MLTEK9N516EN6H8","references":[],"workItemId":"CG-0MLSDWFLT1WB6IEB"},"type":"comment"}
{"data":{"author":"opencode","comment":"Planning Complete. 10 child feature work items created:\n\n1. Single-Player Core Engine Support (CG-0MLTFBTE41EVGNKA) - high priority, no deps\n2. Undo/Redo Module - Command Pattern (CG-0MLTFC94Z00K32ZI) - high priority, no deps, related-to:CG-0MLSN2YWY1EL17FN\n3. Beleaguered Castle Game Logic (CG-0MLTFCTNK10RQ41T) - high priority, depends on F1\n4. Phaser Scene Static Card Layout (CG-0MLTFDAYD0J6KLY3) - high priority, depends on F3\n5. Drag-and-Drop Card Input (CG-0MLTFDTMT0G2I0ZT) - high priority, depends on F2, F3, F4\n6. Click-to-Move Card Input (CG-0MLTFE68N1TONFIE) - medium priority, depends on F5\n7. Auto-Move to Foundations (CG-0MLTFEN5A0DG3P0M) - high priority, depends on F2, F5\n8. Win/Loss, New Game, Restart, Scoring (CG-0MLTFF2R70UXJD2T) - high priority, depends on F3, F4\n9. Auto-Complete (CG-0MLTFFGBH1CEPC7J) - medium priority, depends on F2, F7\n10. Transcript, Help Panel, Integration Tests (CG-0MLTFG3RI1ULI5TT) - high priority, depends on all\n\nKey decisions:\n- Drag-and-drop delivered before click-to-move (F5 before F6)\n- Auto-move and auto-complete as separate features (F7 and F9)\n- Command pattern for undo/redo, aligned with CG-0MLSN2YWY1EL17FN transcript system\n- Time + moves scoring (not just win/loss)\n- Seeded RNG for reproducible deals\n- Compound undo for auto-move chains\n\nOpen Questions:\n1. Auto-move heuristic (F7): Exact safe-to-auto-move definition to be confirmed during implementation.\n\nF1 and F2 can be worked in parallel. F8 can be worked in parallel with F5/F6/F7.","createdAt":"2026-02-19T12:19:08.652Z","id":"CG-C0MLTFH2AZ0UFUDNS","references":[],"workItemId":"CG-0MLSDWFLT1WB6IEB"},"type":"comment"}
{"data":{"author":"Map","comment":"Blocks: CG-0MLSDW7YM1IWH2SB (9-Card Golf), CG-0MLSDWFLT1WB6IEB (Beleaguered Castle), CG-0MLSDWSCG154TUEL (Sushi Go!), CG-0MLSDX4B91DG6S1A (Splendor), CG-0MLSDXELC06VESJL (Lost Cities), CG-0MLSDXNMM1R2IMT9 (The Mind), CG-0MLSDXY9F1FSGQ38 (Coloretto). All 7 game spikes require a scaffolded project before implementation can begin.","createdAt":"2026-02-18T19:53:33.044Z","id":"CG-C0MLSG9KYR1P216LK","references":[],"workItemId":"CG-0MLSFU7300TLFCBH"},"type":"comment"}
{"data":{"author":"opencode","comment":"Planning Complete. Decomposed into 6 child features:\n\n1. Initialize Git Repository and .gitignore (CG-0MLSGNEUY15SODX5) - git init, comprehensive .gitignore, initial commit\n2. Package.json, Vite, and TypeScript Config (CG-0MLSGNJUD0F48DHV) - package.json, tsconfig, vite config, index.html\n3. Directory Structure and Placeholder Modules (CG-0MLSGNPFI0ZX35FR) - flat monorepo dirs, barrel-file placeholders\n4. Hello-World Phaser Scene with Card Sprite (CG-0MLSGO24L0PVQ8B9) - Phaser scene, CC0 card assets, asset pipeline proof\n5. Vitest Setup and Smoke Test (CG-0MLSGO76R0YFSV77) - Vitest config, trivial smoke test\n6. AGENTS.md Comprehensive Rewrite (CG-0MLSGODWP0IUDOBG) - tech stack, directory, overview, contribution guidance\n\nDependency chain: 1 -> 2 -> 3 -> 4 -> 6; 2 -> 5 -> 6 (Features 3/4 and 5 can be parallelized after Feature 2).\n\nDecisions confirmed during interview:\n- Minimal barrel files only (no skeleton types; deferred to first game spike)\n- Single Vite entry point (multi-page deferred)\n- CC0 playing card asset set for hello-world scene\n- Trivial smoke test (not module import test)\n- Broader AGENTS.md rewrite (tech stack + directory + overview + contribution guidance)\n- Worklog section preserved unchanged\n\nNo open questions remain.","createdAt":"2026-02-18T20:05:37.574Z","id":"CG-C0MLSGP4120XL66M9","references":[],"workItemId":"CG-0MLSFU7300TLFCBH"},"type":"comment"}
{"data":{"author":"opencode","comment":"Added README.md and docs/DEVELOPER.md via child work item CG-0MLSHQJIU0097VRY (commit f4ef772). AGENTS.md updated with Documentation section and Doc-Update Policy. Also created CG-0MLSHQMDY1H0I2B7 (medium priority) to add a pre-commit hook for automated doc-update enforcement.","createdAt":"2026-02-18T20:38:57.375Z","id":"CG-C0MLSHVZ321O3SN49","references":[],"workItemId":"CG-0MLSFU7300TLFCBH"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: Git repository initialized and .gitignore updated. Commit 26cce19. All acceptance criteria verified:\n- git status exits 0\n- .gitignore covers node_modules/, dist/, .vite/, *.js.map, .idea/, .vscode/, .DS_Store, Thumbs.db\n- Worklog-specific ignore rules preserved exactly\n- AGENTS.md and .gitignore tracked in initial commit\nFiles changed: .gitignore, AGENTS.md","createdAt":"2026-02-18T20:07:36.339Z","id":"CG-C0MLSGRNO30E0T8DR","references":[],"workItemId":"CG-0MLSGNEUY15SODX5"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: Package.json, Vite, and TypeScript configuration. Commit e26ed98. All acceptance criteria verified:\n- package.json with Phaser 3.90.0, TypeScript 5.7, Vite 6.1, Vitest 3.0\n- tsconfig.json with strict:true, ES2020 target, Phaser types resolve\n- vite.config.ts with path aliases and sourcemaps\n- index.html entry point\n- npm run build produces dist/ with exit code 0\nFiles: package.json, package-lock.json, tsconfig.json, vite.config.ts, index.html, example-games/hello-world/main.ts","createdAt":"2026-02-18T20:11:06.986Z","id":"CG-C0MLSGW67E0SGLFSB","references":[],"workItemId":"CG-0MLSGNJUD0F48DHV"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: Directory structure and placeholder barrel modules. Commit f77eca8. All acceptance criteria verified:\n- All directories exist: src/core-engine/, src/card-system/, src/rule-engine/, src/ui/, example-games/, public/, tests/\n- Each src/ module has index.ts with a named export\n- npm run build succeeds\n- TypeScript resolves without errors\nFiles: src/core-engine/index.ts, src/card-system/index.ts, src/rule-engine/index.ts, src/ui/index.ts","createdAt":"2026-02-18T20:12:47.403Z","id":"CG-C0MLSGYBOQ14PW140","references":[],"workItemId":"CG-0MLSGNPFI0ZX35FR"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: Hello-World Phaser scene with card sprites. Commit 0696c6d. All acceptance criteria verified:\n- HelloWorldScene extends Phaser.Scene at example-games/hello-world/scenes/HelloWorldScene.ts\n- CC0 SVG card images loaded from public/assets/cards/ and rendered\n- Asset attribution documented in public/assets/CREDITS.md\n- npm run build includes scene and assets in production bundle (dist/assets/cards/)\n- TypeScript compilation passes\nNote: Phaser bundle size warning (1.4MB) is expected and can be addressed with code-splitting later.\nFiles: example-games/hello-world/main.ts, example-games/hello-world/scenes/HelloWorldScene.ts, public/assets/cards/ace_of_spades.svg, public/assets/cards/card_back.svg, public/assets/CREDITS.md","createdAt":"2026-02-18T20:15:58.201Z","id":"CG-C0MLSH2EWO1CYUR71","references":[],"workItemId":"CG-0MLSGO24L0PVQ8B9"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: Vitest setup and smoke test. Commit 5dad2e4. All acceptance criteria verified:\n- npm test exits with code 0, reports 2 passed tests\n- tests/smoke.test.ts exists under tests/\n- Vitest configuration present in vite.config.ts (inline test block)\n- Build still succeeds after adding test config\nFiles: vite.config.ts, tests/smoke.test.ts","createdAt":"2026-02-18T20:18:23.516Z","id":"CG-C0MLSH5J171488LY5","references":[],"workItemId":"CG-0MLSGO76R0YFSV77"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: AGENTS.md comprehensive rewrite. Commit 38a6264. All acceptance criteria verified:\n- Technology stack references Phaser 3.x, Vite, Vitest (no Phaser 4, Webpack, Jest as primary tools)\n- Directory structure diagram matches actual scaffold layout\n- Project overview describes flat monorepo and spike-driven development\n- Contribution guidance reflects npm run dev/test/build workflow\n- Worklog AGENTS.md content between markers preserved unchanged\nFiles: AGENTS.md","createdAt":"2026-02-18T20:21:44.272Z","id":"CG-C0MLSH9TXS05JPFL2","references":[],"workItemId":"CG-0MLSGODWP0IUDOBG"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: Added README.md and docs/DEVELOPER.md; updated AGENTS.md with Documentation section and Doc-Update Policy. Commit f4ef772.\n\nAll acceptance criteria verified:\n- README.md exists with project summary, quick-start, repo layout, and contribution pointers\n- docs/DEVELOPER.md exists with environment setup, run/build/test, example-game guide, asset management, path aliases, troubleshooting, and doc-update policy\n- AGENTS.md includes Documentation section referencing README.md and docs/DEVELOPER.md\n- AGENTS.md includes Doc-Update Policy requiring child work items for infra changes without doc updates\n- npm test passes (2 tests), npm run build succeeds\n\nFiles changed: README.md, docs/DEVELOPER.md, AGENTS.md","createdAt":"2026-02-18T20:38:54.954Z","id":"CG-C0MLSHVX7R1W2U6BT","references":[],"workItemId":"CG-0MLSHQJIU0097VRY"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed rename across 10 files (package.json, README.md, AGENTS.md, index.html, docs/DEVELOPER.md, tests/smoke.test.ts, example-games/hello-world/main.ts, example-games/hello-world/scenes/HelloWorldScene.ts, src/ui/index.ts, package-lock.json). All tests pass, build succeeds. Commit f9e3938.","createdAt":"2026-02-18T21:09:54.366Z","id":"CG-C0MLSIZRXZ11GA0NO","references":[],"workItemId":"CG-0MLSIULHH0Y6I3DV"},"type":"comment"}
{"data":{"author":"opencode","comment":"Merged to main. Merge commit 605c8d7. All tests pass and build succeeds on main.","createdAt":"2026-02-18T21:11:53.941Z","id":"CG-C0MLSJ2C7O08RIL3R","references":[],"workItemId":"CG-0MLSIULHH0Y6I3DV"},"type":"comment"}
{"data":{"author":"Map","comment":"Dependency review: Original blocker CG-0MLSDW7YM1IWH2SB (9-Card Golf) is now completed. Transcript system and Playwright infrastructure are in place. No remaining external blockers -- all prerequisites (transcript schema, browser test patterns, core engine module) are available. Priority confirmed as high: important developer infrastructure but not critical.","createdAt":"2026-02-19T12:12:35.972Z","id":"CG-C0MLTF8NB7045S3LJ","references":[],"workItemId":"CG-0MLSN2YWY1EL17FN"},"type":"comment"}
{"data":{"author":"opencode","comment":"Planning Complete. Decomposed into 10 child features/tasks:\n\n1. Transcript Browser Storage Auto-Save (CG-0MLTFQZ6G09TVLDL) - IndexedDB auto-save with rolling window of 10\n2. Transcript Disk Persistence & CLI Export (CG-0MLTFRFMH0P6MAZF) - Vite plugin + npm run transcripts:export\n3. In-Game Transcript Export Button (CG-0MLTFRU211Y0Z2WU) - Download button on end-of-round screen + error handler\n4. Core Engine Event System (CG-0MLTFSAOM1W4UKI8) - Typed GameEventEmitter + PhaserEventBridge in src/core-engine/\n5. Golf Scene Event Integration (CG-0MLTFSPNA1WUN7MS) - Wire events into GolfScene turn lifecycle\n6. Replay Tool -- Screenshots & State Injection (CG-0MLTFTD0B0B3EL3W) - Primary deliverable: npm run replay with state injection, PNG capture, dev server auto-start\n7. Replay Partial Stop & Interactive Takeover (CG-0MLTFTSV31CVV57R) - --stop-at <turn> with headed browser handoff\n8. Screenshot Contact Sheet Generator (CG-0MLTFU5EK1XCH545) - Grid thumbnail summary image\n9. Game-Agnostic Replay Adapter Pattern (CG-0MLTFUL061DWDGA2) - ReplayAdapter interface + BC validation\n10. Replay Tool Documentation Update (CG-0MLTFUXI713N7W44) - docs/DEVELOPER.md + AGENTS.md updates\n\nTwo parallel implementation chains: persistence (1->2, 3) and events/replay (4->5->6->7,8,9). Chain 10 (docs) depends on all.\n\nKey design decisions confirmed during interview:\n- State injection first for MVP, UI automation as follow-up\n- Browser storage + Vite plugin for dual persistence\n- Core emitter with Phaser bridge (works headless + in-browser)\n- Auto-start dev server if not running\n- Export button on end-of-round screen + on error detection\n- Full PNG + contact sheet summary\n- Golf + Beleaguered Castle validation for adapter pattern\n\nOpen questions: none remaining.","createdAt":"2026-02-19T12:30:30.519Z","id":"CG-C0MLTFVOFA1OZWM33","references":[],"workItemId":"CG-0MLSN2YWY1EL17FN"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed Card Asset Pipeline. Added 52 card face SVGs + card back from saulspatz/SVGCards (public domain), resized to 140x190px, renamed to rank_of_suit.svg convention. Updated CREDITS.md. Added conversion script at scripts/convert-cards.mjs. All SVGs validated (valid XML, correct dimensions). Merge commit: 29d90d9","createdAt":"2026-02-19T01:46:53.857Z","id":"CG-C0MLSSVZMO1RXCLXQ","references":[],"workItemId":"CG-0MLSPHIDD19PBDOZ"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed: 52 SVG card faces + card back sourced, resized, renamed, and integrated. Merge commit 29d90d9.","createdAt":"2026-02-19T01:46:55.259Z","id":"CG-C0MLSSW0PM07HCBS2","references":[],"workItemId":"CG-0MLSPHIDD19PBDOZ"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implementation complete. Commit f368bb3 on branch wl-CG-0MLSPHOWY1HSCIDX-card-system-module. Files: src/card-system/Card.ts, Deck.ts, Pile.ts, index.ts; tests/card-system/Card.test.ts, Deck.test.ts, Pile.test.ts, index.test.ts. All 45 tests pass, tsc and vite build succeed.","createdAt":"2026-02-19T00:20:28.046Z","id":"CG-C0MLSPSU8502O2BJC","references":[],"workItemId":"CG-0MLSPHOWY1HSCIDX"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed. Merge commit 63446b6 on main. Card, Deck, and Pile abstractions implemented in src/card-system/ with 45 unit tests. All acceptance criteria met: Card type with rank/suit/faceUp, Deck with create/shuffle/draw, Pile with push/pop/peek/isEmpty/size, barrel exports, npm test and npm run build pass.","createdAt":"2026-02-19T00:21:15.989Z","id":"CG-C0MLSPTV850GNDWZU","references":[],"workItemId":"CG-0MLSPHOWY1HSCIDX"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implementation complete. Commit 9b476f9 merged to main via e9d158a. Files: src/core-engine/GameState.ts, TurnSequencer.ts, index.ts; tests/core-engine/GameState.test.ts, TurnSequencer.test.ts, index.test.ts. All 88 tests pass (43 new for core-engine), tsc --noEmit succeeds.","createdAt":"2026-02-19T00:33:35.885Z","id":"CG-C0MLSQ9Q4S13VFDHZ","references":[],"workItemId":"CG-0MLSPHU1C02RAGE0"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed. Merge commit e9d158a on main. GameState<T> generic container, TurnSequencer with phase transitions, 43 unit tests. All acceptance criteria met.","createdAt":"2026-02-19T00:33:37.734Z","id":"CG-C0MLSQ9RK60ZEEIFX","references":[],"workItemId":"CG-0MLSPHU1C02RAGE0"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implementation complete. Commit 23e4048 merged to main via ac8ed3b. Files: example-games/golf/GolfGrid.ts, GolfRules.ts, GolfScoring.ts; tests/golf/GolfGrid.test.ts, GolfRules.test.ts, GolfScoring.test.ts. 59 new tests (147 total), all pass. tsc --noEmit succeeds.","createdAt":"2026-02-19T01:40:58.365Z","id":"CG-C0MLSSODBQ1TMVC45","references":[],"workItemId":"CG-0MLSPI9YQ083H8LO"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed. Merge commit ac8ed3b. All acceptance criteria met: GolfGrid, scoring with column-matching, turn legality, end-of-round detection, initial reveal.","createdAt":"2026-02-19T01:41:01.110Z","id":"CG-C0MLSSOFG61KIZTAA","references":[],"workItemId":"CG-0MLSPI9YQ083H8LO"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed AI Player implementation. Added GolfGame.ts (game orchestration, setup, legal move enumeration, turn execution) and AiStrategy.ts (AiStrategy interface, RandomStrategy, GreedyStrategy, AiPlayer wrapper). 28 new tests including 3 full game simulations. Merge commit: bfabbc0","createdAt":"2026-02-19T01:53:58.397Z","id":"CG-C0MLST537G0PWGNRV","references":[],"workItemId":"CG-0MLSPIGPM0HRCCYE"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed: AI Player with RandomStrategy and GreedyStrategy. Merge commit bfabbc0.","createdAt":"2026-02-19T01:54:00.774Z","id":"CG-C0MLST550909P5UNV","references":[],"workItemId":"CG-0MLSPIGPM0HRCCYE"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed Game Transcript Recording. Added GameTranscript.ts with TypeScript interfaces (GameTranscript, TurnRecord, BoardSnapshot, CardSnapshot) and TranscriptRecorder class. 10 new tests including full game transcript validation. Merge commit: c4ba648","createdAt":"2026-02-19T01:57:10.653Z","id":"CG-C0MLST97JX0I7TCEM","references":[],"workItemId":"CG-0MLSPIQ1516DJNQL"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed: Game Transcript Recording with TranscriptRecorder and schema validation. Merge commit c4ba648.","createdAt":"2026-02-19T01:57:12.634Z","id":"CG-C0MLST992Y1OVEHCN","references":[],"workItemId":"CG-0MLSPIQ1516DJNQL"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implemented Golf Phaser UI. Commit 00d4217, merged to main in 03a01f5. Files: example-games/golf/scenes/GolfScene.ts (674 lines - full Phaser scene with 3x3 grids, stock/discard piles, click/tap input, card flip animations, turn indicators, score display, end-of-round screen, AI opponent with delay), example-games/golf/main.ts (entry point), index.html (updated to point to golf game). All 185 tests pass, TypeScript clean.","createdAt":"2026-02-19T02:03:46.267Z","id":"CG-C0MLSTHOT70EP8DWX","references":[],"workItemId":"CG-0MLSPJ9EW1WGHKLX"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed. Merge commit 03a01f5. GolfScene renders both players 3x3 grids, stock/discard piles, supports click/tap for draw/swap/discard-and-flip, card flip animations via tweens, turn/score indicators, end-of-round screen with play again, AI opponent. 185 tests pass.","createdAt":"2026-02-19T02:03:52.192Z","id":"CG-C0MLSTHTDH04AWAXW","references":[],"workItemId":"CG-0MLSPJ9EW1WGHKLX"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed integration tests and documentation. Commit 8392993, merged to main in 8b88e17. Files: tests/golf/Integration.test.ts (19 tests - full AI-vs-AI games with Random/Greedy strategies, transcript structure validation, game invariants including card conservation, face-up monotonicity, stock count tracking, JSON serialization), README.md (added Golf to example games table, updated repo layout), docs/DEVELOPER.md (added Golf game section with file listing, test listing, gameplay instructions, updated project structure). All 204 tests pass, npm run build succeeds.","createdAt":"2026-02-19T02:09:54.775Z","id":"CG-C0MLSTPL5612J3H9V","references":[],"workItemId":"CG-0MLSPJFWL14OQNJ5"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed. Merge commit 8b88e17. 19 integration tests (AI-vs-AI with Random/Greedy, transcript validation, game invariants). README.md and docs/DEVELOPER.md updated with Golf game. 204 tests pass, build succeeds.","createdAt":"2026-02-19T02:10:00.612Z","id":"CG-C0MLSTPPNJ1LI0JC8","references":[],"workItemId":"CG-0MLSPJFWL14OQNJ5"},"type":"comment"}
{"data":{"author":"opencode","comment":"Merged to main and pushed to origin. Merge commit 3ecd27a. All 210 tests pass (204 unit + 6 browser), tsc --noEmit clean, build succeeds. Files: vite.config.ts (test.projects), example-games/golf/createGolfGame.ts (new), example-games/golf/main.ts (updated), tests/golf/GolfScene.browser.test.ts (new, 6 tests), docs/DEVELOPER.md (browser testing section), package.json/package-lock.json (deps).","createdAt":"2026-02-19T02:51:03.378Z","id":"CG-C0MLSV6HXU11M7ALU","references":[],"workItemId":"CG-0MLSUJIE30K54IUO"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: All acceptance criteria met: @vitest/browser + playwright installed, test.projects configured, 6 browser tests verify canvas rendering/game state/interactions/no errors, all 210 tests pass, docs updated. Merge commit 3ecd27a pushed to origin/main.","createdAt":"2026-02-19T02:51:11.521Z","id":"CG-C0MLSV6O801P57R8J","references":[],"workItemId":"CG-0MLSUJIE30K54IUO"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: Fixed broken Golf UI layout and added interaction browser tests. Card dimensions reduced from 70x95 to 48x65, all layout positions recalculated for clean separation. Added 8 interaction browser tests covering the full turn flow. All 218 tests pass, build succeeds. Commit f251bff, merge commit 7a007bc.","createdAt":"2026-02-19T04:07:06.823Z","id":"CG-C0MLSXWB3Z0FGAP62","references":[],"workItemId":"CG-0MLSW8TKZ0YHXJR2"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Fixed broken Golf UI layout. Merge commit 7a007bc on main.","createdAt":"2026-02-19T04:07:13.304Z","id":"CG-C0MLSXWG471M1XBYZ","references":[],"workItemId":"CG-0MLSW8TKZ0YHXJR2"},"type":"comment"}
{"data":{"author":"opencode","comment":"Planning Complete. Decomposed into 7 feature work items:\n\n1. HelpPanel Core Component (CG-0MLTANMZ80E1GY0X) - Base class with heading/body sections, open/close state, configurable width\n2. Panel Slide Animation (CG-0MLTAO0XG0RGDGGN) - Slide-in/out tweens with cubic easing, interruption handling\n3. Scrollable Content with Track Bar (CG-0MLTAOG6U1SDSFHI) - Mouse wheel + drag scrolling, GeometryMask clipping, minimal track bar indicator\n4. Input Blocking and Close Button (CG-0MLTAOW5Z0ZK2GI0) - X close button, full-screen hit area to block game input while panel is open\n5. HelpButton Component (CG-0MLTAP9EE12DW186) - Reusable ? toggle button in src/ui/, top-right positioning\n6. Keyboard Shortcut Toggle (CG-0MLTAPNRB09U9C9F) - ? key (Shift+/) to toggle panel, configurable key, animation-aware\n7. Golf Help Content and Integration (CG-0MLTAQ7581C3NQOZ) - JSON help content file + wire HelpPanel/HelpButton into GolfScene\n\nDependency graph: F1 is root. F2, F3, F5 can parallelize after F1. F4, F6 require F1+F2. F7 (integration) depends on all others.\n\nDesign decisions captured during interview:\n- Animation: Polished with cubic easing curves (ease-out open, ease-in close)\n- Scroll indicator: Minimal vertical track bar\n- Content format: JSON data file (help-content.json)\n- Backdrop: No backdrop overlay\n- Help button position: Top-right corner of canvas\n- Keyboard shortcut: ? key (Shift+/)\n- Input blocking: Block all game pointer input when panel is open\n- Panel width: 35% of canvas width\n- Help sections: Arbitrary number with arbitrary headings (not fixed)\n\nAutomated review stages completed: Completeness, Sequencing & Dependencies, Scope Sizing, Acceptance & Testability, Polish & Handoff. All acceptance criteria verified as pass/fail testable with negative cases included.","createdAt":"2026-02-19T10:07:24.534Z","id":"CG-C0MLTARNG608H8ILA","references":[],"workItemId":"CG-0MLT0PM000TQRIXT"},"type":"comment"}
{"data":{"author":"opencode","comment":"All 7 child work items (F1-F7) completed and merged to main via merge commit ae149ae. Implementation commit: 8100b0d. All acceptance criteria satisfied: HelpPanel core component with sections rendering, slide animation with cubic easing, scrollable content with GeometryMask and track bar, input blocking with close button, HelpButton toggle, keyboard shortcut (Shift+/), and Golf game integration with 7-section help content. 210 unit tests pass, browser tests pass individually, TypeScript compilation clean, Vite production build succeeds. Ready for producer review.","createdAt":"2026-02-19T10:34:30.431Z","id":"CG-C0MLTBQHZY1V6KJGR","references":[],"workItemId":"CG-0MLT0PM000TQRIXT"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implemented HelpPanel core component in src/ui/HelpPanel.ts. Class accepts HelpPanelConfig with sections array and widthPercent. Renders left-side panel with background rectangle, heading/body text objects, open()/close()/toggle()/destroy() methods, isOpen property. Panel starts hidden off-screen. See commit 8100b0d.","createdAt":"2026-02-19T10:32:18.372Z","id":"CG-C0MLTBNO3A155ZLHW","references":[],"workItemId":"CG-0MLTANMZ80E1GY0X"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implemented slide animation in HelpPanel. open() uses Cubic.easeOut tween to slide panel from -panelWidth to 0. close() uses Cubic.easeIn to slide back off-screen. Animation duration configurable (default 300ms). Interruption handling: stops existing tween and starts new one from current position. See commit 8100b0d.","createdAt":"2026-02-19T10:32:21.129Z","id":"CG-C0MLTBNQ890BOZ9O5","references":[],"workItemId":"CG-0MLTAO0XG0RGDGGN"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implemented scrollable content with GeometryMask and track bar indicator. Mouse wheel scrolling with clamping. Track bar shows relative scroll position. Content clipped to panel boundaries. Scroll resets to top on open. See commit 8100b0d.","createdAt":"2026-02-19T10:32:23.646Z","id":"CG-C0MLTBNS651BUGM8V","references":[],"workItemId":"CG-0MLTAOG6U1SDSFHI"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implemented input blocking and close button. X close button at top-right with hover state. Full-screen transparent hit area blocks game input when panel is open. Clicking outside panel dismisses it. Input blocker removed on close. See commit 8100b0d.","createdAt":"2026-02-19T10:32:25.905Z","id":"CG-C0MLTBNTWX0US1722","references":[],"workItemId":"CG-0MLTAOW5Z0ZK2GI0"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implemented HelpButton in src/ui/HelpButton.ts. Circular ? button with border, hover states, configurable position (default: top-right corner). Toggles HelpPanel on click. Depth set above input blocker. Exported from src/ui/index.ts. See commit 8100b0d.","createdAt":"2026-02-19T10:32:28.351Z","id":"CG-C0MLTBNVSN0S2FWTB","references":[],"workItemId":"CG-0MLTAP9EE12DW186"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implemented keyboard shortcut toggle. Listens for ? key (Shift+/) via scene.input.keyboard. Toggle respects animation state (no-op during animation). Listener cleaned up on destroy(). See commit 8100b0d.","createdAt":"2026-02-19T10:32:30.413Z","id":"CG-C0MLTBNXE501YVZYQ","references":[],"workItemId":"CG-0MLTAPNRB09U9C9F"},"type":"comment"}
{"data":{"author":"opencode","comment":"Created help-content.json with 7 sections: 9-Card Golf overview, Setup, Turn Flow, Round End, Scoring, Tips, Controls. Content derived from GolfRules.ts and GolfScoring.ts. Integrated into GolfScene with HelpPanel and HelpButton. Browser test verifies rendering. See commit 8100b0d.","createdAt":"2026-02-19T10:32:33.444Z","id":"CG-C0MLTBNZQC0SNQM84","references":[],"workItemId":"CG-0MLTAQ7581C3NQOZ"},"type":"comment"}
{"data":{"author":"opencode","comment":"Fixed. Root cause: GeometryMask was drawn at container x=-panelWidth during resetScroll() and never redrawn during slide animation. Added updateMask() method called from tween onUpdate callbacks. Merge commit 2ffee14 on main. File changed: src/ui/HelpPanel.ts (+23/-19 lines).","createdAt":"2026-02-19T11:00:00.543Z","id":"CG-C0MLTCNAN31XBIWEB","references":[],"workItemId":"CG-0MLTCHTQV00N4L9R"},"type":"comment"}
{"data":{"author":"opencode","comment":"Completed: Rewrote runAiTurn() in GolfScene.ts to peek at the AI's draw card, display it with showDrawnCard(), set instruction text to 'AI drew from Stock/Discard pile', and pause for 1000ms (AI_SHOW_DRAW_DELAY) before executing the move. This gives human players visibility into what the AI drew before it acts. All 210+ unit tests pass, TypeScript compiles cleanly. Commit 08415d4, merge commit b22c05d on main.","createdAt":"2026-02-19T11:11:44.410Z","id":"CG-C0MLTD2DQX1GPST0X","references":[],"workItemId":"CG-0MLTCUK500GZUJ6N"},"type":"comment"}
{"data":{"author":"opencode","comment":"Implementation complete. Changed createGameState() validation from >= 2 to >= 1 players. Added single-player tests for both GameState and TurnSequencer. All tests pass, build succeeds. Commit: 451a70e. Files changed: src/core-engine/GameState.ts, tests/core-engine/GameState.test.ts, tests/core-engine/TurnSequencer.test.ts","createdAt":"2026-02-19T12:30:17.802Z","id":"CG-C0MLTFVEMH0FOKVVP","references":[],"workItemId":"CG-0MLTFBTE41EVGNKA"},"type":"comment"}
{"data":{"author":"worklog","comment":"Closed with reason: Completed. Merge commit e2d54b7. createGameState() now accepts 1+ players, all tests pass, build succeeds.","createdAt":"2026-02-19T12:30:32.829Z","id":"CG-C0MLTFVQ7X0CQ2YVP","references":[],"workItemId":"CG-0MLTFBTE41EVGNKA"},"type":"comment"}
